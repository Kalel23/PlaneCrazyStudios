!function e(t,n,i){function o(s,r){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!r&&l)return l(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return o(n?n:e)},d,d.exports,e,t,n,i)}return n[s].exports}for(var a="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(e,t,n){!function(){"use strict";e("./modules/config.js"),e("./modules/ui.js"),e("./modules/builder.js"),e("./modules/utils.js"),e("./modules/canvasElement.js"),e("./modules/styleeditor.js"),e("./modules/content.js"),e("./modules/export.js"),e("./modules/preview.js")}()},{"./modules/builder.js":2,"./modules/canvasElement.js":3,"./modules/config.js":4,"./modules/content.js":5,"./modules/export.js":6,"./modules/preview.js":8,"./modules/styleeditor.js":9,"./modules/ui.js":10,"./modules/utils.js":11}],2:[function(e,t,n){!function(){"use strict";function n(e,t,n){if(this.name=e||"",this.pageID=t.pages_id||0,this.blocks=[],this.parentUL={},this.status="",this.scripts=[],this.pageSettings={title:t.pages_title||"",meta_description:t.meta_description||"",meta_keywords:t.meta_keywords||"",header_includes:t.header_includes||"",page_css:t.page_css||""},this.pageMenuTemplate='<a href="" class="menuItemLink">page</a><span class="pageButtons"><a href="" class="fileEdit fui-new"></a><a href="" class="fileDel fui-cross"><a class="btn btn-xs btn-primary btn-embossed fileSave fui-check" href="#"></a></span></a></span>',this.menuItem={},this.linksDropdownItem={},this.parentUL=document.createElement("UL"),this.parentUL.setAttribute("id","page"+n),this.selectPage=function(){c.deActivateAll(),$(this.menuItem).addClass("active"),c.setActive(this),c.pageTitle.innerHTML=this.name,$("body").trigger("changePage");for(var e in this.blocks)Object.keys(this.blocks[e].frameDocument).length>0&&this.blocks[e].heightAdjustment();this.isEmpty()},this.setPosition=function(e,t){for(var n in this.blocks)this.blocks[n].frame.getAttribute("id")===e&&this.blocks.splice(t,0,this.blocks.splice(n,1)[0])},this.deleteBlock=function(e){for(var t in this.blocks)this.blocks[t]===e&&this.blocks.splice(t,1);c.setPendingChanges(!0)},this.editPageName=function(){if(!this.menuItem.classList.contains("edit")){this.menuItem.querySelector("a.menuItemLink").style.display="none";var e=document.createElement("input");e.type="text",e.setAttribute("name","page"),e.setAttribute("value",this.name),this.menuItem.insertBefore(e,this.menuItem.firstChild),e.focus();var t=e.getAttribute("value");e.setAttribute("value",""),e.setAttribute("value",t),this.menuItem.classList.add("edit")}},this.updatePageNameEvent=function(e){if(this.menuItem.classList.contains("edit")){var t=this.menuItem.querySelector('input[name="page"]');c.checkPageName(t.value)?(this.name=c.prepPageName(t.value),this.menuItem.querySelector('input[name="page"]').remove(),this.menuItem.querySelector("a.menuItemLink").innerHTML=this.name,this.menuItem.querySelector("a.menuItemLink").style.display="block",this.menuItem.classList.remove("edit"),this.linksDropdownItem.text=this.name,this.linksDropdownItem.setAttribute("value",this.name+".html"),c.pageTitle.innerHTML=this.name,c.setPendingChanges(!0)):alert(c.pageNameError)}},this.delete=function(){for(var e in c.sitePages)c.sitePages[e]===this&&(c.sitePages.splice(e,1),this.parentUL.remove(),c.pagesToDelete.push(this.name),this.menuItem.remove(),this.linksDropdownItem.remove(),c.sitePages[0].selectPage(),c.setPendingChanges(!0))},this.isEmpty=function(){0===this.blocks.length?(c.messageStart.style.display="block",c.divFrameWrapper.classList.add("empty")):(c.messageStart.style.display="none",c.divFrameWrapper.classList.remove("empty"))},this.prepForSave=function(){var e={};e.blocks=[];for(var t=0;t<this.blocks.length;t++){var n={};this.blocks[t].sandbox?(n.frames_content="<html>"+$("#sandboxes #"+this.blocks[t].sandbox).contents().find("html").html()+"</html>",n.frames_sandbox=!0,n.frames_loaderFunction=this.blocks[t].sandbox_loader):(n.frames_content=this.blocks[t].frameDocument.documentElement.querySelector("#page").outerHTML,n.frames_sandbox=!1,n.frames_loaderFunction=""),n.frames_height=this.blocks[t].frameHeight,n.frames_original_url=this.blocks[t].originalUrl,this.blocks[t].global&&(n.frames_global=!0),e.blocks.push(n)}return e},this.fullPage=function(){var e=this;e.scripts=[];var t=$("iframe#skeleton").contents().find(a.pageContainer);$("iframe#skeleton").contents().find(a.pageContainer).html(""),$("iframe#skeleton").contents().find("script").each(function(){$(this).remove()});var n;for(var i in this.blocks){n=this.blocks[i].sandbox!==!1?$("#sandboxes #"+this.blocks[i].sandbox).contents().find(a.pageContainer).clone():$(this.blocks[i].frameDocument.body).find(a.pageContainer).clone(),n.find(".frameCover").each(function(){$(this).remove()}),n.find(".videoWrapper").each(function(){var e=$(this).contents();$(this).replaceWith(e)});for(var o in a.editableItems)n.find(o).each(function(){$(this).removeAttr("data-selector"),$(this).css("outline",""),$(this).css("outline-offset",""),$(this).css("cursor",""),""===$(this).attr("style")&&$(this).removeAttr("style")});for(var s=0;s<a.editableContent.length;++s)n.find(a.editableContent[s]).each(function(){$(this).removeAttr("data-selector")});t.append($(n.html()));var r=$(this.blocks[i].frameDocument.body).find("script"),l=document.getElementById("skeleton");r.size()>0&&r.each(function(){var t;""!==$(this).text()?(t=l.contentWindow.document.createElement("script"),t.type="text/javascript",t.innerHTML=$(this).text(),l.contentWindow.document.body.appendChild(t)):null!==$(this).attr("src")&&e.scripts.indexOf($(this).attr("src"))===-1&&(t=l.contentWindow.document.createElement("script"),t.type="text/javascript",t.src=$(this).attr("src"),l.contentWindow.document.body.appendChild(t),e.scripts.push($(this).attr("src")))})}console.log(this.scripts)},this.clear=function(){for(var e=this.blocks.pop();void 0!==e;)e.delete(),e=this.blocks.pop()},this.heightAdjustment=function(){for(var e=0;e<this.blocks.length;e++)this.blocks[e].heightAdjustment()},this.loaded=function(){var e;for(e=0;e<this.blocks.length;e++)if(!this.blocks[e].loaded)return!1;return!0},t.hasOwnProperty("blocks"))for(var o=0;o<t.blocks.length;o++){var s=new i;t.blocks[o].src=t.blocks[o].frames_original_url,"1"===t.blocks[o].frames_sandbox&&(s.sandbox=!0,s.sandbox_loader=t.blocks[o].frames_loaderfunction),s.frameID=t.blocks[o].frames_id,t.blocks[o].frames_global&&(s.global=!0),s.createParentLI(t.blocks[o].frames_height),s.createFrame(t.blocks[o]),s.createFrameCover(),s.insertBlockIntoDom(this.parentUL),s.contentAfterLoad=t.blocks[o].frames_content,this.blocks.push(s)}c.sitePages.push(this),c.divCanvas.appendChild(this.parentUL);var r=this;$(this.parentUL).sortable({revert:!0,placeholder:"drop-hover",handle:".dragBlock",cancel:"",stop:function(){c.moveMode("off"),c.setPendingChanges(!0),c.loaded()||l.canvasLoading("on")},beforeStop:function(e,t){var n=t.item.attr("data-frames"),o;if("undefined"!=typeof n&&n!==!1){$("#start").hide(),r.clear();for(var a=t.item.attr("data-frames").split("-"),s=t.item.attr("data-heights").split("-"),d=t.item.attr("data-originalurls").split("-"),u=0;u<a.length;u++){o=new i,o.createParentLI(s[u]);var h={};h.src="sites/getframe/"+a[u],h.frames_original_url="sites/getframe/"+a[u],h.frames_height=s[u],o.createFrame(h),o.createFrameCover(),o.insertBlockIntoDom(r.parentUL),r.blocks.push(o),c.setPendingChanges(!0)}l.templateID=t.item.attr("data-pageid"),t.item.html(null),$("body .ui-sortable-helper").remove()}else if(t.item.find(".frameCover > button").size()>0){var f=t.item.find("iframe").attr("id"),m=t.item.index();c.activePage.setPosition(f,m)}else o=new i,o.placeOnCanvas(t)},start:function(e,t){c.moveMode("on"),0!==t.item.find(".frameCover").size()&&(l.frameContents=t.item.find("iframe").contents().find(a.pageContainer).html())},over:function(){$("#start").hide()}}),this.menuItem=document.createElement("LI"),this.menuItem.innerHTML=this.pageMenuTemplate,$(this.menuItem).find("a:first").text(e).attr("href","#page"+n);var d=$(this.menuItem).find("a:first").get(0);this.menuItem.addEventListener("click",this,!1),this.menuItem.querySelector("a.fileEdit").addEventListener("click",this,!1),this.menuItem.querySelector("a.fileSave").addEventListener("click",this,!1),this.menuItem.querySelector("a.fileDel").addEventListener("click",this,!1),1===n&&this.menuItem.querySelector("a.fileDel").remove(),c.pagesMenu.appendChild(this.menuItem)}function i(){this.frameID=0,this.loaded=!1,this.sandbox=!1,this.sandbox_loader="",this.status="",this.global=!1,this.originalUrl="",this.parentLI={},this.frameCover={},this.frame={},this.frameDocument={},this.frameHeight=0,this.annot={},this.annotTimeout={},this.contentAfterLoad="",this.createParentLI=function(e){this.parentLI=document.createElement("LI"),this.parentLI.setAttribute("class","element")},this.createFrame=function(e){if(this.frame=document.createElement("IFRAME"),this.frame.setAttribute("frameborder",0),this.frame.setAttribute("scrolling",0),this.frame.setAttribute("src",e.src),this.frame.setAttribute("data-originalurl",e.frames_original_url),this.originalUrl=e.frames_original_url,$(this.frame).uniqueId(),this.sandbox!==!1){this.frame.setAttribute("data-loaderfunction",this.sandbox_loader),this.frame.setAttribute("data-sandbox",this.sandbox);var t=$('<iframe src="'+e.src+'" id="'+this.sandbox+'" sandbox="allow-same-origin"></iframe>');$("#sandboxes").append(t)}},this.insertBlockIntoDom=function(e){this.parentLI.appendChild(this.frame),e.appendChild(this.parentLI),this.frame.addEventListener("load",this,!1),l.canvasLoading("on")},this.setFrameDocument=function(){this.frame.contentDocument?this.frameDocument=this.frame.contentDocument:this.frameDocument=this.frame.contentWindow.document},this.createFrameCover=function(){this.frameCover=document.createElement("DIV"),this.frameCover.classList.add("frameCover"),this.frameCover.classList.add("fresh");var e=document.createElement("BUTTON");e.setAttribute("class","btn btn-inverse btn-sm deleteBlock"),e.setAttribute("type","button"),e.innerHTML='<i class="fui-trash"></i> <span>Remove</span>',e.addEventListener("click",this,!1);var t=document.createElement("BUTTON");t.setAttribute("class","btn btn-inverse btn-sm resetBlock"),t.setAttribute("type","button"),t.innerHTML='<i class="fa fa-refresh"></i> <span>Reset</span>',t.addEventListener("click",this,!1);var n=document.createElement("BUTTON");n.setAttribute("class","btn btn-inverse btn-sm htmlBlock"),n.setAttribute("type","button"),n.innerHTML='<i class="fa fa-code"></i> <span>Source</span>',n.addEventListener("click",this,!1);var i=document.createElement("BUTTON");i.setAttribute("class","btn btn-inverse btn-sm dragBlock"),i.setAttribute("type","button"),i.innerHTML='<i class="fa fa-arrows"></i> <span>Move</span>',i.addEventListener("click",this,!1);var o=document.createElement("LABEL");o.classList.add("checkbox"),o.classList.add("primary");var a=document.createElement("INPUT");a.type="checkbox",a.setAttribute("data-toggle","checkbox"),a.checked=this.global,o.appendChild(a);var s=document.createTextNode("Global");o.appendChild(s);var r=document.createElement("span");r.classList.add("fui-gear");var l=this;$(a).on("change",function(e){l.toggleGlobal(e)}).radiocheck(),this.frameCover.appendChild(e),this.frameCover.appendChild(t),this.frameCover.appendChild(n),this.frameCover.appendChild(i),this.frameCover.appendChild(o),this.frameCover.appendChild(r),this.parentLI.appendChild(this.frameCover)},this.toggleGlobal=function(e){e.currentTarget.checked?this.global=!0:this.global=!1,c.setPendingChanges(!0)},this.heightAdjustment=function(){if(0!==Object.keys(this.frameDocument).length){var e=this.frameDocument.body,t=e.offsetHeight;this.frame.style.height=t+"px",this.parentLI.style.height=t+"px",this.frameHeight=t}},this.delete=function(){$(this.frame.parentNode).fadeOut(500,function(){this.remove(),c.activePage.isEmpty()}),c.activePage.deleteBlock(this),this.sanbdox&&document.getElementById(this.sandbox).remove(),c.setPendingChanges(!0)},this.reset=function(e){if("undefined"==typeof e&&(e=!0),this.frame.contentWindow.location.reload(),this.sandbox)var t=document.getElementById(this.sandbox).contentWindow.location.reload();c.setPendingChanges(!0),l.canvasLoading("on"),e&&r.publish("onBlockChange",this,"reload")},this.source=function(){this.frame.style.display="none",$(this.parentLI.parentNode).sortable("disable");var e=document.createElement("DIV");e.classList.add("aceEditor"),$(e).uniqueId(),this.parentLI.appendChild(e);var t=document.createElement("LI"),n=document.createElement("DIV");n.classList.add("errorDrawer"),n.setAttribute("id","div_errorDrawer"),n.innerHTML='<button type="button" class="btn btn-xs btn-embossed btn-default button_clearErrorDrawer" id="button_clearErrorDrawer">CLEAR</button>',t.appendChild(n),n.querySelector("button").addEventListener("click",this,!1),this.parentLI.parentNode.insertBefore(t,this.parentLI.nextSibling);var i=e.getAttribute("id"),o=ace.edit(i),s=this.frameDocument.querySelector(a.pageContainer),r=s.innerHTML;o.setValue(r),o.setTheme("ace/theme/twilight"),o.getSession().setMode("ace/mode/html");var c=this;o.getSession().on("changeAnnotation",function(){c.annot=o.getSession().getAnnotations(),clearTimeout(c.annotTimeout);var e;e=0===$("#div_errorDrawer p").size()?a.sourceCodeEditSyntaxDelay:100,c.annotTimeout=setTimeout(function(){for(var e in c.annot)if(c.annot.hasOwnProperty(e)&&"Start tag seen without seeing a doctype first. Expected e.g. <!DOCTYPE html>."!==c.annot[e].text){var t=$("<p></p>"),n=$("<b>"+c.annot[e].type+": </b>"),i=$("<span> "+c.annot[e].text+"on line  <b>"+c.annot[e].row+"</b></span>");t.append(n),t.append(i),$("#div_errorDrawer").append(t)}"none"===$("#div_errorDrawer").css("display")&&$("#div_errorDrawer").find("p").size()>0&&$("#div_errorDrawer").slideDown()},e)});var d=document.createElement("BUTTON");d.setAttribute("type","button"),d.classList.add("btn"),d.classList.add("btn-danger"),d.classList.add("btn-sm"),d.classList.add("editCancelButton"),d.innerHTML='<i class="fui-cross"></i> <span>Cancel</span>',d.addEventListener("click",this,!1);var u=document.createElement("BUTTON");u.setAttribute("type","button"),u.classList.add("btn"),u.classList.add("btn-primary"),u.classList.add("btn-sm"),u.classList.add("editSaveButton"),u.innerHTML='<i class="fui-check"></i> <span>Save now</span>',u.addEventListener("click",this,!1);var h=document.createElement("DIV");h.classList.add("editorButtons"),h.appendChild(d),h.appendChild(u),this.parentLI.appendChild(h),l.aceEditors[i]=o},this.cancelSourceBlock=function(){$(this.parentLI.parentNode).sortable("enable"),$(this.parentLI.nextSibling).remove(),this.parentLI.querySelector(".aceEditor").remove(),$(this.frame).fadeIn(500),$(this.parentLI.querySelector(".editorButtons")).fadeOut(500,function(){$(this).remove()})},this.saveSourceBlock=function(){$(this.parentLI.parentNode).sortable("enable");var e=this.parentLI.querySelector(".aceEditor").getAttribute("id"),t=l.aceEditors[e].getValue();if(document.getElementById("div_errorDrawer").parentNode.remove(),this.parentLI.querySelector(".aceEditor").remove(),this.frameDocument.querySelector(a.pageContainer).innerHTML=t,this.frame.style.display="block",this.sandbox){var n=document.getElementById(this.sandbox),i=n.contentDocument||n.contentWindow.document;l.tempFrame=n,i.querySelector(a.pageContainer).innerHTML=t,""!==this.sandbox_loader}$(this.parentLI.querySelector(".editorButtons")).fadeOut(500,function(){$(this).remove()}),this.heightAdjustment(),c.setPendingChanges(!0),this.status="changed",r.publish("onBlockChange",this,"change")},this.clearErrorDrawer=function(){for(var e=this.parentLI.nextSibling.querySelectorAll("p"),t=0;t<e.length;t++)e[t].remove()},this.getSource=function(){var e="<html>";return e+=this.frameDocument.head.outerHTML,e+=this.frameDocument.body.outerHTML},this.setSource=function(e){$(this.frame).contents().find("body").html(e)},this.placeOnCanvas=function(e){var t={},n;e.item.find("iframe").size()>0?(t.src=e.item.find("iframe").attr("src"),t.frames_original_url=e.item.find("iframe").attr("src"),t.frames_height=e.item.height(),n=e.item.find("iframe").attr("sandbox"),"undefined"!=typeof n&&n!==!1&&(this.sandbox=o.getRandomArbitrary(1e4,1e9),this.sandbox_loader=e.item.find("iframe").attr("data-loaderfunction"))):(t.src=e.item.find("img").attr("data-srcc"),t.frames_original_url=e.item.find("img").attr("data-srcc"),t.frames_height=e.item.find("img").attr("data-height"),n=e.item.find("img").attr("data-sandbox"),"undefined"!=typeof n&&n!==!1&&(this.sandbox=o.getRandomArbitrary(1e4,1e9),this.sandbox_loader=e.item.find("img").attr("data-loaderfunction"))),this.frameID=0,this.parentLI=e.item.get(0),this.parentLI.innerHTML="",this.status="new",this.createFrame(t),this.parentLI.style.height=this.frameHeight+"px",this.createFrameCover(),this.frame.addEventListener("load",this),e.item.append($(this.frame)),c.activePage.blocks.splice(e.item.index(),0,this),e.item.find("iframe").trigger("canvasupdated"),c.setPendingChanges(!0)},this.loadJavascript=function(){var e,t,n;for(t=this.frameDocument.querySelectorAll("script.builder"),e=0;e<t.length;e++)t[e].remove();for(e=0;e<a.externalJS.length;e++)n=document.createElement("SCRIPT"),n.classList.add("builder"),n.src=a.externalJS[e],this.frameDocument.querySelector("body").appendChild(n)}}var o=e("./utils.js"),a=e("./config.js"),s=e("./ui.js").appUI,r=e("../vendor/publisher"),l={allBlocks:{},menuWrapper:document.getElementById("menu"),primarySideMenuWrapper:document.getElementById("main"),buttonBack:document.getElementById("backButton"),buttonBackConfirm:document.getElementById("leavePageButton"),siteBuilderModes:document.getElementById("siteBuilderModes"),aceEditors:{},frameContents:"",templateID:0,radioBlockMode:document.getElementById("modeBlock"),modalDeleteBlock:document.getElementById("deleteBlock"),modalResetBlock:document.getElementById("resetBlock"),modalDeletePage:document.getElementById("deletePage"),buttonDeletePageConfirm:document.getElementById("deletePageConfirm"),tempFrame:{},currentResponsiveMode:{},init:function(){$.getJSON("elements.json?v=12345678",function(e){l.allBlocks=e,l.implementBlocks()}),$(this.menuWrapper).on("mouseenter",function(){$(this).stop().animate({left:"0px"},500)}).on("mouseleave",function(){$(this).stop().animate({left:"-210px"},500),$("#menu #main a").removeClass("active"),$(".menu .second").stop().animate({width:0},500,function(){$("#menu #second").hide()})}),$(this.primarySideMenuWrapper).on("click","a:not(.actionButtons)",function(e){e.preventDefault()}),$(this.buttonBack).on("click",this.backButton),$(this.buttonBackConfirm).on("click",this.backButtonConfirm),$(window).bind("beforeunload",function(){if(c.pendingChanges===!0)return"Your site contains changed which haven't been saved yet. Are you sure you want to leave?"})},implementBlocks:function(){var e,t;for(var n in this.allBlocks.elements){var i=n.toLowerCase().replace(" ","_");$('<li><a href="" id="'+i+'">'+n+"</a></li>").appendTo("#menu #main ul#elementCats");for(var o=0;o<this.allBlocks.elements[n].length;o++){null===this.allBlocks.elements[n][o].thumbnail?(this.allBlocks.elements[n][o].sandbox?(this.allBlocks.elements[n][o].loaderFunction&&(t='data-loaderfunction="'+this.allBlocks.elements[n][o].loaderFunction+'"'),e=$('<li class="element '+i+'"><iframe src="'+this.allBlocks.elements[n][o].url+'" scrolling="no" sandbox="allow-same-origin"></iframe></li>')):e=$('<li class="element '+i+'"><iframe src="about:blank" scrolling="no"></iframe></li>'),e.find("iframe").uniqueId(),e.find("iframe").attr("src",this.allBlocks.elements[n][o].url)):this.allBlocks.elements[n][o].sandbox?(this.allBlocks.elements[n][o].loaderFunction&&(t='data-loaderfunction="'+this.allBlocks.elements[n][o].loaderFunction+'"'),e=$('<li class="element '+i+'"><img src="'+this.allBlocks.elements[n][o].thumbnail+'" data-srcc="'+this.allBlocks.elements[n][o].url+'" data-height="'+this.allBlocks.elements[n][o].height+'" data-sandbox="" '+t+"></li>")):e=$('<li class="element '+i+'"><img src="'+this.allBlocks.elements[n][o].thumbnail+'" data-srcc="'+this.allBlocks.elements[n][o].url+'" data-height="'+this.allBlocks.elements[n][o].height+'"></li>'),e.appendTo("#menu #second ul#elements");var a;a=this.allBlocks.elements[n][o].height?.25*this.allBlocks.elements[n][o].height:"auto",e.find("iframe").zoomer({zoom:.25,width:270,height:a,message:"Drag&Drop Me!"})}}l.makeDraggable()},backButton:function(){if(c.pendingChanges===!0)return $("#backModal").modal("show"),!1},backButtonConfirm:function(){c.pendingChanges=!1},activateBlockMode:function(){$("body").trigger("modeBlocks")},makeDraggable:function(){$("#elements li, #templates li").each(function(){$(this).draggable({helper:function(){return $('<div style="height: 100px; width: 300px; background: #F9FAFA; box-shadow: 5px 5px 1px rgba(0,0,0,0.1); text-align: center; line-height: 100px; font-size: 28px; color: #16A085"><span class="fui-list"></span></div>')},revert:"invalid",appendTo:"body",connectToSortable:"#pageList > ul",start:function(){c.moveMode("on")},stop:function(e,t){}})}),$("#elements li a").each(function(){$(this).unbind("click").bind("click",function(e){e.preventDefault()})})},populateCanvas:function(){var e,t=1;for(e in c.pages){var i=new n(e,c.pages[e],t);t++}c.sitePages.length>0&&c.sitePages[0].selectPage(),c.isEmpty()},canvasLoading:function(e){if("on"===e&&0===document.getElementById("frameWrapper").querySelectorAll("#canvasOverlay").length){var t=document.createElement("DIV");t.style.display="flex",$(t).hide(),t.id="canvasOverlay",t.innerHTML='<div class="loader"><span>{</span><span>}</span></div>',document.getElementById("frameWrapper").appendChild(t),$("#canvasOverlay").fadeIn(500)}else"off"===e&&1===document.getElementById("frameWrapper").querySelectorAll("#canvasOverlay").length&&c.loaded()&&$("#canvasOverlay").fadeOut(500,function(){this.remove()})}};n.prototype.handleEvent=function(e){switch(e.type){case"click":if(e.target.classList.contains("fileEdit"))this.editPageName();else if(e.target.classList.contains("fileSave"))this.updatePageNameEvent(e.target);else if(e.target.classList.contains("fileDel")){var t=this;$(l.modalDeletePage).modal("show"),$(l.modalDeletePage).off("click","#deletePageConfirm").on("click","#deletePageConfirm",function(){t.delete(),$(l.modalDeletePage).modal("hide")})}else this.selectPage()}},i.prototype.handleEvent=function(e){switch(e.type){case"load":this.setFrameDocument(),this.heightAdjustment(),this.loadJavascript(),""!==this.contentAfterLoad&&this.setSource(this.contentAfterLoad),$(this.frameCover).removeClass("fresh",500),r.publish("onBlockLoaded",this),this.loaded=!0,l.canvasLoading("off");break;case"click":var t=this;e.target.classList.contains("deleteBlock")||e.target.parentNode.classList.contains("deleteBlock")?($(l.modalDeleteBlock).modal("show"),$(l.modalDeleteBlock).off("click","#deleteBlockConfirm").on("click","#deleteBlockConfirm",function(){t.delete(e),$(l.modalDeleteBlock).modal("hide")})):e.target.classList.contains("resetBlock")||e.target.parentNode.classList.contains("resetBlock")?($(l.modalResetBlock).modal("show"),$(l.modalResetBlock).off("click","#resetBlockConfirm").on("click","#resetBlockConfirm",function(){t.reset(),$(l.modalResetBlock).modal("hide")})):e.target.classList.contains("htmlBlock")||e.target.parentNode.classList.contains("htmlBlock")?t.source():e.target.classList.contains("editCancelButton")||e.target.parentNode.classList.contains("editCancelButton")?t.cancelSourceBlock():e.target.classList.contains("editSaveButton")||e.target.parentNode.classList.contains("editSaveButton")?t.saveSourceBlock():e.target.classList.contains("button_clearErrorDrawer")&&t.clearErrorDrawer()}};var c={pendingChanges:!1,pages:{},is_admin:0,data:{},pagesToDelete:[],sitePages:[],sitePagesReadyForServer:{},activePage:{},pageTitle:document.getElementById("pageTitle"),divCanvas:document.getElementById("pageList"),pagesMenu:document.getElementById("pages"),buttonNewPage:document.getElementById("addPage"),liNewPage:document.getElementById("newPageLI"),inputPageSettingsTitle:document.getElementById("pageData_title"),inputPageSettingsMetaDescription:document.getElementById("pageData_metaDescription"),inputPageSettingsMetaKeywords:document.getElementById("pageData_metaKeywords"),inputPageSettingsIncludes:document.getElementById("pageData_headerIncludes"),inputPageSettingsPageCss:document.getElementById("pageData_headerCss"),buttonSubmitPageSettings:document.getElementById("pageSettingsSubmittButton"),modalPageSettings:document.getElementById("pageSettingsModal"),buttonSave:document.getElementById("savePage"),messageStart:document.getElementById("start"),divFrameWrapper:document.getElementById("frameWrapper"),skeleton:document.getElementById("skeleton"),buttonEmptyPage:document.getElementById("clearScreen"),actionButtons:document.querySelectorAll(".actionButtons"),autoSaveTimer:{},init:function(){$.getJSON("site.json",function(e){void 0!==e.pages?c.pages=e.pages:c.pages={index:{blocks:[],page_id:1,pages_title:"",meta_description:"",meta_keywords:"",header_includes:"",page_css:""}},e.responsiveMode&&r.publish("onSetMode",e.responsiveMode),r.subscribe("onBlockChange",function(e,t){if(e.global)for(var n=0;n<c.sitePages.length;n++)for(var i=0;i<c.sitePages[n].blocks.length;i++)c.sitePages[n].blocks[i]!==e&&c.sitePages[n].blocks[i].originalUrl===e.originalUrl&&c.sitePages[n].blocks[i].global&&("change"===t?(c.sitePages[n].blocks[i].frameDocument.body=e.frameDocument.body.cloneNode(!0),r.publish("onBlockLoaded",c.sitePages[n].blocks[i])):"reload"===t&&c.sitePages[n].blocks[i].reset(!1))}),$("body").trigger("siteDataLoaded"),l.populateCanvas()}),$(this.buttonNewPage).on("click",c.newPage),$(this.modalPageSettings).on("show.bs.modal",c.loadPageSettings),$(this.buttonSubmitPageSettings).on("click",c.updatePageSettings),$(this.buttonSave).on("click",function(){c.save(!0)}),$(this.buttonEmptyPage).on("click",c.emptyPage),this.autoSaveTimer=setTimeout(c.autoSave,a.autoSaveTimeout)},autoSave:function(){c.pendingChanges&&c.save(!1),window.clearInterval(this.autoSaveTimer),this.autoSaveTimer=setTimeout(c.autoSave,a.autoSaveTimeout)},setPendingChanges:function(e){this.pendingChanges=e,this.isEmpty(),e===!0?(window.clearInterval(this.autoSaveTimer),this.autoSaveTimer=setTimeout(c.autoSave,a.autoSaveTimeout),$("#savePage .bLabel").text("Save now"),"new"!==c.activePage.status&&(c.activePage.status="changed")):($("#savePage .bLabel").text("No change"),c.updatePageStatus(""))},save:function(e){r.publish("onBeforeSave"),$("a#savePage").addClass("disabled");var t=$("a#savePage").find(".bLabel").text(),n=$("a#savePage").find(".bLabel").attr("data-alt-text");$("a#savePage").find(".bLabel").text(n),$("a#savePage").addClass("disabled");var i={},o;if(0!==c.sitePages[0].blocks.length){for(var a=0;a<c.sitePages.length;a++)0!==c.sitePages[a].blocks.length?i[c.sitePages[a].name]=c.sitePages[a].prepForSave():i[c.sitePages[a].name]="empty";o={pages:i}}else o={delete:!0};o.responsiveMode=l.currentResponsiveMode,$("#errorModal .modal-body > *, #successModal .modal-body > *").each(function(){$(this).remove()}),$.ajax({url:"_save.php",method:"POST",data:{data:o},dataType:"json"}).done(function(t){$("a#savePage").removeClass("disabled"),0===t.responseCode?e&&($("#errorModal .modal-body").html(t.responseHTML),$("#errorModal").modal("show")):1===t.responseCode&&(c.setPendingChanges(!1),$("body").trigger("changePage"))})},prepForSave:function(e){if(this.sitePagesReadyForServer={},e)this.sitePagesReadyForServer[this.activePage.name]=this.activePage.prepForSave(),this.activePage.fullPage();else for(var t=0;t<this.sitePages.length;t++)""!==this.sitePages[t].status&&(this.sitePagesReadyForServer[this.sitePages[t].name]=this.sitePages[t].prepForSave())},setActive:function(e){this.activePage=e;for(var t in this.sitePages)this.sitePages[t].parentUL.style.display="none";this.activePage.parentUL.style.display="block"},deActivateAll:function(){for(var e=this.pagesMenu.querySelectorAll("li"),t=0;t<e.length;t++)e[t].classList.remove("active")},newPage:function(){c.deActivateAll();var e=[],t={pages_id:0};e[0]=t;var i="page"+(c.sitePages.length+1),o=new n(i,e,c.sitePages.length+1);o.status="new",o.selectPage(),o.editPageName(),o.isEmpty(),c.setPendingChanges(!0)},checkPageName:function(e){for(var t in this.sitePages)if(this.sitePages[t].name===e&&this.activePage!==this.sitePages[t])return this.pageNameError="The page name must be unique.",!1;return!0},prepPageName:function(e){return e=e.replace(" ",""),e=e.replace(/[?*!.|&#;$%@"<>()+,]/g,"")},updatePageSettings:function(){c.activePage.pageSettings.title=c.inputPageSettingsTitle.value,c.activePage.pageSettings.meta_description=c.inputPageSettingsMetaDescription.value,c.activePage.pageSettings.meta_keywords=c.inputPageSettingsMetaKeywords.value,c.activePage.pageSettings.header_includes=c.inputPageSettingsIncludes.value,c.activePage.pageSettings.page_css=c.inputPageSettingsPageCss.value,c.setPendingChanges(!0),$(c.modalPageSettings).modal("hide")},updatePageStatus:function(e){for(var t in this.sitePages)this.sitePages[t].status=e},emptyPage:function(){c.activePage.clear()},isEmpty:function(){var e=0;if(1===this.sitePages.length&&0===this.activePage.blocks.length)for(e=0;e<this.actionButtons.length;e++)this.actionButtons[e].classList.add("disabled");else for(e=0;e<this.actionButtons.length;e++)this.actionButtons[e].classList.remove("disabled")},loaded:function(){var e;for(e=0;e<this.sitePages.length;e++)if(!this.sitePages[e].loaded())return!1;return!0},moveMode:function(e){var t;for(t=0;t<this.activePage.blocks.length;t++)"on"===e?this.activePage.blocks[t].frameCover.classList.add("move"):"off"===e&&this.activePage.blocks[t].frameCover.classList.remove("move")}};l.init(),c.init(),t.exports.site=c,t.exports.builderUI=l}()},{"../vendor/publisher":12,"./config.js":4,"./ui.js":10,"./utils.js":11}],3:[function(e,t,n){!function(){"use strict";var n=e("./builder.js");t.exports.Element=function(e){this.element=e,this.sandbox=!1,this.parentFrame={},this.parentBlock={},this.editableAttributes=[],this.setOpen=function(){$(this.element).off("mouseenter mouseleave click"),$(this.element).css({outline:"2px solid rgba(233,94,94,0.5)","outline-offset":"-2px",cursor:"pointer"})},this.activate=function(){var e=this;"A"===this.element.tagName&&$(this.element).data("color",getComputedStyle(this.element).color),$(this.element).css({outline:"none",cursor:"inherit"}),$(this.element).on("mouseenter",function(e){e.stopPropagation(),$(this).css({outline:"2px solid rgba(233,94,94,0.5)","outline-offset":"-2px",cursor:"pointer"})}).on("mouseleave",function(){$(this).css({outline:"",cursor:"","outline-offset":""})}).on("click",function(t){t.preventDefault(),t.stopPropagation(),e.clickHandler(this)})},this.deactivate=function(){$(this.element).off("mouseenter mouseleave click"),$(this.element).css({outline:"none",cursor:"inherit"})},this.removeOutline=function(){$(this.element).css({outline:"none",cursor:"inherit"})},this.setParentFrame=function(){for(var e=this.element.ownerDocument,t=e.defaultView||e.parentWindow,n=t.parent.document.getElementsByTagName("iframe"),i=n.length;i-- >0;){var o=n[i];try{var a=o.contentDocument||o.contentWindow.document;a===e&&(this.parentFrame=o)}catch(e){}}},this.setParentBlock=function(){for(var e=0;e<n.site.sitePages.length;e++)for(var t=0;t<n.site.sitePages[e].blocks.length;t++)n.site.sitePages[e].blocks[t].frame===this.parentFrame&&(this.parentBlock=n.site.sitePages[e].blocks[t])},this.setParentFrame(),this.parentFrame.getAttribute("data-sandbox")&&(this.sandbox=this.parentFrame.getAttribute("data-sandbox"))}}()},{"./builder.js":2}],4:[function(e,t,n){!function(){"use strict";t.exports.pageContainer="#page",t.exports.editableItems={
"span.fa":["color","font-size"],".bg.bg1":["background-color"],"nav a, .navbar-nav a":["color","font-weight","text-transform"],img:["border-top-left-radius","border-top-right-radius","border-bottom-left-radius","border-bottom-right-radius","border-color","border-style","border-width"],"hr.dashed":["border-color","border-width"],".divider > span":["color","font-size"],"hr.shadowDown":["margin-top","margin-bottom"],".footer a":["color"],".social a":["color"],".bg.bg1, .bg.bg2, .header10, .header11":["background-image","background-color"],".frameCover":[],".editContent":["content","color","font-size","background-color","font-family"],"a.cta, a.scroll-to, a.btn, a.play-btn, a.more, a.price-button, .link-list a, .footer-nav li a, button.btn":["border-radius","font-size","background-color"],"#pricing_table2 .pricing2 .bottom li":["content"]},t.exports.editableItemOptions={"nav a, .navbar-nav a: font-weight":["400","700"],"a.cta, a.btn, button.btn : border-radius":["0px","4px","25px"],"img : border-style":["none","dotted","dashed","solid"],"img : border-width":["1px","2px","3px","4px"],"h1, h2, h3, h4, h5, p : font-family":["default","Lato","Helvetica","Arial","Times New Roman"],"h2 : font-family":["default","Lato","Helvetica","Arial","Times New Roman"],"h3 : font-family":["default","Lato","Helvetica","Arial","Times New Roman"],"p : font-family":["default","Lato","Helvetica","Arial","Times New Roman"]},t.exports.responsiveModes={desktop:"96%",mobile:"320px",tablet:"1024px"},t.exports.editableContent=[],t.exports.autoSaveTimeout=3e5,t.exports.sourceCodeEditSyntaxDelay=1e4,t.exports.mediumCssUrls=["//cdn.jsdelivr.net/medium-editor/latest/css/medium-editor.min.css","../css/medium-bootstrap.css"],t.exports.mediumButtons=["bold","italic","underline","anchor","orderedlist","unorderedlist","h1","h2","h3","h4","removeFormat"],t.exports.externalJS=["js/builder_in_block.js"]}()},{}],5:[function(e,t,n){!function(){"use strict";var t=e("./canvasElement.js").Element,n=e("./config"),i=e("./builder.js"),o=e("../vendor/publisher"),a=e("medium-editor"),s=e("./mediumEditorExtensions"),r={labelContentMode:document.getElementById("modeContentLabel"),radioContent:document.getElementById("modeContent"),buttonUpdateContent:document.getElementById("updateContentInFrameSubmit"),activeElement:{},allContentItemsOnCanvas:[],modalEditContent:document.getElementById("editContentModal"),mediumEditors:[],init:function(){o.subscribe("onBlockLoaded",function(e){r.injectMediumCSS(e)}),o.subscribe("onBeforeSave",function(){r.destroyAllEditors()}),o.subscribe("onBeforePreview",function(){r.destroyAllEditors()}),o.subscribe("onBeforeClone",function(){r.destroyAllEditors()}),o.subscribe("onBeforeDelete",function(){r.destroyAllEditors()}),o.subscribe("onClickContent",function(e){r.contentClick(e)}),$("body").on("beforeSave",function(){Object.keys(r.activeElement).length>0&&r.activeElement.removeOutline()})},contentClick:function(e){0!==Object.keys(this.activeElement).length&&this.activeElement.activate(),r.destroyAllEditors();var l=new t(e);if(l.setParentBlock(),r.activeElement=l,r.activeElement.setOpen(),!e.hasAttribute("medium-editor-index")){var c=e.ownerDocument.defaultView,d=e.ownerDocument,u=new a(e,{ownerDocument:d,contentWindow:c,buttonLabels:"fontawesome",toolbar:{buttons:n.mediumButtons},extensions:{highlighter:new s.HighlighterButton}}),h=this;u.subscribe("blur",function(e,t){0!==Object.keys(h.activeElement).length&&h.activeElement.activate(),h.activeElement.parentBlock.heightAdjustment()}),u.subscribe("focus",function(e,t){}),u.subscribe("editableInput",function(){i.site.setPendingChanges(!0),o.publish("onBlockChange",r.activeElement.parentBlock,"change")}),u.selectElement(e.firstChild),r.mediumEditors.push(u)}},destroyAllEditors:function(){for(var e=0;e<r.mediumEditors.length;e++)r.mediumEditors[e].destroy()},injectMediumCSS:function(e){for(var t=0;t<n.mediumCssUrls.length;t++){var i=document.createElement("LINK");i.setAttribute("rel","stylesheet"),i.setAttribute("href",n.mediumCssUrls[t]),i.setAttribute("type","text/css"),i.setAttribute("media","screen"),i.setAttribute("charset","utf-8"),i.setAttribute("id","mediumCss"+t),e.frameDocument.head.appendChild(i)}}};r.init()}()},{"../vendor/publisher":12,"./builder.js":2,"./canvasElement.js":3,"./config":4,"./mediumEditorExtensions":7,"medium-editor":13}],6:[function(e,t,n){!function(){"use strict";var t=e("./config.js"),n=e("../vendor/publisher"),i={modalExport:document.getElementById("exportModal"),buttonExport:document.getElementById("exportPage"),init:function(){$(this.modalExport).on("show.bs.modal",this.doExportModal),$(this.modalExport).on("shown.bs.modal",this.prepExport),$(this.modalExport).find("form").on("submit",this.exportFormSubmit),$(this.buttonExport).show()},doExportModal:function(){$("#exportModal > form #exportSubmit").show(""),$("#exportModal > form #exportCancel").text("Cancel & Close")},prepExport:function(e){n.publish("closeStyleEditor"),$('#exportModal form input[type="hidden"].pages').remove(),$("#pageList > ul").each(function(){var e,n=$("iframe#skeleton").contents().find(t.pageContainer);n.find("*").remove(),$(this).find("iframe").each(function(){var i=$(this).attr("data-sandbox");e="undefined"!=typeof i&&i!==!1?$("#sandboxes #"+i).contents().find(t.pageContainer):$(this).contents().find(t.pageContainer).clone(),e.find(".frameCover").each(function(){$(this).remove()});for(var o in t.editableItems)e.find(o).each(function(){$(this).removeAttr("data-selector"),""===$(this).attr("style")&&$(this).removeAttr("style")});for(var a=0;a<t.editableContent.length;++a)e.find(t.editableContent[a]).each(function(){$(this).removeAttr("data-selector")});var s=e.html(),r=$(this).contents().find(t.pageContainer).find("script");if(r.size()>0){var l=document.getElementById("skeleton"),c;r.each(function(){""!==$(this).text()?(c=l.contentWindow.document.createElement("script"),c.type="text/javascript",c.innerHTML=$(this).text(),l.contentWindow.document.getElementById(t.pageContainer.substring(1)).appendChild(c)):null!==$(this).attr("src")&&(c=l.contentWindow.document.createElement("script"),c.type="text/javascript",c.src=$(this).attr("src"),l.contentWindow.document.getElementById(t.pageContainer.substring(1)).appendChild(c))})}n.append($(s))});var i=$('<input type="hidden" name="pages['+$("#pages li:eq("+($(this).index()+1)+") a:first").text()+']" class="pages" value="">');$("#exportModal form").prepend(i),i.val("<html>"+$("iframe#skeleton").contents().find("html").html()+"</html>")})},exportFormSubmit:function(){$("#exportModal > form #exportSubmit").hide(""),$("#exportModal > form #exportCancel").text("Close Window")}};i.init()}()},{"../vendor/publisher":12,"./config.js":4}],7:[function(e,t,n){!function(){"use strict";var n=e("medium-editor"),i=e("rangy");e("rangy/lib/rangy-classapplier"),i.init(),t.exports.HighlighterButton=n.extensions.button.extend({name:"highlighter",tagNames:["mark"],contentDefault:"<b>H</b>",contentFA:'<i class="fa fa-paint-brush"></i>',aria:"Hightlight",action:"highlight",iframeWin:{},init:function(){n.extensions.button.prototype.init.call(this),this.classApplier=i.createClassApplier("highlight",{elementTagName:"mark",normalize:!0}),this.iframeWin=i.dom.getIframeWindow(this.window.frameElement)},handleClick:function(e){return this.classApplier.toggleSelection(this.iframeWin),!1}})}()},{"medium-editor":13,rangy:15,"rangy/lib/rangy-classapplier":14}],8:[function(e,t,n){!function(){"use strict";var t=e("./config.js"),n=e("./builder.js"),i=e("../vendor/publisher"),o={modalPreview:document.getElementById("previewModal"),buttonPreview:document.getElementById("buttonPreview"),init:function(){$(this.modalPreview).on("shown.bs.modal",this.prepPreview),$(this.modalPreview).on("show.bs.modal",this.prepPreviewLink),$(this.buttonPreview).show()},prepPreview:function(){i.publish("onBeforePreview"),$('#previewModal form input[type="hidden"]').remove(),n.site.activePage.fullPage();var e;e=$('<input type="hidden" name="page" value="">'),$("#previewModal form").prepend(e),e.val("<html>"+$("iframe#skeleton").contents().find("html").html()+"</html>"),e=$('<input type="hidden" name="meta_title" value="">'),$("#previewModal form").prepend(e),e.val(n.site.activePage.pageSettings.title),e=$('<input type="hidden" name="meta_description" value="">'),$("#previewModal form").prepend(e),e.val(n.site.activePage.pageSettings.meta_description),e=$('<input type="hidden" name="meta_keywords" value="">'),$("#previewModal form").prepend(e),e.val(n.site.activePage.pageSettings.meta_keywords),e=$('<input type="hidden" name="header_includes" value="">'),$("#previewModal form").prepend(e),e.val(n.site.activePage.pageSettings.header_includes),e=$('<input type="hidden" name="page_css" value="">'),$("#previewModal form").prepend(e),e.val(n.site.activePage.pageSettings.page_css),e=$('<input type="hidden" name="siteID" value="">'),$("#previewModal form").prepend(e),e.val(n.site.data.sites_id)},prepPreviewLink:function(){$("#pagePreviewLink").attr("href",$("#pagePreviewLink").attr("data-defurl")+$("#pages li.active a").text())}};o.init()}()},{"../vendor/publisher":12,"./builder.js":2,"./config.js":4}],9:[function(e,t,n){!function(){"use strict";var t=e("./canvasElement.js").Element,i=e("./config.js"),o=e("./builder.js"),a=e("../vendor/publisher"),s={radioStyle:document.getElementById("modeStyle"),labelStyleMode:document.getElementById("modeStyleLabel"),buttonSaveChanges:document.getElementById("saveStyling"),activeElement:{},allStyleItemsOnCanvas:[],_oldIcon:[],styleEditor:document.getElementById("styleEditor"),formStyle:document.getElementById("stylingForm"),buttonRemoveElement:document.getElementById("deleteElementConfirm"),buttonCloneElement:document.getElementById("cloneElementButton"),buttonResetElement:document.getElementById("resetStyleButton"),selectLinksInernal:document.getElementById("internalLinksDropdown"),selectLinksPages:document.getElementById("pageLinksDropdown"),videoInputYoutube:document.getElementById("youtubeID"),videoInputVimeo:document.getElementById("vimeoID"),inputCustomLink:document.getElementById("internalLinksCustom"),linkImage:null,linkIcon:null,inputLinkText:document.getElementById("linkText"),selectIcons:document.getElementById("icons"),buttonDetailsAppliedHide:document.getElementById("detailsAppliedMessageHide"),buttonCloseStyleEditor:document.querySelector("#styleEditor > a.close"),ulPageList:document.getElementById("pageList"),responsiveToggle:document.getElementById("responsiveToggle"),theScreen:document.getElementById("screen"),init:function(){a.subscribe("closeStyleEditor",function(){s.closeStyleEditor()}),a.subscribe("onBlockLoaded",function(e){s.setupCanvasElements(e)}),a.subscribe("onSetMode",function(e){s.responsiveModeChange(e)}),a.subscribe("onBeforeSave",function(){s.closeStyleEditor()}),a.subscribe("onBeforePreview",function(){s.closeStyleEditor()}),$(this.radioStyle).on("click",this.activateStyleMode),$(this.buttonSaveChanges).on("click",this.updateStyling),$(this.formStyle).on("focus","input",this.animateStyleInputIn).on("blur","input",this.animateStyleInputOut),$(this.buttonRemoveElement).on("click",this.deleteElement),$(this.buttonCloneElement).on("click",this.cloneElement),$(this.buttonResetElement).on("click",this.resetElement),$(this.videoInputYoutube).on("focus",function(){$(s.videoInputVimeo).val("")}),$(this.videoInputVimeo).on("focus",function(){$(s.videoInputYoutube).val("")}),$(this.buttonDetailsAppliedHide).on("click",function(){$(this).parent().fadeOut(500)}),$(this.buttonCloseStyleEditor).on("click",this.closeStyleEditor),$(this.inputCustomLink).on("focus",this.inputCustomLinkFocus).on("blur",this.inputCustomLinkBlur),$(this.selectIcons).chosen({search_contains:!0}),window.FormData||this.hideFileUploads(),$(this.labelStyleMode).show(),$("body").on("beforeSave",this.closeStyleEditor),$(this.responsiveToggle).on("click","a",this.toggleResponsiveClick),o.builderUI.currentResponsiveMode=Object.keys(i.responsiveModes)[0]},toggleResponsiveClick:function(e){e.preventDefault(),s.responsiveModeChange(this.getAttribute("data-responsive"))},responsiveModeChange:function(e){var t,n;for(t=s.responsiveToggle.querySelectorAll("li"),n=0;n<t.length;n++)t[n].classList.remove("active");document.querySelector('a[data-responsive="'+e+'"]').parentNode.classList.add("active");for(var a in i.responsiveModes)i.responsiveModes.hasOwnProperty(a)&&this.theScreen.classList.remove(a);i.responsiveModes[e]&&(this.theScreen.classList.add(e),$(this.theScreen).animate({width:i.responsiveModes[e]},650,function(){o.site.activePage.heightAdjustment()})),o.builderUI.currentResponsiveMode=e},setupCanvasElements:function(e){if(void 0===e)return!1;var t;for(var n in i.editableItems)$(e.frame).contents().find(i.pageContainer+" "+n).each(function(){s.setupCanvasElementsOnElement(this,n)})},setupCanvasElementsOnElement:function(e,n){t.prototype.clickHandler=function(e){s.styleClick(this)};var o=new t(e);o.editableAttributes=i.editableItems[n],o.setParentBlock(),o.activate(),s.allStyleItemsOnCanvas.push(o),void 0!==typeof n&&$(e).attr("data-selector",n)},styleClick:function(e){0!==Object.keys(this.activeElement).length&&this.activeElement.activate(),this.activeElement=e,this.activeElement.setOpen();var t=$(this.activeElement.element).attr("data-selector");$("#editingElement").text(t),$("#detailTabs a:first").click(),$("ul#detailTabs li:gt(0)").hide();for(var n in i.editableItems)i.editableItems.hasOwnProperty(n)&&n===t&&i.editableItems[n].indexOf("content")!==-1&&a.publish("onClickContent",e.element);return"A"!==$(this.activeElement.element).prop("tagName")&&"A"!==$(this.activeElement.element).parent().prop("tagName")||this.editLink(this.activeElement.element),"IMG"===$(this.activeElement.element).prop("tagName")&&this.editImage(this.activeElement.element),"video"===$(this.activeElement.element).attr("data-type")&&this.editVideo(this.activeElement.element),$(this.activeElement.element).hasClass("fa")&&this.editIcon(this.activeElement.element),this.buildeStyleElements(t),this.toggleSidePanel("open"),!1},buildeStyleElements:function(e){$("#styleElements > *:not(#styleElTemplate)").each(function(){$(this).remove()}),1===i.editableItems[e].length&&"content"===i.editableItems[e][0]?(document.getElementById("detailTabs").style.display="none",s.buttonSaveChanges.style.display="none"):(document.getElementById("detailTabs").style.display="block",s.buttonSaveChanges.style.display="block");for(var t=0;t<i.editableItems[e].length;t++){var n=$("#styleElTemplate").clone();if(n.attr("id",""),n.find(".control-label").text(i.editableItems[e][t]+":"),e+" : "+i.editableItems[e][t]in i.editableItemOptions){n.find("input").remove();var a=$('<select class="form-control select select-primary btn-block select-sm"></select>');a.attr("name",i.editableItems[e][t]);for(var r=0;r<i.editableItemOptions[e+" : "+i.editableItems[e][t]].length;r++){var l=$('<option value="'+i.editableItemOptions[e+" : "+i.editableItems[e][t]][r]+'">'+i.editableItemOptions[e+" : "+i.editableItems[e][t]][r]+"</option>");i.editableItemOptions[e+" : "+i.editableItems[e][t]][r]===$(s.activeElement.element).css(i.editableItems[e][t])&&l.attr("selected","true"),a.append(l)}n.append(a),a.select2()}else{if("content"===i.editableItems[e][t])continue;n.find("input").attr("name",i.editableItems[e][t]),"background-image"===i.editableItems[e][t]?n.find("input").bind("focus",function(){var e=$(this);$("#imageModal").modal("show"),$("#imageModal .image button.useImage").unbind("click"),$("#imageModal").on("click",".image button.useImage",function(){$(s.activeElement.element).css("background-image",'url("'+$(this).attr("data-url")+'")'),e.val('url("'+$(this).attr("data-url")+'")'),$("#imageModal").modal("hide"),o.site.setPendingChanges(!0)})}):i.editableItems[e][t].indexOf("color")>-1?("transparent"!==$(s.activeElement.element).css(i.editableItems[e][t])&&"none"!==$(s.activeElement.element).css(i.editableItems[e][t])&&""!==$(s.activeElement.element).css(i.editableItems[e][t])&&($(s.activeElement.element).data(i.editableItems[e][t])?n.find("input").val($(s.activeElement.element).data(i.editableItems[e][t])):n.find("input").val($(s.activeElement.element).css(i.editableItems[e][t]))),n.find("input").spectrum({preferredFormat:"hex",showPalette:!0,allowEmpty:!0,showInput:!0,palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]]})):n.find("input").val($(s.activeElement.element).css(i.editableItems[e][t]))}n.css("display","block"),$("#styleElements").append(n),$("#styleEditor form#stylingForm").height("auto")}},updateStyling:function(){var e,t;if($("#styleEditor #tab1 .form-group:not(#styleElTemplate) input, #styleEditor #tab1 .form-group:not(#styleElTemplate) select").each(function(){void 0!==$(this).attr("name")&&$(s.activeElement.element).css($(this).attr("name"),$(this).val()),s.activeElement.sandbox&&(e=$(s.activeElement.element).attr("id"),$("#"+s.activeElement.sandbox).contents().find("#"+e).css($(this).attr("name"),$(this).val()))}),"A"===$(s.activeElement.element).prop("tagName")&&(s.activeElement.element.href=document.getElementById("internalLinksCustom").value,t=s.activeElement.element.childNodes.length,s.linkImage?s.activeElement.element.childNodes[t-1].nodeValue=document.getElementById("linkText").value:s.linkIcon?s.activeElement.element.childNodes[t-1].nodeValue=document.getElementById("linkText").value:s.activeElement.element.innerText=document.getElementById("linkText").value,s.activeElement.sandbox&&(e=$(s.activeElement.element).attr("id"),$("#"+s.activeElement.sandbox).contents().find("#"+e).attr("href",$("input#internalLinksCustom").val()))),"A"!==$(s.activeElement.element).parent().prop("tagName")||s.activeElement.element.classList.contains("fa")||(s.activeElement.element.parentNode.href=document.getElementById("internalLinksCustom").value,t=s.activeElement.element.childNodes.length,s.activeElement.sandbox&&(e=$(s.activeElement.element).attr("id"),$("#"+s.activeElement.sandbox).contents().find("#"+e).parent().attr("href",$("input#internalLinksCustom").val()))),"block"===$("a#img_Link").css("display")&&""!==$("input#imageFileField").val()){var n=$("form#imageUploadForm"),i=!1;window.FormData&&(i=new FormData(n[0]));var r=n.attr("action");$.ajax({url:r,data:i?i:n.serialize(),cache:!1,contentType:!1,processData:!1,dataType:"json",type:"POST"}).done(function(e){if(1===e.code){if($("input#imageURL").val(e.response),$(s.activeElement.element).attr("src",e.response),$(".imageFileTab").find("a.fileinput-exists").click(),s.activeElement.sandbox){var t=$(s.activeElement.element).attr("id");$("#"+s.activeElement.sandbox).contents().find("#"+t).attr("src",e.response)}}else 0===e.code&&alert("Something went wrong: "+e.response)})}else"block"===$("a#img_Link").css("display")&&""!==$("input#imageURL").val()&&$("input#imageURL").val()!==$(s.activeElement.element).attr("src")&&($(s.activeElement.element).attr("src",$("input#imageURL").val()),s.activeElement.sandbox&&(e=$(s.activeElement.element).attr("id"),$("#"+s.activeElement.sandbox).contents().find("#"+e).attr("src",$("input#imageURL").val())));if($(s.activeElement.element).hasClass("fa")){var l=$.grep(s.activeElement.element.className.split(" "),function(e,t){return 0===e.indexOf("icon-")}).join();l!==$("select#icons").val()&&($(s.activeElement.element).uniqueId(),s._oldIcon[$(s.activeElement.element).attr("id")]=l),$(s.activeElement.element).removeClass(l).addClass($("select#icons").val()),s.activeElement.sandbox&&(e=$(s.activeElement.element).attr("id"),$("#"+s.activeElement.sandbox).contents().find("#"+e).removeClass(l).addClass($("select#icons").val()))}"video"===$(s.activeElement.element).attr("data-type")&&(""!==$("input#youtubeID").val()?$(s.activeElement.element).prev().attr("src","//www.youtube.com/embed/"+$("#video_Tab input#youtubeID").val()):""!==$("input#vimeoID").val()&&$(s.activeElement.element).prev().attr("src","//player.vimeo.com/video/"+$("#video_Tab input#vimeoID").val()+"?title=0&amp;byline=0&amp;portrait=0"),s.activeElement.sandbox&&(e=$(s.activeElement.element).attr("id"),""!==$("input#youtubeID").val()?$("#"+s.activeElement.sandbox).contents().find("#"+e).prev().attr("src","//www.youtube.com/embed/"+$("#video_Tab input#youtubeID").val()):""!==$("input#vimeoID").val()&&$("#"+s.activeElement.sandbox).contents().find("#"+e).prev().attr("src","//player.vimeo.com/video/"+$("#video_Tab input#vimeoID").val()+"?title=0&amp;byline=0&amp;portrait=0"))),$("#detailsAppliedMessage").fadeIn(600,function(){setTimeout(function(){$("#detailsAppliedMessage").fadeOut(1e3)},3e3)}),s.activeElement.parentBlock.heightAdjustment(),o.site.setPendingChanges(!0),a.publish("onBlockChange",s.activeElement.parentBlock,"change")},animateStyleInputIn:function(){$(this).css("position","absolute"),$(this).css("right","0px"),$(this).animate({width:"100%"},500),$(this).focus(function(){this.select()})},animateStyleInputOut:function(){$(this).animate({width:"42%"},500,function(){$(this).css("position","relative"),$(this).css("right","auto")})},buildPagesDropdown:function(e){$(s.selectLinksPages).off("change").select2("destroy"),"undefined"==typeof e&&(e=null);var t,n;for(s.selectLinksPages.innerHTML="",n=document.createElement("OPTION"),n.innerText="Choose a page",n.setAttribute("value","#"),s.selectLinksPages.appendChild(n),t=0;t<o.site.sitePages.length;t++)n=document.createElement("OPTION"),n.innerText=o.site.sitePages[t].name,n.setAttribute("value",o.site.sitePages[t].name+".html"),e===o.site.sitePages[t].name+".html"&&n.setAttribute("selected",!0),s.selectLinksPages.appendChild(n);$(s.selectLinksPages).select2(),$(s.selectLinksPages).trigger("change"),$(s.selectLinksPages).on("change",function(){s.inputCustomLink.value=this.value,s.resetBlockDropdown()})},buildBlocksDropdown:function(e){$(s.selectLinksInernal).off("change").select2("destroy"),"undefined"==typeof e&&(e=null);var t,n;for(s.selectLinksInernal.innerHTML="",n=document.createElement("OPTION"),n.innerText="Choose a block",n.setAttribute("value","#"),s.selectLinksInernal.appendChild(n),t=0;t<o.site.activePage.blocks.length;t++){var a=o.site.activePage.blocks[t].frameDocument,r=a.querySelector(i.pageContainer),l=r.children[0].id;n=document.createElement("OPTION"),n.innerText="#"+l,n.setAttribute("value","#"+l),e==="#"+l&&n.setAttribute("selected",!0),s.selectLinksInernal.appendChild(n)}$(s.selectLinksInernal).select2(),$(s.selectLinksInernal).trigger("change"),$(s.selectLinksInernal).on("change",function(){s.inputCustomLink.value=this.value,s.resetPageDropdown()})},inputCustomLinkBlur:function(e){var t=e.target.value,n;for(n=0;n<s.selectLinksPages.querySelectorAll("option").length;n++)t===s.selectLinksPages.querySelectorAll("option")[n].value&&(s.selectLinksPages.selectedIndex=n,$(s.selectLinksPages).trigger("change").select2());for(n=0;s.selectLinksInernal.querySelectorAll("option").length;n++)t===s.selectLinksInernal.querySelectorAll("option")[n].value&&(s.selectLinksInernal.selectedIndex=n,$(s.selectLinksInernal).trigger("change").select2())},inputCustomLinkFocus:function(){s.resetPageDropdown(),s.resetBlockDropdown()},resetBlockDropdown:function(){s.selectLinksInernal.selectedIndex=0,$(s.selectLinksInernal).select2("destroy").select2()},resetPageDropdown:function(){s.selectLinksPages.selectedIndex=0,$(s.selectLinksPages).select2("destroy").select2()},editLink:function(e){var t;$("a#link_Link").parent().show(),"A"===$(e).prop("tagName")?t=$(e).attr("href"):"A"===$(e).parent().prop("tagName")&&(t=$(e).parent().attr("href")),s.buildPagesDropdown(t),s.buildBlocksDropdown(t),s.inputCustomLink.value=t,e.querySelector("img")?s.linkImage=e.querySelector("img"):s.linkImage=null,e.querySelector(".fa")?s.linkIcon=e.querySelector(".fa").cloneNode(!0):s.linkIcon=null,s.inputLinkText.value=e.innerText},editImage:function(e){$("a#img_Link").parent().show(),$(".imageFileTab").find("input#imageURL").val($(e).attr("src")),$(".imageFileTab").find("a.fileinput-exists").click()},editVideo:function(e){var t;if($("a#video_Link").parent().show(),$("a#video_Link").click(),$(e).prev().attr("src").indexOf("vimeo.com")>-1)t=$(e).prev().attr("src").match(/player\.vimeo\.com\/video\/([0-9]*)/),$("#video_Tab input#vimeoID").val(t[t.length-1]),$("#video_Tab input#youtubeID").val("");else{var n=/.*(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=)([^#\&\?]*).*/;t=$(e).prev().attr("src").match(n),$("#video_Tab input#youtubeID").val(t[1]),$("#video_Tab input#vimeoID").val("")}},editIcon:function(){$("a#icon_Link").parent().show();var e=$.grep(this.activeElement.element.className.split(" "),function(e,t){return 0===e.indexOf("fa-")}).join();$("select#icons option").each(function(){$(this).val()===e&&($(this).attr("selected",!0),$("#icons").trigger("chosen:updated"))})},deleteElement:function(){a.publish("onBeforeDelete");var e;e="A"===$(s.activeElement.element).prop("tagName")?"LI"===$(s.activeElement.element).parent().prop("tagName")?$(s.activeElement.element).parent():$(s.activeElement.element):"IMG"===$(s.activeElement.element).prop("tagName")&&"A"===$(s.activeElement.element).parent().prop("tagName")?$(s.activeElement.element).parent():$(s.activeElement.element),e.fadeOut(500,function(){var t=$(this).closest("body").find("*:first");e.remove();var n=$(s.activeElement.element).attr("id");$("#"+s.activeElement.sandbox).contents().find("#"+n).remove(),s.activeElement.parentBlock.heightAdjustment(),o.site.setPendingChanges(!0)}),$("#deleteElement").modal("hide"),s.closeStyleEditor(),a.publish("onBlockChange",s.activeElement.parentBlock,"change")},cloneElement:function(){a.publish("onBeforeClone");var e,t,n,r,l,c;$(s.activeElement.element).parent().hasClass("propClone")?(e=$(s.activeElement.element).parent().clone(),e.find($(s.activeElement.element).prop("tagName")).attr("style",""),t=$(s.activeElement.element).parent().clone(),t.find($(s.activeElement.element).prop("tagName")).attr("style",""),n=e.find($(s.activeElement.element).prop("tagName")),r=$(s.activeElement.element).parent(),l=$(s.activeElement.element).parent().parent()):(e=$(s.activeElement.element).clone(),e.attr("style",""),t=$(s.activeElement.element).clone(),t.attr("style",""),n=e,r=$(s.activeElement.element),l=$(s.activeElement.element).parent()),r.after(e),s.activeElement.sandbox&&(c=$(s.activeElement.element).attr("id"),$("#"+s.activeElement.sandbox).contents().find("#"+c).after(t)),e.get(0).classList.contains("propClone")||s.setupCanvasElementsOnElement(e.get(0));for(var d in i.editableItems)e.find('*[data-selector="'+d+'"]').each(function(){s.setupCanvasElementsOnElement(this,d)});s.activeElement.parentBlock.heightAdjustment(),o.site.setPendingChanges(!0),a.publish("onBlockChange",s.activeElement.parentBlock,"change")},resetElement:function(){if($(s.activeElement.element).attr("style","").css({outline:"3px dashed red","outline-offset":"-3px",cursor:"pointer"}),s.activeElement.sandbox){var e=$(s.activeElement.element).attr("id");$("#"+s.activeElement.sandbox).contents().find("#"+e).attr("style","")}if($("#styleEditor form#stylingForm").height($("#styleEditor form#stylingForm").height()+"px"),$("#styleEditor form#stylingForm .form-group:not(#styleElTemplate)").fadeOut(500,function(){$(this).remove()}),null!==s._oldIcon[$(s.activeElement.element).attr("id")]){var t=$.grep(s.activeElement.element.className.split(" "),function(e,t){return 0===e.indexOf("fa-")}).join();$(s.activeElement.element).removeClass(t).addClass(s._oldIcon[$(s.activeElement.element).attr("id")]),$("select#icons option").each(function(){$(this).val()===s._oldIcon[$(s.activeElement.element).attr("id")]&&($(this).attr("selected",!0),$("#icons").trigger("chosen:updated"))})}setTimeout(function(){s.buildeStyleElements($(s.activeElement.element).attr("data-selector"))},550),o.site.setPendingChanges(!0),a.publish("onBlockChange",s.activeElement.parentBlock,"change")},hideFileUploads:function(){$("form#imageUploadForm").hide(),$("#imageModal #uploadTabLI").hide()},closeStyleEditor:function(e){void 0!==e&&e.preventDefault(),s.activeElement.editableAttributes&&s.activeElement.editableAttributes.indexOf("content")===-1&&(s.activeElement.removeOutline(),s.activeElement.activate()),"0px"===$("#styleEditor").css("left")&&s.toggleSidePanel("close")},toggleSidePanel:function(e){"open"===e&&"-300px"===$("#styleEditor").css("left")?$("#styleEditor").animate({left:"0px"},250):"close"===e&&"0px"===$("#styleEditor").css("left")&&$("#styleEditor").animate({left:"-300px"},250)}};s.init(),n.styleeditor=s}()},{"../vendor/publisher":12,"./builder.js":2,"./canvasElement.js":3,"./config.js":4}],10:[function(e,t,n){!function(){"use strict";var e={firstMenuWidth:190,secondMenuWidth:300,loaderAnimation:document.getElementById("loader"),secondMenuTriggerContainers:$("#menu #main #elementCats, #menu #main #templatesUl"),siteUrl:siteUrl,baseUrl:baseUrl,setup:function(){$(e.loaderAnimation).fadeOut(function(){$("#menu").animate({left:-210},1e3)}),$(".nav-tabs a").on("click",function(e){e.preventDefault(),$(this).tab("show")}),$("select.select").select2(),$(":radio, :checkbox").radiocheck(),$("[data-toggle=tooltip]").tooltip("hide"),$(".table .toggle-all :checkbox").on("click",function(){var e=$(this),t=e.prop("checked");e.closest(".table").find("tbody :checkbox").radiocheck(t?"check":"uncheck")}),$(".tooltip").addClass(function(){if($(this).prev().attr("data-tooltip-style"))return"tooltip-"+$(this).prev().attr("data-tooltip-style")}),$(".btn-group").on("click","a",function(){$(this).siblings().removeClass("active").end().addClass("active")}),$(".input-group").on("focus",".form-control",function(){$(this).closest(".input-group, .form-group").addClass("focus")}).on("blur",".form-control",function(){$(this).closest(".input-group, .form-group").removeClass("focus")}),$(".table .toggle-all").on("click",function(){var e=$(this).find(":checkbox").prop("checked");$(this).closest(".table").find("tbody :checkbox").checkbox(e?"uncheck":"check")}),$(".table tbody :checkbox").on("check uncheck toggle",function(e){var t=$(this),n=t.prop("checked"),i="toggle"===e.type,o=$(".table tbody :checkbox"),a=o.length===o.filter(":checked").length;t.closest("tr")[n?"addClass":"removeClass"]("selected-row"),i&&t.closest(".table").find(".toggle-all :checkbox").checkbox(a?"check":"uncheck")}),$("[data-toggle='switch']").wrap('<div class="switch" />').parent().bootstrapSwitch(),e.secondMenuTriggerContainers.on("click","a:not(.btn)",e.secondMenuAnimation)},secondMenuAnimation:function(){$("#menu #main a").removeClass("active"),$(this).addClass("active"),$("#menu #second ul li").hide(),$("#menu #second ul li."+$(this).attr("id")).show(),"all"===$(this).attr("id")&&$("#menu #second ul#elements li").show(),$(".menu .second").css("display","block").stop().animate({width:e.secondMenuWidth},500)}};e.setup(),t.exports.appUI=e}()},{}],11:[function(e,t,n){!function(){"use strict";n.getRandomArbitrary=function(e,t){return Math.floor(Math.random()*(t-e)+e)}}()},{}],12:[function(e,t,n){!function(e,i){if("object"==typeof n)t.exports=i();else if("function"==typeof define&&define.amd)define(i);else{var o=e.publisher,a=e.publisher=i();e.publisher.noConflict=function(){return e.publisher=o,a}}}(this,function(){var e=function(e){function t(t,n,i){var o={handler:n,context:i||e};return t=s[t]||(s[t]=[]),t.push(o),{attach:function(){return t.push(o),this},detach:function(){return a(t,o),this}}}function n(e){var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]=t(i,e[i]));return n;
}function i(e,n){return t(n,e[n],e)}function o(e,t){for(var n=[],o=0,a=t.length;o<a;o++)n.push(i(e,t[o]));return n}function a(e,t){for(var n=0,i=e.length;n<i;n++)e[n]===t&&e.splice(n,1)}var s={};return e=e||{},e.publish=function(t){if(!s[t])return e;for(var n=[].slice.call(arguments,1),i=0,o=s[t].length;i<o;i++)s[t][i].handler.apply(s[t][i].context,n);return e},e.subscribe=function(e,a){var s=typeof e;return"string"===s?t.apply(null,arguments):"object"!==s||a?"string"==typeof a?i.apply(null,arguments):o.apply(null,arguments):n.apply(null,arguments)},e};return e(e)})},{}],13:[function(e,t,n){"classList"in document.createElement("_")||!function(e){"use strict";if("Element"in e){var t="classList",n="prototype",i=e.Element[n],o=Object,a=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},s=Array[n].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},r=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},l=function(e,t){if(""===t)throw new r("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(t))throw new r("INVALID_CHARACTER_ERR","String contains an invalid character");return s.call(e,t)},c=function(e){for(var t=a.call(e.getAttribute("class")||""),n=t?t.split(/\s+/):[],i=0,o=n.length;i<o;i++)this.push(n[i]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},d=c[n]=[],u=function(){return new c(this)};if(r[n]=Error[n],d.item=function(e){return this[e]||null},d.contains=function(e){return e+="",l(this,e)!==-1},d.add=function(){var e=arguments,t=0,n=e.length,i,o=!1;do i=e[t]+"",l(this,i)===-1&&(this.push(i),o=!0);while(++t<n);o&&this._updateClassName()},d.remove=function(){var e=arguments,t=0,n=e.length,i,o=!1,a;do for(i=e[t]+"",a=l(this,i);a!==-1;)this.splice(a,1),o=!0,a=l(this,i);while(++t<n);o&&this._updateClassName()},d.toggle=function(e,t){e+="";var n=this.contains(e),i=n?t!==!0&&"remove":t!==!1&&"add";return i&&this[i](e),t===!0||t===!1?t:!n},d.toString=function(){return this.join(" ")},o.defineProperty){var h={get:u,enumerable:!0,configurable:!0};try{o.defineProperty(i,t,h)}catch(e){e.number===-2146823252&&(h.enumerable=!1,o.defineProperty(i,t,h))}}else o[n].__defineGetter__&&i.__defineGetter__(t,u)}}(self),function(e){"use strict";if(e.URL=e.URL||e.webkitURL,e.Blob&&e.URL)try{return void new Blob}catch(e){}var t=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||function(e){var t=function(e){return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1]},n=function e(){this.data=[]},i=function e(t,n,i){this.data=t,this.size=t.length,this.type=n,this.encoding=i},o=n.prototype,a=i.prototype,s=e.FileReaderSync,r=function(e){this.code=this[this.name=e]},l="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),c=l.length,d=e.URL||e.webkitURL||e,u=d.createObjectURL,h=d.revokeObjectURL,f=d,m=e.btoa,p=e.atob,g=e.ArrayBuffer,v=e.Uint8Array,b=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;for(i.fake=a.fake=!0;c--;)r.prototype[l[c]]=c+1;return d.createObjectURL||(f=e.URL=function(e){var t=document.createElementNS("http://www.w3.org/1999/xhtml","a"),n;return t.href=e,"origin"in t||("data:"===t.protocol.toLowerCase()?t.origin=null:(n=e.match(b),t.origin=n&&n[1])),t}),f.createObjectURL=function(e){var t=e.type,n;return null===t&&(t="application/octet-stream"),e instanceof i?(n="data:"+t,"base64"===e.encoding?n+";base64,"+e.data:"URI"===e.encoding?n+","+decodeURIComponent(e.data):m?n+";base64,"+m(e.data):n+","+encodeURIComponent(e.data)):u?u.call(d,e):void 0},f.revokeObjectURL=function(e){"data:"!==e.substring(0,5)&&h&&h.call(d,e)},o.append=function(e){var n=this.data;if(v&&(e instanceof g||e instanceof v)){for(var o="",a=new v(e),l=0,c=a.length;l<c;l++)o+=String.fromCharCode(a[l]);n.push(o)}else if("Blob"===t(e)||"File"===t(e)){if(!s)throw new r("NOT_READABLE_ERR");var d=new s;n.push(d.readAsBinaryString(e))}else e instanceof i?"base64"===e.encoding&&p?n.push(p(e.data)):"URI"===e.encoding?n.push(decodeURIComponent(e.data)):"raw"===e.encoding&&n.push(e.data):("string"!=typeof e&&(e+=""),n.push(unescape(encodeURIComponent(e))))},o.getBlob=function(e){return arguments.length||(e=null),new i(this.data.join(""),e,"raw")},o.toString=function(){return"[object BlobBuilder]"},a.slice=function(e,t,n){var o=arguments.length;return o<3&&(n=null),new i(this.data.slice(e,o>1?t:this.data.length),n,this.encoding)},a.toString=function(){return"[object Blob]"},a.close=function(){this.size=0,delete this.data},n}(e);e.Blob=function(e,n){var i=n?n.type||"":"",o=new t;if(e)for(var a=0,s=e.length;a<s;a++)Uint8Array&&e[a]instanceof Uint8Array?o.append(e[a].buffer):o.append(e[a]);var r=o.getBlob(i);return!r.slice&&r.webkitSlice&&(r.slice=r.webkitSlice),r};var n=Object.getPrototypeOf||function(e){return e.__proto__};e.Blob.prototype=n(new e.Blob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this),function(e,n){"use strict";"object"==typeof t?t.exports=n:"function"==typeof define&&define.amd?define(function(){return n}):e.MediumEditor=n}(this,function(){"use strict";function e(e,t){return this.init(e,t)}return e.extensions={},function(t){function n(e,t){var n,i=Array.prototype.slice.call(arguments,2);t=t||{};for(var o=0;o<i.length;o++){var a=i[o];if(a)for(n in a)a.hasOwnProperty(n)&&"undefined"!=typeof a[n]&&(e||t.hasOwnProperty(n)===!1)&&(t[n]=a[n])}return t}var i=!1;try{var o=document.createElement("div"),a=document.createTextNode(" ");o.appendChild(a),i=o.contains(a)}catch(e){}var s={isIE:"Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent),isEdge:null!==/Edge\/\d+/.exec(navigator.userAgent),isFF:navigator.userAgent.toLowerCase().indexOf("firefox")>-1,isMac:t.navigator.platform.toUpperCase().indexOf("MAC")>=0,keyCode:{BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,DELETE:46,K:75,M:77},isMetaCtrlKey:function(e){return!!(s.isMac&&e.metaKey||!s.isMac&&e.ctrlKey)},isKey:function(e,t){var n=s.getKeyCode(e);return!1===Array.isArray(t)?n===t:-1!==t.indexOf(n)},getKeyCode:function(e){var t=e.which;return null===t&&(t=null!==e.charCode?e.charCode:e.keyCode),t},blockContainerElementNames:["p","h1","h2","h3","h4","h5","h6","blockquote","pre","ul","li","ol","address","article","aside","audio","canvas","dd","dl","dt","fieldset","figcaption","figure","footer","form","header","hgroup","main","nav","noscript","output","section","video","table","thead","tbody","tfoot","tr","th","td"],emptyElementNames:["br","col","colgroup","hr","img","input","source","wbr"],extend:function e(){var t=[!0].concat(Array.prototype.slice.call(arguments));return n.apply(this,t)},defaults:function e(){var t=[!1].concat(Array.prototype.slice.call(arguments));return n.apply(this,t)},createLink:function(e,t,n,i){var o=e.createElement("a");return s.moveTextRangeIntoElement(t[0],t[t.length-1],o),o.setAttribute("href",n),i&&o.setAttribute("target",i),o},findOrCreateMatchingTextNodes:function(e,t,n){for(var i=e.createTreeWalker(t,NodeFilter.SHOW_ALL,null,!1),o=[],a=0,r=!1,l=null,c=null;null!==(l=i.nextNode());)if(!(l.nodeType>3))if(3===l.nodeType){if(!r&&n.start<a+l.nodeValue.length&&(r=!0,c=s.splitStartNodeIfNeeded(l,n.start,a)),r&&s.splitEndNodeIfNeeded(l,c,n.end,a),r&&a===n.end)break;if(r&&a>n.end+1)throw new Error("PerformLinking overshot the target!");r&&o.push(c||l),a+=l.nodeValue.length,null!==c&&(a+=c.nodeValue.length,i.nextNode()),c=null}else"img"===l.tagName.toLowerCase()&&(!r&&n.start<=a&&(r=!0),r&&o.push(l));return o},splitStartNodeIfNeeded:function(e,t,n){return t!==n?e.splitText(t-n):null},splitEndNodeIfNeeded:function(e,t,n,i){var o,a;o=i+(t||e).nodeValue.length+(t?e.nodeValue.length:0)-1,a=(t||e).nodeValue.length-(o+1-n),o>=n&&i!==o&&0!==a&&(t||e).splitText(a)},splitByBlockElements:function(t){if(3!==t.nodeType&&1!==t.nodeType)return[];var n=[],i=e.util.blockContainerElementNames.join(",");if(3===t.nodeType||0===t.querySelectorAll(i).length)return[t];for(var o=0;o<t.childNodes.length;o++){var a=t.childNodes[o];if(3===a.nodeType)n.push(a);else if(1===a.nodeType){var s=a.querySelectorAll(i);0===s.length?n.push(a):n=n.concat(e.util.splitByBlockElements(a))}}return n},findAdjacentTextNodeWithContent:function e(t,n,i){var o=!1,a,s=i.createNodeIterator(t,NodeFilter.SHOW_TEXT,null,!1);for(a=s.nextNode();a;){if(a===n)o=!0;else if(o&&3===a.nodeType&&a.nodeValue&&a.nodeValue.trim().length>0)break;a=s.nextNode()}return a},findPreviousSibling:function(e){if(!e||s.isMediumEditorElement(e))return!1;for(var t=e.previousSibling;!t&&!s.isMediumEditorElement(e.parentNode);)e=e.parentNode,t=e.previousSibling;return t},isDescendant:function e(t,n,o){if(!t||!n)return!1;if(t===n)return!!o;if(1!==t.nodeType)return!1;if(i||3!==n.nodeType)return t.contains(n);for(var a=n.parentNode;null!==a;){if(a===t)return!0;a=a.parentNode}return!1},isElement:function e(t){return!(!t||1!==t.nodeType)},throttle:function(e,t){var n=50,i,o,a,s=null,r=0,l=function(){r=Date.now(),s=null,a=e.apply(i,o),s||(i=o=null)};return t||0===t||(t=n),function(){var n=Date.now(),c=t-(n-r);return i=this,o=arguments,c<=0||c>t?(s&&(clearTimeout(s),s=null),r=n,a=e.apply(i,o),s||(i=o=null)):s||(s=setTimeout(l,c)),a}},traverseUp:function(e,t){if(!e)return!1;do{if(1===e.nodeType){if(t(e))return e;if(s.isMediumEditorElement(e))return!1}e=e.parentNode}while(e);return!1},htmlEntities:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},insertHTMLCommand:function(t,n){var i,o,a,r,l,c,d,u=!1,h=["insertHTML",!1,n];if(!e.util.isEdge&&t.queryCommandSupported("insertHTML"))try{return t.execCommand.apply(t,h)}catch(e){}if(i=t.getSelection(),i.rangeCount){if(o=i.getRangeAt(0),d=o.commonAncestorContainer,s.isMediumEditorElement(d)&&!d.firstChild)o.selectNode(d.appendChild(t.createTextNode("")));else if(3===d.nodeType&&0===o.startOffset&&o.endOffset===d.nodeValue.length||3!==d.nodeType&&d.innerHTML===o.toString()){for(;!s.isMediumEditorElement(d)&&d.parentNode&&1===d.parentNode.childNodes.length&&!s.isMediumEditorElement(d.parentNode);)d=d.parentNode;o.selectNode(d)}for(o.deleteContents(),a=t.createElement("div"),a.innerHTML=n,r=t.createDocumentFragment();a.firstChild;)l=a.firstChild,c=r.appendChild(l);o.insertNode(r),c&&(o=o.cloneRange(),o.setStartAfter(c),o.collapse(!0),i.removeAllRanges(),i.addRange(o)),u=!0}return t.execCommand.callListeners&&t.execCommand.callListeners(h,u),u},execFormatBlock:function(t,n){var i=s.getTopBlockContainer(e.selection.getSelectionStart(t)),o;if("blockquote"===n){if(i&&(o=Array.prototype.slice.call(i.childNodes),o.some(function(e){return s.isBlockContainer(e)})))return t.execCommand("outdent",!1,null);if(s.isIE)return t.execCommand("indent",!1,n)}if(i&&n===i.nodeName.toLowerCase()&&(n="p"),s.isIE&&(n="<"+n+">"),i&&"blockquote"===i.nodeName.toLowerCase()){if(s.isIE&&"<p>"===n)return t.execCommand("outdent",!1,n);if((s.isFF||s.isEdge)&&"p"===n)return o=Array.prototype.slice.call(i.childNodes),o.some(function(e){return!s.isBlockContainer(e)})&&t.execCommand("formatBlock",!1,n),t.execCommand("outdent",!1,n)}return t.execCommand("formatBlock",!1,n)},setTargetBlank:function(e,t){var n,i=t||!1;if("a"===e.nodeName.toLowerCase())e.target="_blank";else for(e=e.getElementsByTagName("a"),n=0;n<e.length;n+=1)!1!==i&&i!==e[n].attributes.href.value||(e[n].target="_blank")},removeTargetBlank:function(e,t){var n;if("a"===e.nodeName.toLowerCase())e.removeAttribute("target");else for(e=e.getElementsByTagName("a"),n=0;n<e.length;n+=1)t===e[n].attributes.href.value&&e[n].removeAttribute("target")},addClassToAnchors:function(e,t){var n=t.split(" "),i,o;if("a"===e.nodeName.toLowerCase())for(o=0;o<n.length;o+=1)e.classList.add(n[o]);else for(e=e.getElementsByTagName("a"),i=0;i<e.length;i+=1)for(o=0;o<n.length;o+=1)e[i].classList.add(n[o])},isListItem:function(e){if(!e)return!1;if("li"===e.nodeName.toLowerCase())return!0;for(var t=e.parentNode,n=t.nodeName.toLowerCase();"li"===n||!s.isBlockContainer(t)&&"div"!==n;){if("li"===n)return!0;if(t=t.parentNode,!t)return!1;n=t.nodeName.toLowerCase()}return!1},cleanListDOM:function(t,n){if("li"===n.nodeName.toLowerCase()){var i=n.parentElement;"p"===i.parentElement.nodeName.toLowerCase()&&(s.unwrap(i.parentElement,t),e.selection.moveCursor(t,n.firstChild,n.firstChild.textContent.length))}},splitOffDOMTree:function(e,t,n){for(var i=t,o=null,a=!n;i!==e;){var s=i.parentNode,r=s.cloneNode(!1),l=a?i:s.firstChild,c;for(o&&(a?r.appendChild(o):c=o),o=r;l;){var d=l.nextSibling;l===i?(l.hasChildNodes()?l=l.cloneNode(!1):l.parentNode.removeChild(l),l.textContent&&o.appendChild(l),l=a?d:null):(l.parentNode.removeChild(l),(l.hasChildNodes()||l.textContent)&&o.appendChild(l),l=d)}c&&o.appendChild(c),i=s}return o},moveTextRangeIntoElement:function(e,t,n){if(!e||!t)return!1;var i=s.findCommonRoot(e,t);if(!i)return!1;if(t===e){var o=e.parentNode,a=e.nextSibling;return o.removeChild(e),n.appendChild(e),a?o.insertBefore(n,a):o.appendChild(n),n.hasChildNodes()}for(var r=[],l,c,d,u=0;u<i.childNodes.length;u++)if(d=i.childNodes[u],l){if(s.isDescendant(d,t,!0)){c=d;break}r.push(d)}else s.isDescendant(d,e,!0)&&(l=d);var h=c.nextSibling,f=i.ownerDocument.createDocumentFragment();return l===e?(l.parentNode.removeChild(l),f.appendChild(l)):f.appendChild(s.splitOffDOMTree(l,e)),r.forEach(function(e){e.parentNode.removeChild(e),f.appendChild(e)}),c===t?(c.parentNode.removeChild(c),f.appendChild(c)):f.appendChild(s.splitOffDOMTree(c,t,!0)),n.appendChild(f),c.parentNode===i?i.insertBefore(n,c):h?i.insertBefore(n,h):i.appendChild(n),n.hasChildNodes()},depthOfNode:function(e){for(var t=0,n=e;null!==n.parentNode;)n=n.parentNode,t++;return t},findCommonRoot:function(e,t){for(var n=s.depthOfNode(e),i=s.depthOfNode(t),o=e,a=t;n!==i;)n>i?(o=o.parentNode,n-=1):(a=a.parentNode,i-=1);for(;o!==a;)o=o.parentNode,a=a.parentNode;return o},isElementAtBeginningOfBlock:function(e){for(var t,n;!s.isBlockContainer(e)&&!s.isMediumEditorElement(e);){for(n=e;n=n.previousSibling;)if(t=3===n.nodeType?n.nodeValue:n.textContent,t.length>0)return!1;e=e.parentNode}return!0},isMediumEditorElement:function(e){return e&&e.getAttribute&&!!e.getAttribute("data-medium-editor-element")},getContainerEditorElement:function(e){return s.traverseUp(e,function(e){return s.isMediumEditorElement(e)})},isBlockContainer:function(e){return e&&3!==e.nodeType&&s.blockContainerElementNames.indexOf(e.nodeName.toLowerCase())!==-1},getClosestBlockContainer:function(e){return s.traverseUp(e,function(e){return s.isBlockContainer(e)||s.isMediumEditorElement(e)})},getTopBlockContainer:function(e){var t=!!s.isBlockContainer(e)&&e;return s.traverseUp(e,function(e){return s.isBlockContainer(e)&&(t=e),!(t||!s.isMediumEditorElement(e))&&(t=e,!0)}),t},getFirstSelectableLeafNode:function(e){for(;e&&e.firstChild;)e=e.firstChild;if(e=s.traverseUp(e,function(e){return s.emptyElementNames.indexOf(e.nodeName.toLowerCase())===-1}),"table"===e.nodeName.toLowerCase()){var t=e.querySelector("th, td");t&&(e=t)}return e},getFirstTextNode:function(e){return s.warn("getFirstTextNode is deprecated and will be removed in version 6.0.0"),s._getFirstTextNode(e)},_getFirstTextNode:function(e){if(3===e.nodeType)return e;for(var t=0;t<e.childNodes.length;t++){var n=s._getFirstTextNode(e.childNodes[t]);if(null!==n)return n}return null},ensureUrlHasProtocol:function(e){return e.indexOf("://")===-1?"http://"+e:e},warn:function(){void 0!==t.console&&"function"==typeof t.console.warn&&t.console.warn.apply(t.console,arguments)},deprecated:function(e,t,n){var i=e+" is deprecated, please use "+t+" instead.";n&&(i+=" Will be removed in "+n),s.warn(i)},deprecatedMethod:function(e,t,n,i){s.deprecated(e,t,i),"function"==typeof this[t]&&this[t].apply(this,n)},cleanupAttrs:function(e,t){t.forEach(function(t){e.removeAttribute(t)})},cleanupTags:function(e,t){t.forEach(function(t){e.nodeName.toLowerCase()===t&&e.parentNode.removeChild(e)})},getClosestTag:function(e,t){return s.traverseUp(e,function(e){return e.nodeName.toLowerCase()===t.toLowerCase()})},unwrap:function(e,t){for(var n=t.createDocumentFragment(),i=Array.prototype.slice.call(e.childNodes),o=0;o<i.length;o++)n.appendChild(i[o]);n.childNodes.length?e.parentNode.replaceChild(n,e):e.parentNode.removeChild(e)}};e.util=s}(window),function(){var t=function(t){e.util.extend(this,t)};t.extend=function(t){var n=this,i;i=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return n.apply(this,arguments)},e.util.extend(i,n);var o=function(){this.constructor=i};return o.prototype=n.prototype,i.prototype=new o,t&&e.util.extend(i.prototype,t),i},t.prototype={init:function(){},base:void 0,name:void 0,checkState:void 0,destroy:void 0,queryCommandState:void 0,isActive:void 0,isAlreadyApplied:void 0,setActive:void 0,setInactive:void 0,window:void 0,document:void 0,getEditorElements:function(){return this.base.elements},getEditorId:function(){return this.base.id},getEditorOption:function(e){return this.base.options[e]}},["execAction","on","off","subscribe","trigger"].forEach(function(e){t.prototype[e]=function(){return this.base[e].apply(this.base,arguments)}}),e.Extension=t}(),function(){function t(t){return e.util.isBlockContainer(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}var n={findMatchingSelectionParent:function(t,n){var i=n.getSelection(),o,a;return 0!==i.rangeCount&&(o=i.getRangeAt(0),a=o.commonAncestorContainer,e.util.traverseUp(a,t))},getSelectionElement:function(t){return this.findMatchingSelectionParent(function(t){return e.util.isMediumEditorElement(t)},t)},exportSelection:function(e,t){if(!e)return null;var n=null,i=t.getSelection();if(i.rangeCount>0){var o=i.getRangeAt(0),a=o.cloneRange(),s;a.selectNodeContents(e),a.setEnd(o.startContainer,o.startOffset),s=a.toString().length,n={start:s,end:s+o.toString().length},this.doesRangeStartWithImages(o,t)&&(n.startsWithImage=!0);var r=this.getTrailingImageCount(e,n,o.endContainer,o.endOffset);if(r&&(n.trailingImageCount=r),0!==s){var l=this.getIndexRelativeToAdjacentEmptyBlocks(t,e,o.startContainer,o.startOffset);l!==-1&&(n.emptyBlocksIndex=l)}}return n},importSelection:function(e,t,n,i){if(e&&t){var o=n.createRange();o.setStart(t,0),o.collapse(!0);var a=t,s=[],r=0,l=!1,c=!1,d=0,u=!1,h,f=!1,m=null;for((i||e.startsWithImage||"undefined"!=typeof e.emptyBlocksIndex)&&(f=!0);!u&&a;)if(a.nodeType>3)a=s.pop();else{if(3!==a.nodeType||c){if(e.trailingImageCount&&c&&("img"===a.nodeName.toLowerCase()&&d++,d===e.trailingImageCount)){for(var p=0;a.parentNode.childNodes[p]!==a;)p++;o.setEnd(a.parentNode,p+1),u=!0}if(!u&&1===a.nodeType)for(var g=a.childNodes.length-1;g>=0;)s.push(a.childNodes[g]),g-=1}else h=r+a.length,!l&&e.start>=r&&e.start<=h&&(f||e.start<h?(o.setStart(a,e.start-r),l=!0):m=a),l&&e.end>=r&&e.end<=h&&(e.trailingImageCount?c=!0:(o.setEnd(a,e.end-r),u=!0)),r=h;u||(a=s.pop())}!l&&m&&(o.setStart(m,m.length),o.setEnd(m,m.length)),"undefined"!=typeof e.emptyBlocksIndex&&(o=this.importSelectionMoveCursorPastBlocks(n,t,e.emptyBlocksIndex,o)),i&&(o=this.importSelectionMoveCursorPastAnchor(e,o));var v=n.getSelection();v.removeAllRanges(),v.addRange(o)}},importSelectionMoveCursorPastAnchor:function(t,n){var i=function(e){return"a"===e.nodeName.toLowerCase()};if(t.start===t.end&&3===n.startContainer.nodeType&&n.startOffset===n.startContainer.nodeValue.length&&e.util.traverseUp(n.startContainer,i)){for(var o=n.startContainer,a=n.startContainer.parentNode;null!==a&&"a"!==a.nodeName.toLowerCase();)a.childNodes[a.childNodes.length-1]!==o?a=null:(o=a,a=a.parentNode);if(null!==a&&"a"===a.nodeName.toLowerCase()){for(var s=null,r=0;null===s&&r<a.parentNode.childNodes.length;r++)a.parentNode.childNodes[r]===a&&(s=r);n.setStart(a.parentNode,s+1),n.collapse(!0)}}return n},importSelectionMoveCursorPastBlocks:function(n,i,o,a){var s=n.createTreeWalker(i,NodeFilter.SHOW_ELEMENT,t,!1),r=a.startContainer,l,c,d=0;for(o=o||1,l=3===r.nodeType&&e.util.isBlockContainer(r.previousSibling)?r.previousSibling:e.util.getClosestBlockContainer(r);s.nextNode();)if(c){if(c=s.currentNode,d++,d===o)break;if(c.textContent.length>0)break}else l===s.currentNode&&(c=s.currentNode);return c||(c=l),a.setStart(e.util.getFirstSelectableLeafNode(c),0),a},getIndexRelativeToAdjacentEmptyBlocks:function(n,i,o,a){if(o.textContent.length>0&&a>0)return-1;var s=o;if(3!==s.nodeType&&(s=o.childNodes[a]),s){if(!e.util.isElementAtBeginningOfBlock(s))return-1;var r=e.util.findPreviousSibling(s);if(!r)return-1;if(r.nodeValue)return-1}for(var l=e.util.getClosestBlockContainer(o),c=n.createTreeWalker(i,NodeFilter.SHOW_ELEMENT,t,!1),d=0;c.nextNode();){var u=""===c.currentNode.textContent;if((u||d>0)&&(d+=1),c.currentNode===l)return d;u||(d=0)}return d},doesRangeStartWithImages:function(e,t){if(0!==e.startOffset||1!==e.startContainer.nodeType)return!1;if("img"===e.startContainer.nodeName.toLowerCase())return!0;var n=e.startContainer.querySelector("img");if(!n)return!1;for(var i=t.createTreeWalker(e.startContainer,NodeFilter.SHOW_ALL,null,!1);i.nextNode();){var o=i.currentNode;if(o===n)break;if(o.nodeValue)return!1}return!0},getTrailingImageCount:function(e,t,n,i){if(0===i||1!==n.nodeType)return 0;if("img"!==n.nodeName.toLowerCase()&&!n.querySelector("img"))return 0;for(var o=n.childNodes[i-1];o.hasChildNodes();)o=o.lastChild;for(var a=e,s=[],r=0,l=!1,c=!1,d=!1,u,h=0;!d&&a;)if(a.nodeType>3)a=s.pop();else{if(3!==a.nodeType||c){if("img"===a.nodeName.toLowerCase()&&h++,a===o)d=!0;else if(1===a.nodeType)for(var f=a.childNodes.length-1;f>=0;)s.push(a.childNodes[f]),f-=1}else h=0,u=r+a.length,!l&&t.start>=r&&t.start<=u&&(l=!0),l&&t.end>=r&&t.end<=u&&(c=!0),r=u;d||(a=s.pop())}return h},selectionContainsContent:function(e){var t=e.getSelection();if(!t||t.isCollapsed||!t.rangeCount)return!1;if(""!==t.toString().trim())return!0;var n=this.getSelectedParentElement(t.getRangeAt(0));return!(!n||!("img"===n.nodeName.toLowerCase()||1===n.nodeType&&n.querySelector("img")))},selectionInContentEditableFalse:function(e){var t,n=this.findMatchingSelectionParent(function(e){var n=e&&e.getAttribute("contenteditable");return"true"===n&&(t=!0),"#text"!==e.nodeName&&"false"===n},e);return!t&&n},getSelectionHtml:function e(t){var n,i="",o=t.getSelection(),a,s;if(o.rangeCount){for(s=t.createElement("div"),n=0,a=o.rangeCount;n<a;n+=1)s.appendChild(o.getRangeAt(n).cloneContents());i=s.innerHTML}return i},getCaretOffsets:function e(t,n){var i,o;return n||(n=window.getSelection().getRangeAt(0)),i=n.cloneRange(),o=n.cloneRange(),i.selectNodeContents(t),i.setEnd(n.endContainer,n.endOffset),o.selectNodeContents(t),o.setStart(n.endContainer,n.endOffset),{left:i.toString().length,right:o.toString().length}},rangeSelectsSingleNode:function(e){var t=e.startContainer;return t===e.endContainer&&t.hasChildNodes()&&e.endOffset===e.startOffset+1},getSelectedParentElement:function(e){return e?this.rangeSelectsSingleNode(e)&&3!==e.startContainer.childNodes[e.startOffset].nodeType?e.startContainer.childNodes[e.startOffset]:3===e.startContainer.nodeType?e.startContainer.parentNode:e.startContainer:null},getSelectedElements:function(e){var t=e.getSelection(),n,i,o;if(!t.rangeCount||t.isCollapsed||!t.getRangeAt(0).commonAncestorContainer)return[];if(n=t.getRangeAt(0),3===n.commonAncestorContainer.nodeType){for(i=[],o=n.commonAncestorContainer;o.parentNode&&1===o.parentNode.childNodes.length;)i.push(o.parentNode),o=o.parentNode;return i}return[].filter.call(n.commonAncestorContainer.getElementsByTagName("*"),function(e){return"function"!=typeof t.containsNode||t.containsNode(e,!0)})},selectNode:function(e,t){var n=t.createRange(),i=t.getSelection();n.selectNodeContents(e),i.removeAllRanges(),i.addRange(n)},select:function(e,t,n,i,o){e.getSelection().removeAllRanges();var a=e.createRange();return a.setStart(t,n),i?a.setEnd(i,o):a.collapse(!0),e.getSelection().addRange(a),a},clearSelection:function(e,t){t?e.getSelection().collapseToStart():e.getSelection().collapseToEnd()},moveCursor:function(e,t,n){this.select(e,t,n)},getSelectionRange:function(e){var t=e.getSelection();return 0===t.rangeCount?null:t.getRangeAt(0)},getSelectionStart:function(e){var t=e.getSelection().anchorNode,n=t&&3===t.nodeType?t.parentNode:t;return n}};e.selection=n}(),function(){var t=function(e){this.base=e,this.options=this.base.options,this.events=[],this.disabledEvents={},this.customEvents={},this.listeners={}};t.prototype={InputEventOnContenteditableSupported:!e.util.isIE&&!e.util.isEdge,attachDOMEvent:function(e,t,n,i){e.addEventListener(t,n,i),this.events.push([e,t,n,i])},detachDOMEvent:function(e,t,n,i){var o=this.indexOfListener(e,t,n,i),a;o!==-1&&(a=this.events.splice(o,1)[0],a[0].removeEventListener(a[1],a[2],a[3]))},indexOfListener:function(e,t,n,i){var o,a,s;for(o=0,a=this.events.length;o<a;o+=1)if(s=this.events[o],s[0]===e&&s[1]===t&&s[2]===n&&s[3]===i)return o;return-1},detachAllDOMEvents:function(){for(var e=this.events.pop();e;)e[0].removeEventListener(e[1],e[2],e[3]),e=this.events.pop()},enableCustomEvent:function(e){void 0!==this.disabledEvents[e]&&delete this.disabledEvents[e]},disableCustomEvent:function(e){this.disabledEvents[e]=!0},attachCustomEvent:function(e,t){this.setupListener(e),this.customEvents[e]||(this.customEvents[e]=[]),this.customEvents[e].push(t)},detachCustomEvent:function(e,t){var n=this.indexOfCustomListener(e,t);n!==-1&&this.customEvents[e].splice(n,1)},indexOfCustomListener:function(e,t){return this.customEvents[e]&&this.customEvents[e].length?this.customEvents[e].indexOf(t):-1},detachAllCustomEvents:function(){this.customEvents={}},triggerCustomEvent:function(e,t,n){this.customEvents[e]&&!this.disabledEvents[e]&&this.customEvents[e].forEach(function(e){e(t,n)})},destroy:function(){this.detachAllDOMEvents(),this.detachAllCustomEvents(),this.detachExecCommand(),this.base.elements&&this.base.elements.forEach(function(e){e.removeAttribute("data-medium-focused")})},attachToExecCommand:function(){this.execCommandListener||(this.execCommandListener=function(e){this.handleDocumentExecCommand(e)}.bind(this),this.wrapExecCommand(),this.options.ownerDocument.execCommand.listeners.push(this.execCommandListener))},detachExecCommand:function(){var e=this.options.ownerDocument;if(this.execCommandListener&&e.execCommand.listeners){var t=e.execCommand.listeners.indexOf(this.execCommandListener);t!==-1&&e.execCommand.listeners.splice(t,1),e.execCommand.listeners.length||this.unwrapExecCommand()}},wrapExecCommand:function(){var e=this.options.ownerDocument;if(!e.execCommand.listeners){var t=function(t,n){e.execCommand.listeners&&e.execCommand.listeners.forEach(function(e){e({command:t[0],value:t[2],args:t,result:n})})},n=function(){var n=e.execCommand.orig.apply(this,arguments);if(!e.execCommand.listeners)return n;var i=Array.prototype.slice.call(arguments);return t(i,n),n};n.orig=e.execCommand,n.listeners=[],n.callListeners=t,e.execCommand=n}},unwrapExecCommand:function(){var e=this.options.ownerDocument;e.execCommand.orig&&(e.execCommand=e.execCommand.orig)},setupListener:function(e){if(!this.listeners[e]){switch(e){case"externalInteraction":this.attachDOMEvent(this.options.ownerDocument.body,"mousedown",this.handleBodyMousedown.bind(this),!0),this.attachDOMEvent(this.options.ownerDocument.body,"click",this.handleBodyClick.bind(this),!0),this.attachDOMEvent(this.options.ownerDocument.body,"focus",this.handleBodyFocus.bind(this),!0);break;case"blur":this.setupListener("externalInteraction");break;case"focus":this.setupListener("externalInteraction");break;case"editableInput":this.contentCache=[],this.base.elements.forEach(function(e){this.contentCache[e.getAttribute("medium-editor-index")]=e.innerHTML,this.InputEventOnContenteditableSupported&&this.attachDOMEvent(e,"input",this.handleInput.bind(this))}.bind(this)),this.InputEventOnContenteditableSupported||(this.setupListener("editableKeypress"),this.keypressUpdateInput=!0,this.attachDOMEvent(document,"selectionchange",this.handleDocumentSelectionChange.bind(this)),this.attachToExecCommand());break;case"editableClick":this.attachToEachElement("click",this.handleClick);break;case"editableBlur":this.attachToEachElement("blur",this.handleBlur);break;case"editableKeypress":this.attachToEachElement("keypress",this.handleKeypress);break;case"editableKeyup":this.attachToEachElement("keyup",this.handleKeyup);break;case"editableKeydown":this.attachToEachElement("keydown",this.handleKeydown);break;case"editableKeydownSpace":this.setupListener("editableKeydown");break;case"editableKeydownEnter":this.setupListener("editableKeydown");break;case"editableKeydownTab":this.setupListener("editableKeydown");break;case"editableKeydownDelete":this.setupListener("editableKeydown");break;case"editableMouseover":this.attachToEachElement("mouseover",this.handleMouseover);break;case"editableDrag":this.attachToEachElement("dragover",this.handleDragging),this.attachToEachElement("dragleave",this.handleDragging);break;case"editableDrop":this.attachToEachElement("drop",this.handleDrop);break;case"editablePaste":this.attachToEachElement("paste",this.handlePaste)}this.listeners[e]=!0}},attachToEachElement:function(e,t){this.base.elements.forEach(function(n){this.attachDOMEvent(n,e,t.bind(this))},this)},focusElement:function(e){e.focus(),this.updateFocus(e,{target:e,type:"focus"})},updateFocus:function(t,n){var i=this.base.getExtensionByName("toolbar"),o=i?i.getToolbarElement():null,a=this.base.getExtensionByName("anchor-preview"),s=a&&a.getPreviewElement?a.getPreviewElement():null,r=this.base.getFocusedElement(),l;r&&"click"===n.type&&this.lastMousedownTarget&&(e.util.isDescendant(r,this.lastMousedownTarget,!0)||e.util.isDescendant(o,this.lastMousedownTarget,!0)||e.util.isDescendant(s,this.lastMousedownTarget,!0))&&(l=r),l||this.base.elements.some(function(n){return!l&&e.util.isDescendant(n,t,!0)&&(l=n),!!l},this);var c=!e.util.isDescendant(r,t,!0)&&!e.util.isDescendant(o,t,!0)&&!e.util.isDescendant(s,t,!0);l!==r&&(r&&c&&(r.removeAttribute("data-medium-focused"),this.triggerCustomEvent("blur",n,r)),l&&(l.setAttribute("data-medium-focused",!0),this.triggerCustomEvent("focus",n,l))),c&&this.triggerCustomEvent("externalInteraction",n)},updateInput:function(e,t){if(this.contentCache){var n=e.getAttribute("medium-editor-index");e.innerHTML!==this.contentCache[n]&&this.triggerCustomEvent("editableInput",t,e),this.contentCache[n]=e.innerHTML}},handleDocumentSelectionChange:function(t){if(t.currentTarget&&t.currentTarget.activeElement){var n=t.currentTarget.activeElement,i;this.base.elements.some(function(t){return!!e.util.isDescendant(t,n,!0)&&(i=t,!0)},this),i&&this.updateInput(i,{target:n,currentTarget:i})}},handleDocumentExecCommand:function(){var e=this.base.getFocusedElement();e&&this.updateInput(e,{target:e,currentTarget:e})},handleBodyClick:function(e){this.updateFocus(e.target,e)},handleBodyFocus:function(e){this.updateFocus(e.target,e)},handleBodyMousedown:function(e){this.lastMousedownTarget=e.target},handleInput:function(e){this.updateInput(e.currentTarget,e)},handleClick:function(e){this.triggerCustomEvent("editableClick",e,e.currentTarget)},handleBlur:function(e){this.triggerCustomEvent("editableBlur",e,e.currentTarget)},handleKeypress:function(e){if(this.triggerCustomEvent("editableKeypress",e,e.currentTarget),this.keypressUpdateInput){var t={target:e.target,currentTarget:e.currentTarget};setTimeout(function(){this.updateInput(t.currentTarget,t)}.bind(this),0)}},handleKeyup:function(e){this.triggerCustomEvent("editableKeyup",e,e.currentTarget)},handleMouseover:function(e){this.triggerCustomEvent("editableMouseover",e,e.currentTarget)},handleDragging:function(e){this.triggerCustomEvent("editableDrag",e,e.currentTarget)},handleDrop:function(e){this.triggerCustomEvent("editableDrop",e,e.currentTarget)},handlePaste:function(e){this.triggerCustomEvent("editablePaste",e,e.currentTarget)},handleKeydown:function(t){return this.triggerCustomEvent("editableKeydown",t,t.currentTarget),
e.util.isKey(t,e.util.keyCode.SPACE)?this.triggerCustomEvent("editableKeydownSpace",t,t.currentTarget):e.util.isKey(t,e.util.keyCode.ENTER)||t.ctrlKey&&e.util.isKey(t,e.util.keyCode.M)?this.triggerCustomEvent("editableKeydownEnter",t,t.currentTarget):e.util.isKey(t,e.util.keyCode.TAB)?this.triggerCustomEvent("editableKeydownTab",t,t.currentTarget):e.util.isKey(t,[e.util.keyCode.DELETE,e.util.keyCode.BACKSPACE])?this.triggerCustomEvent("editableKeydownDelete",t,t.currentTarget):void 0}},e.Events=t}(),function(){var t=e.Extension.extend({action:void 0,aria:void 0,tagNames:void 0,style:void 0,useQueryState:void 0,contentDefault:void 0,contentFA:void 0,classList:void 0,attrs:void 0,constructor:function(n){t.isBuiltInButton(n)?e.Extension.call(this,this.defaults[n]):e.Extension.call(this,n)},init:function(){e.Extension.prototype.init.apply(this,arguments),this.button=this.createButton(),this.on(this.button,"click",this.handleClick.bind(this))},getButton:function(){return this.button},getAction:function(){return"function"==typeof this.action?this.action(this.base.options):this.action},getAria:function(){return"function"==typeof this.aria?this.aria(this.base.options):this.aria},getTagNames:function(){return"function"==typeof this.tagNames?this.tagNames(this.base.options):this.tagNames},createButton:function(){var e=this.document.createElement("button"),t=this.contentDefault,n=this.getAria(),i=this.getEditorOption("buttonLabels");return e.classList.add("medium-editor-action"),e.classList.add("medium-editor-action-"+this.name),this.classList&&this.classList.forEach(function(t){e.classList.add(t)}),e.setAttribute("data-action",this.getAction()),n&&(e.setAttribute("title",n),e.setAttribute("aria-label",n)),this.attrs&&Object.keys(this.attrs).forEach(function(t){e.setAttribute(t,this.attrs[t])},this),"fontawesome"===i&&this.contentFA&&(t=this.contentFA),e.innerHTML=t,e},handleClick:function(e){e.preventDefault(),e.stopPropagation();var t=this.getAction();t&&this.execAction(t)},isActive:function(){return this.button.classList.contains(this.getEditorOption("activeButtonClass"))},setInactive:function(){this.button.classList.remove(this.getEditorOption("activeButtonClass")),delete this.knownState},setActive:function(){this.button.classList.add(this.getEditorOption("activeButtonClass")),delete this.knownState},queryCommandState:function(){var e=null;return this.useQueryState&&(e=this.base.queryCommandState(this.getAction())),e},isAlreadyApplied:function(e){var t=!1,n=this.getTagNames(),i,o;return this.knownState===!1||this.knownState===!0?this.knownState:(n&&n.length>0&&(t=n.indexOf(e.nodeName.toLowerCase())!==-1),!t&&this.style&&(i=this.style.value.split("|"),o=this.window.getComputedStyle(e,null).getPropertyValue(this.style.prop),i.forEach(function(e){this.knownState||(t=o.indexOf(e)!==-1,(t||"text-decoration"!==this.style.prop)&&(this.knownState=t))},this)),t)}});t.isBuiltInButton=function(t){return"string"==typeof t&&e.extensions.button.prototype.defaults.hasOwnProperty(t)},e.extensions.button=t}(),function(){e.extensions.button.prototype.defaults={bold:{name:"bold",action:"bold",aria:"bold",tagNames:["b","strong"],style:{prop:"font-weight",value:"700|bold"},useQueryState:!0,contentDefault:"<b>B</b>",contentFA:'<i class="icon-bold"></i>'},italic:{name:"italic",action:"italic",aria:"italic",tagNames:["i","em"],style:{prop:"font-style",value:"italic"},useQueryState:!0,contentDefault:"<b><i>I</i></b>",contentFA:'<i class="icon-italic"></i>'},underline:{name:"underline",action:"underline",aria:"underline",tagNames:["u"],style:{prop:"text-decoration",value:"underline"},useQueryState:!0,contentDefault:"<b><u>U</u></b>",contentFA:'<i class="icon-underline"></i>'},strikethrough:{name:"strikethrough",action:"strikethrough",aria:"strike through",tagNames:["strike"],style:{prop:"text-decoration",value:"line-through"},useQueryState:!0,contentDefault:"<s>A</s>",contentFA:'<i class="fa fa-strikethrough"></i>'},superscript:{name:"superscript",action:"superscript",aria:"superscript",tagNames:["sup"],contentDefault:"<b>x<sup>1</sup></b>",contentFA:'<i class="fa fa-superscript"></i>'},subscript:{name:"subscript",action:"subscript",aria:"subscript",tagNames:["sub"],contentDefault:"<b>x<sub>1</sub></b>",contentFA:'<i class="fa fa-subscript"></i>'},image:{name:"image",action:"image",aria:"image",tagNames:["img"],contentDefault:"<b>image</b>",contentFA:'<i class="fa fa-picture-o"></i>'},orderedlist:{name:"orderedlist",action:"insertorderedlist",aria:"ordered list",tagNames:["ol"],useQueryState:!0,contentDefault:"<b>1.</b>",contentFA:'<i class="icon-list-numbered"></i>'},unorderedlist:{name:"unorderedlist",action:"insertunorderedlist",aria:"unordered list",tagNames:["ul"],useQueryState:!0,contentDefault:"<b>&bull;</b>",contentFA:'<i class="icon-list2"></i>'},indent:{name:"indent",action:"indent",aria:"indent",tagNames:[],contentDefault:"<b>&rarr;</b>",contentFA:'<i class="fa fa-indent"></i>'},outdent:{name:"outdent",action:"outdent",aria:"outdent",tagNames:[],contentDefault:"<b>&larr;</b>",contentFA:'<i class="fa fa-outdent"></i>'},justifyCenter:{name:"justifyCenter",action:"justifyCenter",aria:"center justify",tagNames:[],style:{prop:"text-align",value:"center"},contentDefault:"<b>C</b>",contentFA:'<i class="fa fa-align-center"></i>'},justifyFull:{name:"justifyFull",action:"justifyFull",aria:"full justify",tagNames:[],style:{prop:"text-align",value:"justify"},contentDefault:"<b>J</b>",contentFA:'<i class="fa fa-align-justify"></i>'},justifyLeft:{name:"justifyLeft",action:"justifyLeft",aria:"left justify",tagNames:[],style:{prop:"text-align",value:"left"},contentDefault:"<b>L</b>",contentFA:'<i class="fa fa-align-left"></i>'},justifyRight:{name:"justifyRight",action:"justifyRight",aria:"right justify",tagNames:[],style:{prop:"text-align",value:"right"},contentDefault:"<b>R</b>",contentFA:'<i class="fa fa-align-right"></i>'},removeFormat:{name:"removeFormat",aria:"remove formatting",action:"removeFormat",contentDefault:"<b>X</b>",contentFA:'<i class="icon-eraser"></i>'},quote:{name:"quote",action:"append-blockquote",aria:"blockquote",tagNames:["blockquote"],contentDefault:"<b>&ldquo;</b>",contentFA:'<i class="fa fa-quote-right"></i>'},pre:{name:"pre",action:"append-pre",aria:"preformatted text",tagNames:["pre"],contentDefault:"<b>0101</b>",contentFA:'<i class="fa fa-code fa-lg"></i>'},h1:{name:"h1",action:"append-h1",aria:"header type one",tagNames:["h1"],contentDefault:"<b>H1</b>",contentFA:'<i class="icon-text-color"><sup>1</sup>'},h2:{name:"h2",action:"append-h2",aria:"header type two",tagNames:["h2"],contentDefault:"<b>H2</b>",contentFA:'<i class="icon-text-color"><sup>2</sup>'},h3:{name:"h3",action:"append-h3",aria:"header type three",tagNames:["h3"],contentDefault:"<b>H3</b>",contentFA:'<i class="icon-text-color"><sup>3</sup>'},h4:{name:"h4",action:"append-h4",aria:"header type four",tagNames:["h4"],contentDefault:"<b>H4</b>",contentFA:'<i class="icon-text-color"><sup>4</sup>'},h5:{name:"h5",action:"append-h5",aria:"header type five",tagNames:["h5"],contentDefault:"<b>H5</b>",contentFA:'<i class="icon-text-color"><sup>5</sup>'},h6:{name:"h6",action:"append-h6",aria:"header type six",tagNames:["h6"],contentDefault:"<b>H6</b>",contentFA:'<i class="icon-text-color"><sup>6</sup>'}}}(),function(){var t=e.extensions.button.extend({init:function(){e.extensions.button.prototype.init.apply(this,arguments)},formSaveLabel:"&#10003;",formCloseLabel:"&times;",activeClass:"medium-editor-toolbar-form-active",hasForm:!0,getForm:function(){},isDisplayed:function(){return!!this.hasForm&&this.getForm().classList.contains(this.activeClass)},showForm:function(){this.hasForm&&this.getForm().classList.add(this.activeClass)},hideForm:function(){this.hasForm&&this.getForm().classList.remove(this.activeClass)},showToolbarDefaultActions:function(){var e=this.base.getExtensionByName("toolbar");e&&e.showToolbarDefaultActions()},hideToolbarDefaultActions:function(){var e=this.base.getExtensionByName("toolbar");e&&e.hideToolbarDefaultActions()},setToolbarPosition:function(){var e=this.base.getExtensionByName("toolbar");e&&e.setToolbarPosition()}});e.extensions.form=t}(),function(){var t=e.extensions.form.extend({customClassOption:null,customClassOptionText:"Button",linkValidation:!1,placeholderText:"Paste or type a link",targetCheckbox:!1,targetCheckboxText:"Open in new window",name:"anchor",action:"createLink",aria:"link",tagNames:["a"],contentDefault:"<b>#</b>",contentFA:'<i class="icon-link"></i>',init:function(){e.extensions.form.prototype.init.apply(this,arguments),this.subscribe("editableKeydown",this.handleKeydown.bind(this))},handleClick:function(t){t.preventDefault(),t.stopPropagation();var n=e.selection.getSelectionRange(this.document);return"a"===n.startContainer.nodeName.toLowerCase()||"a"===n.endContainer.nodeName.toLowerCase()||e.util.getClosestTag(e.selection.getSelectedParentElement(n),"a")?this.execAction("unlink"):(this.isDisplayed()||this.showForm(),!1)},handleKeydown:function(t){e.util.isKey(t,e.util.keyCode.K)&&e.util.isMetaCtrlKey(t)&&!t.shiftKey&&this.handleClick(t)},getForm:function(){return this.form||(this.form=this.createForm()),this.form},getTemplate:function(){var e=['<input type="text" class="medium-editor-toolbar-input" placeholder="',this.placeholderText,'">'];return e.push('<a href="#" class="medium-editor-toolbar-save">',"fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':this.formSaveLabel,"</a>"),e.push('<a href="#" class="medium-editor-toolbar-close">',"fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':this.formCloseLabel,"</a>"),this.targetCheckbox&&e.push('<div class="medium-editor-toolbar-form-row">','<input type="checkbox" class="medium-editor-toolbar-anchor-target">',"<label>",this.targetCheckboxText,"</label>","</div>"),this.customClassOption&&e.push('<div class="medium-editor-toolbar-form-row">','<input type="checkbox" class="medium-editor-toolbar-anchor-button">',"<label>",this.customClassOptionText,"</label>","</div>"),e.join("")},isDisplayed:function(){return e.extensions.form.prototype.isDisplayed.apply(this)},hideForm:function(){e.extensions.form.prototype.hideForm.apply(this),this.getInput().value=""},showForm:function(t){var n=this.getInput(),i=this.getAnchorTargetCheckbox(),o=this.getAnchorButtonCheckbox();if(t=t||{url:""},"string"==typeof t&&(t={url:t}),this.base.saveSelection(),this.hideToolbarDefaultActions(),e.extensions.form.prototype.showForm.apply(this),this.setToolbarPosition(),n.value=t.url,n.focus(),i&&(i.checked="_blank"===t.target),o){var a=t.buttonClass?t.buttonClass.split(" "):[];o.checked=a.indexOf(this.customClassOption)!==-1}},destroy:function(){return!!this.form&&(this.form.parentNode&&this.form.parentNode.removeChild(this.form),void delete this.form)},getFormOpts:function(){var e=this.getAnchorTargetCheckbox(),t=this.getAnchorButtonCheckbox(),n={url:this.getInput().value.trim()};return this.linkValidation&&(n.url=this.checkLinkFormat(n.url)),n.target="_self",e&&e.checked&&(n.target="_blank"),t&&t.checked&&(n.buttonClass=this.customClassOption),n},doFormSave:function(){var e=this.getFormOpts();this.completeFormSave(e)},completeFormSave:function(e){this.base.restoreSelection(),this.execAction(this.action,e),this.base.checkSelection()},checkLinkFormat:function(e){var t=/^([a-z]+:)?\/\/|^(mailto|tel|maps):/i,n=/^\+?\s?\(?(?:\d\s?\-?\)?){3,20}$/;return n.test(e)?"tel:"+e:(t.test(e)?"":"http://")+e},doFormCancel:function(){this.base.restoreSelection(),this.base.checkSelection()},attachFormEvents:function(e){var t=e.querySelector(".medium-editor-toolbar-close"),n=e.querySelector(".medium-editor-toolbar-save"),i=e.querySelector(".medium-editor-toolbar-input");this.on(e,"click",this.handleFormClick.bind(this)),this.on(i,"keyup",this.handleTextboxKeyup.bind(this)),this.on(t,"click",this.handleCloseClick.bind(this)),this.on(n,"click",this.handleSaveClick.bind(this),!0)},createForm:function(){var e=this.document,t=e.createElement("div");return t.className="medium-editor-toolbar-form",t.id="medium-editor-toolbar-form-anchor-"+this.getEditorId(),t.innerHTML=this.getTemplate(),this.attachFormEvents(t),t},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},getAnchorTargetCheckbox:function(){return this.getForm().querySelector(".medium-editor-toolbar-anchor-target")},getAnchorButtonCheckbox:function(){return this.getForm().querySelector(".medium-editor-toolbar-anchor-button")},handleTextboxKeyup:function(t){return t.keyCode===e.util.keyCode.ENTER?(t.preventDefault(),void this.doFormSave()):void(t.keyCode===e.util.keyCode.ESCAPE&&(t.preventDefault(),this.doFormCancel()))},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault(),this.doFormSave()},handleCloseClick:function(e){e.preventDefault(),this.doFormCancel()}});e.extensions.anchor=t}(),function(){var t=e.Extension.extend({name:"anchor-preview",hideDelay:500,previewValueSelector:"a",showWhenToolbarIsVisible:!1,init:function(){this.anchorPreview=this.createPreview(),this.getEditorOption("elementsContainer").appendChild(this.anchorPreview),this.attachToEditables()},getPreviewElement:function(){return this.anchorPreview},createPreview:function(){var e=this.document.createElement("div");return e.id="medium-editor-anchor-preview-"+this.getEditorId(),e.className="medium-editor-anchor-preview",e.innerHTML=this.getTemplate(),this.on(e,"click",this.handleClick.bind(this)),e},getTemplate:function(){return'<div class="medium-editor-toolbar-anchor-preview" id="medium-editor-toolbar-anchor-preview">    <a class="medium-editor-toolbar-anchor-preview-inner"></a></div>'},destroy:function(){this.anchorPreview&&(this.anchorPreview.parentNode&&this.anchorPreview.parentNode.removeChild(this.anchorPreview),delete this.anchorPreview)},hidePreview:function(){this.anchorPreview.classList.remove("medium-editor-anchor-preview-active"),this.activeAnchor=null},showPreview:function(e){return!(!this.anchorPreview.classList.contains("medium-editor-anchor-preview-active")&&!e.getAttribute("data-disable-preview"))||(this.previewValueSelector&&(this.anchorPreview.querySelector(this.previewValueSelector).textContent=e.attributes.href.value,this.anchorPreview.querySelector(this.previewValueSelector).href=e.attributes.href.value),this.anchorPreview.classList.add("medium-toolbar-arrow-over"),this.anchorPreview.classList.remove("medium-toolbar-arrow-under"),this.anchorPreview.classList.contains("medium-editor-anchor-preview-active")||this.anchorPreview.classList.add("medium-editor-anchor-preview-active"),this.activeAnchor=e,this.positionPreview(),this.attachPreviewHandlers(),this)},positionPreview:function(e){e=e||this.activeAnchor;var t=this.anchorPreview.offsetHeight,n=e.getBoundingClientRect(),i=(n.left+n.right)/2,o=this.diffLeft,a=this.diffTop,s,r;s=this.anchorPreview.offsetWidth/2;var l=this.base.getExtensionByName("toolbar");l&&(o=l.diffLeft,a=l.diffTop),r=o-s,this.anchorPreview.style.top=Math.round(t+n.bottom-a+this.window.pageYOffset-this.anchorPreview.offsetHeight)+"px",this.anchorPreview.style.right="initial",i<s?(this.anchorPreview.style.left=r+s+"px",this.anchorPreview.style.right="initial"):this.window.innerWidth-i<s?(this.anchorPreview.style.left="auto",this.anchorPreview.style.right=0):(this.anchorPreview.style.left=r+i+"px",this.anchorPreview.style.right="initial")},attachToEditables:function(){this.subscribe("editableMouseover",this.handleEditableMouseover.bind(this))},handleClick:function(e){var t=this.base.getExtensionByName("anchor"),n=this.activeAnchor;t&&n&&(e.preventDefault(),this.base.selectElement(this.activeAnchor),this.base.delay(function(){if(n){var e={url:n.attributes.href.value,target:n.getAttribute("target"),buttonClass:n.getAttribute("class")};t.showForm(e),n=null}}.bind(this))),this.hidePreview()},handleAnchorMouseout:function(){this.anchorToPreview=null,this.off(this.activeAnchor,"mouseout",this.instanceHandleAnchorMouseout),this.instanceHandleAnchorMouseout=null},handleEditableMouseover:function(t){var n=e.util.getClosestTag(t.target,"a");if(!1!==n){if(!/href=["']\S+["']/.test(n.outerHTML)||/href=["']#\S+["']/.test(n.outerHTML))return!0;var i=this.base.getExtensionByName("toolbar");if(!this.showWhenToolbarIsVisible&&i&&i.isDisplayed&&i.isDisplayed())return!0;this.activeAnchor&&this.activeAnchor!==n&&this.detachPreviewHandlers(),this.anchorToPreview=n,this.instanceHandleAnchorMouseout=this.handleAnchorMouseout.bind(this),this.on(this.anchorToPreview,"mouseout",this.instanceHandleAnchorMouseout),this.base.delay(function(){this.anchorToPreview&&this.showPreview(this.anchorToPreview)}.bind(this))}},handlePreviewMouseover:function(){this.lastOver=(new Date).getTime(),this.hovering=!0},handlePreviewMouseout:function(e){e.relatedTarget&&/anchor-preview/.test(e.relatedTarget.className)||(this.hovering=!1)},updatePreview:function(){if(this.hovering)return!0;var e=(new Date).getTime()-this.lastOver;e>this.hideDelay&&this.detachPreviewHandlers()},detachPreviewHandlers:function(){clearInterval(this.intervalTimer),this.instanceHandlePreviewMouseover&&(this.off(this.anchorPreview,"mouseover",this.instanceHandlePreviewMouseover),this.off(this.anchorPreview,"mouseout",this.instanceHandlePreviewMouseout),this.activeAnchor&&(this.off(this.activeAnchor,"mouseover",this.instanceHandlePreviewMouseover),this.off(this.activeAnchor,"mouseout",this.instanceHandlePreviewMouseout))),this.hidePreview(),this.hovering=this.instanceHandlePreviewMouseover=this.instanceHandlePreviewMouseout=null},attachPreviewHandlers:function(){this.lastOver=(new Date).getTime(),this.hovering=!0,this.instanceHandlePreviewMouseover=this.handlePreviewMouseover.bind(this),this.instanceHandlePreviewMouseout=this.handlePreviewMouseout.bind(this),this.intervalTimer=setInterval(this.updatePreview.bind(this),200),this.on(this.anchorPreview,"mouseover",this.instanceHandlePreviewMouseover),this.on(this.anchorPreview,"mouseout",this.instanceHandlePreviewMouseout),this.on(this.activeAnchor,"mouseover",this.instanceHandlePreviewMouseover),this.on(this.activeAnchor,"mouseout",this.instanceHandlePreviewMouseout)}});e.extensions.anchorPreview=t}(),function(){function t(t){return!e.util.getClosestTag(t,"a")}var n,i,o,a;n=[" ","\t","\n","\r"," "," "," "," "," ","\u2028","\u2029"],i="com|net|org|edu|gov|mil|aero|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|post|pro|tel|travel|xxx|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|ja|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw",o="(((?:(https?://|ftps?://|nntp://)|www\\d{0,3}[.]|[a-z0-9.\\-]+[.]("+i+")\\/)\\S+(?:[^\\s`!\\[\\]{};:'\".,?«»“”‘’])))|(([a-z0-9\\-]+\\.)?[a-z0-9\\-]+\\.("+i+"))",a=new RegExp("^("+i+")$","i");var s=e.Extension.extend({init:function(){e.Extension.prototype.init.apply(this,arguments),this.disableEventHandling=!1,this.subscribe("editableKeypress",this.onKeypress.bind(this)),this.subscribe("editableBlur",this.onBlur.bind(this)),this.document.execCommand("AutoUrlDetect",!1,!1)},isLastInstance:function(){for(var e=0,t=0;t<this.window._mediumEditors.length;t++){var n=this.window._mediumEditors[t];null!==n&&void 0!==n.getExtensionByName("autoLink")&&e++}return 1===e},destroy:function(){this.document.queryCommandSupported("AutoUrlDetect")&&this.isLastInstance()&&this.document.execCommand("AutoUrlDetect",!1,!0)},onBlur:function(e,t){this.performLinking(t)},onKeypress:function(t){this.disableEventHandling||e.util.isKey(t,[e.util.keyCode.SPACE,e.util.keyCode.ENTER])&&(clearTimeout(this.performLinkingTimeout),this.performLinkingTimeout=setTimeout(function(){try{var e=this.base.exportSelection();this.performLinking(t.target)&&this.base.importSelection(e,!0)}catch(e){window.console&&window.console.error("Failed to perform linking",e),this.disableEventHandling=!0}}.bind(this),0))},performLinking:function(t){var n=e.util.splitByBlockElements(t),i=!1;0===n.length&&(n=[t]);for(var o=0;o<n.length;o++)i=this.removeObsoleteAutoLinkSpans(n[o])||i,i=this.performLinkingWithinElement(n[o])||i;return this.base.events.updateInput(t,{target:t,currentTarget:t}),i},removeObsoleteAutoLinkSpans:function(n){if(!n||3===n.nodeType)return!1;for(var i=n.querySelectorAll('span[data-auto-link="true"]'),o=!1,a=0;a<i.length;a++){var s=i[a].textContent;if(s.indexOf("://")===-1&&(s=e.util.ensureUrlHasProtocol(s)),i[a].getAttribute("data-href")!==s&&t(i[a])){o=!0;var r=s.replace(/\s+$/,"");if(i[a].getAttribute("data-href")===r){var l=s.length-r.length,c=e.util.splitOffDOMTree(i[a],this.splitTextBeforeEnd(i[a],l));i[a].parentNode.insertBefore(c,i[a].nextSibling)}else e.util.unwrap(i[a],this.document)}}return o},splitTextBeforeEnd:function(e,t){for(var n=this.document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1),i=!0;i;)i=null!==n.lastChild();for(var o,a,s;t>0&&null!==s;)o=n.currentNode,a=o.nodeValue,a.length>t?(s=o.splitText(a.length-t),t=0):(s=n.previousNode(),t-=a.length);return s},performLinkingWithinElement:function(t){for(var n=this.findLinkableText(t),i=!1,o=0;o<n.length;o++){var a=e.util.findOrCreateMatchingTextNodes(this.document,t,n[o]);this.shouldNotLink(a)||this.createAutoLink(a,n[o].href)}return i},shouldNotLink:function(t){for(var n=!1,i=0;i<t.length&&n===!1;i++)n=!!e.util.traverseUp(t[i],function(e){return"a"===e.nodeName.toLowerCase()||e.getAttribute&&"true"===e.getAttribute("data-auto-link")});return n},findLinkableText:function(e){for(var t=new RegExp(o,"gi"),i=e.textContent,s=null,r=[];null!==(s=t.exec(i));){var l=!0,c=s.index+s[0].length;l=!(0!==s.index&&n.indexOf(i[s.index-1])===-1||c!==i.length&&n.indexOf(i[c])===-1),l=l&&(s[0].indexOf("/")!==-1||a.test(s[0].split(".").pop().split("?").shift())),l&&r.push({href:s[0],start:s.index,end:c})}return r},createAutoLink:function(t,n){n=e.util.ensureUrlHasProtocol(n);var i=e.util.createLink(this.document,t,n,this.getEditorOption("targetBlank")?"_blank":null),o=this.document.createElement("span");for(o.setAttribute("data-auto-link","true"),o.setAttribute("data-href",n),i.insertBefore(o,i.firstChild);i.childNodes.length>1;)o.appendChild(i.childNodes[1])}});e.extensions.autoLink=s}(),function(){function t(t){var i=e.util.getContainerEditorElement(t),o=Array.prototype.slice.call(i.parentElement.querySelectorAll("."+n));o.forEach(function(e){e.classList.remove(n)})}var n="medium-editor-dragover",i=e.Extension.extend({name:"fileDragging",allowedTypes:["image"],init:function(){e.Extension.prototype.init.apply(this,arguments),this.subscribe("editableDrag",this.handleDrag.bind(this)),this.subscribe("editableDrop",this.handleDrop.bind(this))},handleDrag:function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy";var i=e.target.classList?e.target:e.target.parentElement;t(i),"dragover"===e.type&&i.classList.add(n)},handleDrop:function(e){e.preventDefault(),e.stopPropagation(),this.base.selectElement(e.target);var n=this.base.exportSelection();n.start=n.end,this.base.importSelection(n),e.dataTransfer.files&&Array.prototype.slice.call(e.dataTransfer.files).forEach(function(e){this.isAllowedFile(e)&&e.type.match("image")&&this.insertImageFile(e)},this),t(e.target)},isAllowedFile:function(e){return this.allowedTypes.some(function(t){return!!e.type.match(t)})},insertImageFile:function(t){if("function"==typeof FileReader){var n=new FileReader;n.readAsDataURL(t),n.addEventListener("load",function(t){var n=this.document.createElement("img");n.src=t.target.result,e.util.insertHTMLCommand(this.document,n.outerHTML)}.bind(this))}}});e.extensions.fileDragging=i}(),function(){var t=e.Extension.extend({name:"keyboard-commands",commands:[{command:"bold",key:"B",meta:!0,shift:!1,alt:!1},{command:"italic",key:"I",meta:!0,shift:!1,alt:!1},{command:"underline",key:"U",meta:!0,shift:!1,alt:!1}],init:function(){e.Extension.prototype.init.apply(this,arguments),this.subscribe("editableKeydown",this.handleKeydown.bind(this)),this.keys={},this.commands.forEach(function(e){var t=e.key.charCodeAt(0);this.keys[t]||(this.keys[t]=[]),this.keys[t].push(e)},this)},handleKeydown:function(t){var n=e.util.getKeyCode(t);if(this.keys[n]){var i=e.util.isMetaCtrlKey(t),o=!!t.shiftKey,a=!!t.altKey;this.keys[n].forEach(function(e){e.meta!==i||e.shift!==o||e.alt!==a&&void 0!==e.alt||(t.preventDefault(),t.stopPropagation(),!1!==e.command&&this.execAction(e.command))},this)}}});e.extensions.keyboardCommands=t}(),function(){var t=e.extensions.form.extend({name:"fontname",action:"fontName",aria:"change font name",contentDefault:"&#xB1;",contentFA:'<i class="fa fa-font"></i>',fonts:["","Arial","Verdana","Times New Roman"],init:function(){e.extensions.form.prototype.init.apply(this,arguments)},handleClick:function(e){if(e.preventDefault(),e.stopPropagation(),!this.isDisplayed()){var t=this.document.queryCommandValue("fontName")+"";this.showForm(t)}return!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return"block"===this.getForm().style.display},hideForm:function(){this.getForm().style.display="none",this.getSelect().value=""},showForm:function(e){var t=this.getSelect();this.base.saveSelection(),this.hideToolbarDefaultActions(),this.getForm().style.display="block",this.setToolbarPosition(),t.value=e||"",t.focus()},destroy:function(){return!!this.form&&(this.form.parentNode&&this.form.parentNode.removeChild(this.form),void delete this.form)},doFormSave:function(){this.base.restoreSelection(),this.base.checkSelection()},doFormCancel:function(){this.base.restoreSelection(),this.clearFontName(),this.base.checkSelection()},createForm:function(){var e=this.document,t=e.createElement("div"),n=e.createElement("select"),i=e.createElement("a"),o=e.createElement("a"),a;t.className="medium-editor-toolbar-form",t.id="medium-editor-toolbar-form-fontname-"+this.getEditorId(),this.on(t,"click",this.handleFormClick.bind(this));for(var s=0;s<this.fonts.length;s++)a=e.createElement("option"),a.innerHTML=this.fonts[s],a.value=this.fonts[s],n.appendChild(a);return n.className="medium-editor-toolbar-select",t.appendChild(n),this.on(n,"change",this.handleFontChange.bind(this)),o.setAttribute("href","#"),o.className="medium-editor-toobar-save",o.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':"&#10003;",t.appendChild(o),this.on(o,"click",this.handleSaveClick.bind(this),!0),i.setAttribute("href","#"),i.className="medium-editor-toobar-close",i.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':"&times;",t.appendChild(i),this.on(i,"click",this.handleCloseClick.bind(this)),t},getSelect:function(){return this.getForm().querySelector("select.medium-editor-toolbar-select")},clearFontName:function(){e.selection.getSelectedElements(this.document).forEach(function(e){"font"===e.nodeName.toLowerCase()&&e.hasAttribute("face")&&e.removeAttribute("face")})},handleFontChange:function(){var e=this.getSelect().value;""===e?this.clearFontName():this.execAction("fontName",{name:e})},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault(),this.doFormSave()},handleCloseClick:function(e){e.preventDefault(),this.doFormCancel()}});e.extensions.fontName=t}(),function(){var t=e.extensions.form.extend({name:"fontsize",action:"fontSize",aria:"increase/decrease font size",contentDefault:"&#xB1;",contentFA:'<i class="fa fa-text-height"></i>',init:function(){e.extensions.form.prototype.init.apply(this,arguments)},handleClick:function(e){if(e.preventDefault(),e.stopPropagation(),!this.isDisplayed()){var t=this.document.queryCommandValue("fontSize")+"";this.showForm(t)}return!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return"block"===this.getForm().style.display},hideForm:function(){this.getForm().style.display="none",this.getInput().value=""},showForm:function(e){var t=this.getInput();this.base.saveSelection(),this.hideToolbarDefaultActions(),this.getForm().style.display="block",this.setToolbarPosition(),t.value=e||"",t.focus()},destroy:function(){return!!this.form&&(this.form.parentNode&&this.form.parentNode.removeChild(this.form),void delete this.form)},doFormSave:function(){this.base.restoreSelection(),this.base.checkSelection()},doFormCancel:function(){this.base.restoreSelection(),this.clearFontSize(),this.base.checkSelection()},createForm:function(){var e=this.document,t=e.createElement("div"),n=e.createElement("input"),i=e.createElement("a"),o=e.createElement("a");return t.className="medium-editor-toolbar-form",t.id="medium-editor-toolbar-form-fontsize-"+this.getEditorId(),this.on(t,"click",this.handleFormClick.bind(this)),n.setAttribute("type","range"),n.setAttribute("min","1"),n.setAttribute("max","7"),n.className="medium-editor-toolbar-input",t.appendChild(n),this.on(n,"change",this.handleSliderChange.bind(this)),o.setAttribute("href","#"),o.className="medium-editor-toobar-save",o.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':"&#10003;",t.appendChild(o),this.on(o,"click",this.handleSaveClick.bind(this),!0),i.setAttribute("href","#"),i.className="medium-editor-toobar-close",i.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':"&times;",t.appendChild(i),this.on(i,"click",this.handleCloseClick.bind(this)),t},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},clearFontSize:function(){e.selection.getSelectedElements(this.document).forEach(function(e){"font"===e.nodeName.toLowerCase()&&e.hasAttribute("size")&&e.removeAttribute("size")})},handleSliderChange:function(){var e=this.getInput().value;"4"===e?this.clearFontSize():this.execAction("fontSize",{size:e})},handleFormClick:function(e){e.stopPropagation()},handleSaveClick:function(e){e.preventDefault(),this.doFormSave()},handleCloseClick:function(e){e.preventDefault(),this.doFormCancel()}});e.extensions.fontSize=t}(),function(){function t(){return[[new RegExp(/<[^>]*docs-internal-guid[^>]*>/gi),""],[new RegExp(/<\/b>(<br[^>]*>)?$/gi),""],[new RegExp(/<span class="Apple-converted-space">\s+<\/span>/g)," "],[new RegExp(/<br class="Apple-interchange-newline">/g),"<br>"],[new RegExp(/<span[^>]*(font-style:italic;font-weight:bold|font-weight:bold;font-style:italic)[^>]*>/gi),'<span class="replace-with italic bold">'],[new RegExp(/<span[^>]*font-style:italic[^>]*>/gi),'<span class="replace-with italic">'],[new RegExp(/<span[^>]*font-weight:bold[^>]*>/gi),'<span class="replace-with bold">'],[new RegExp(/&lt;(\/?)(i|b|a)&gt;/gi),"<$1$2>"],[new RegExp(/&lt;a(?:(?!href).)+href=(?:&quot;|&rdquo;|&ldquo;|"|“|”)(((?!&quot;|&rdquo;|&ldquo;|"|“|”).)*)(?:&quot;|&rdquo;|&ldquo;|"|“|”)(?:(?!&gt;).)*&gt;/gi),'<a href="$1">'],[new RegExp(/<\/p>\n+/gi),"</p>"],[new RegExp(/\n+<p/gi),"<p"],[new RegExp(/<\/?o:[a-z]*>/gi),""],["<!--EndFragment-->",""],["<!--StartFragment-->",""]]}var n=e.Extension.extend({forcePlainText:!0,cleanPastedHTML:!1,preCleanReplacements:[],cleanReplacements:[],cleanAttrs:["class","style","dir"],cleanTags:["meta"],init:function(){e.Extension.prototype.init.apply(this,arguments),(this.forcePlainText||this.cleanPastedHTML)&&this.subscribe("editablePaste",this.handlePaste.bind(this))},handlePaste:function(t,n){var i,o="",a,s="text/html",r="text/plain",l,c;if(this.window.clipboardData&&void 0===t.clipboardData&&(t.clipboardData=this.window.clipboardData,
s="Text",r="Text"),t.clipboardData&&t.clipboardData.getData&&!t.defaultPrevented){if(t.preventDefault(),l=t.clipboardData.getData(s),c=t.clipboardData.getData(r),this.cleanPastedHTML&&l)return this.cleanPaste(l);if(this.getEditorOption("disableReturn")||n.getAttribute("data-disable-return"))o=e.util.htmlEntities(c);else if(i=c.split(/[\r\n]+/g),i.length>1)for(a=0;a<i.length;a+=1)""!==i[a]&&(o+="<p>"+e.util.htmlEntities(i[a])+"</p>");else o=e.util.htmlEntities(i[0]);e.util.insertHTMLCommand(this.document,o)}},cleanPaste:function(e){var n,i,o,a,s=/<p|<br|<div/.test(e),r=[].concat(this.preCleanReplacements||[],t(),this.cleanReplacements||[]);for(n=0;n<r.length;n+=1)e=e.replace(r[n][0],r[n][1]);if(!s)return this.pasteHTML(e);for(o=this.document.createElement("div"),o.innerHTML="<p>"+e.split("<br><br>").join("</p><p>")+"</p>",i=o.querySelectorAll("a,p,div,br"),n=0;n<i.length;n+=1)switch(a=i[n],a.innerHTML=a.innerHTML.replace(/\n/gi," "),a.nodeName.toLowerCase()){case"p":case"div":this.filterCommonBlocks(a);break;case"br":this.filterLineBreak(a)}this.pasteHTML(o.innerHTML)},pasteHTML:function(t,n){n=e.util.defaults({},n,{cleanAttrs:this.cleanAttrs,cleanTags:this.cleanTags});var i,o,a,s,r=this.document.createDocumentFragment();for(r.appendChild(this.document.createElement("body")),s=r.querySelector("body"),s.innerHTML=t,this.cleanupSpans(s),i=s.querySelectorAll("*"),a=0;a<i.length;a+=1)o=i[a],"a"===o.nodeName.toLowerCase()&&this.getEditorOption("targetBlank")&&e.util.setTargetBlank(o),e.util.cleanupAttrs(o,n.cleanAttrs),e.util.cleanupTags(o,n.cleanTags);e.util.insertHTMLCommand(this.document,s.innerHTML.replace(/&nbsp;/g," "))},isCommonBlock:function(e){return e&&("p"===e.nodeName.toLowerCase()||"div"===e.nodeName.toLowerCase())},filterCommonBlocks:function(e){/^\s*$/.test(e.textContent)&&e.parentNode&&e.parentNode.removeChild(e)},filterLineBreak:function(e){this.isCommonBlock(e.previousElementSibling)?this.removeWithParent(e):!this.isCommonBlock(e.parentNode)||e.parentNode.firstChild!==e&&e.parentNode.lastChild!==e?e.parentNode&&1===e.parentNode.childElementCount&&""===e.parentNode.textContent&&this.removeWithParent(e):this.removeWithParent(e)},removeWithParent:function(e){e&&e.parentNode&&(e.parentNode.parentNode&&1===e.parentNode.childElementCount?e.parentNode.parentNode.removeChild(e.parentNode):e.parentNode.removeChild(e))},cleanupSpans:function(t){var n,i,o,a=t.querySelectorAll(".replace-with"),s=function(e){return e&&"#text"!==e.nodeName&&"false"===e.getAttribute("contenteditable")};for(n=0;n<a.length;n+=1)i=a[n],o=this.document.createElement(i.classList.contains("bold")?"b":"i"),i.classList.contains("bold")&&i.classList.contains("italic")?o.innerHTML="<i>"+i.innerHTML+"</i>":o.innerHTML=i.innerHTML,i.parentNode.replaceChild(o,i);for(a=t.querySelectorAll("span"),n=0;n<a.length;n+=1){if(i=a[n],e.util.traverseUp(i,s))return!1;e.util.unwrap(i,this.document)}}});e.extensions.paste=n}(),function(){var t=e.Extension.extend({name:"placeholder",text:"Type your text",hideOnClick:!0,init:function(){e.Extension.prototype.init.apply(this,arguments),this.initPlaceholders(),this.attachEventHandlers()},initPlaceholders:function(){this.getEditorElements().forEach(function(e){e.getAttribute("data-placeholder")||e.setAttribute("data-placeholder",this.text),this.updatePlaceholder(e)},this)},destroy:function(){this.getEditorElements().forEach(function(e){e.getAttribute("data-placeholder")===this.text&&e.removeAttribute("data-placeholder")},this)},showPlaceholder:function(e){e&&e.classList.add("medium-editor-placeholder")},hidePlaceholder:function(e){e&&e.classList.remove("medium-editor-placeholder")},updatePlaceholder:function(e,t){return e.querySelector("img, blockquote, ul, ol")||""!==e.textContent.replace(/^\s+|\s+$/g,"")?this.hidePlaceholder(e):void(t||this.showPlaceholder(e))},attachEventHandlers:function(){this.hideOnClick&&this.subscribe("focus",this.handleFocus.bind(this)),this.subscribe("editableInput",this.handleInput.bind(this)),this.subscribe("blur",this.handleBlur.bind(this))},handleInput:function(e,t){var n=this.hideOnClick&&t===this.base.getFocusedElement();this.updatePlaceholder(t,n)},handleFocus:function(e,t){this.hidePlaceholder(t)},handleBlur:function(e,t){this.updatePlaceholder(t)}});e.extensions.placeholder=t}(),function(){var t=e.Extension.extend({name:"toolbar",align:"center",allowMultiParagraphSelection:!0,buttons:["bold","italic","underline","anchor","h2","h3","quote"],diffLeft:0,diffTop:-10,firstButtonClass:"medium-editor-button-first",lastButtonClass:"medium-editor-button-last",standardizeSelectionStart:!1,static:!1,sticky:!1,stickyTopOffset:0,updateOnEmptySelection:!1,relativeContainer:null,init:function(){e.Extension.prototype.init.apply(this,arguments),this.initThrottledMethods(),this.relativeContainer?this.relativeContainer.appendChild(this.getToolbarElement()):this.getEditorOption("elementsContainer").appendChild(this.getToolbarElement())},forEachExtension:function(e,t){return this.base.extensions.forEach(function(n){if(n!==this)return e.apply(t||this,arguments)},this)},createToolbar:function(){var e=this.document.createElement("div");return e.id="medium-editor-toolbar-"+this.getEditorId(),e.className="medium-editor-toolbar",this.static?e.className+=" static-toolbar":this.relativeContainer?e.className+=" medium-editor-relative-toolbar":e.className+=" medium-editor-stalker-toolbar",e.appendChild(this.createToolbarButtons()),this.forEachExtension(function(t){t.hasForm&&e.appendChild(t.getForm())}),this.attachEventHandlers(),e},createToolbarButtons:function(){var t=this.document.createElement("ul"),n,i,o,a,s,r;return t.id="medium-editor-toolbar-actions"+this.getEditorId(),t.className="medium-editor-toolbar-actions",t.style.display="block",this.buttons.forEach(function(o){"string"==typeof o?(s=o,r=null):(s=o.name,r=o),a=this.base.addBuiltInExtension(s,r),a&&"function"==typeof a.getButton&&(i=a.getButton(this.base),n=this.document.createElement("li"),e.util.isElement(i)?n.appendChild(i):n.innerHTML=i,t.appendChild(n))},this),o=t.querySelectorAll("button"),o.length>0&&(o[0].classList.add(this.firstButtonClass),o[o.length-1].classList.add(this.lastButtonClass)),t},destroy:function(){this.toolbar&&(this.toolbar.parentNode&&this.toolbar.parentNode.removeChild(this.toolbar),delete this.toolbar)},getToolbarElement:function(){return this.toolbar||(this.toolbar=this.createToolbar()),this.toolbar},getToolbarActionsElement:function(){return this.getToolbarElement().querySelector(".medium-editor-toolbar-actions")},initThrottledMethods:function(){this.throttledPositionToolbar=e.util.throttle(function(){this.base.isActive&&this.positionToolbarIfShown()}.bind(this))},attachEventHandlers:function(){this.subscribe("blur",this.handleBlur.bind(this)),this.subscribe("focus",this.handleFocus.bind(this)),this.subscribe("editableClick",this.handleEditableClick.bind(this)),this.subscribe("editableKeyup",this.handleEditableKeyup.bind(this)),this.on(this.document.documentElement,"mouseup",this.handleDocumentMouseup.bind(this)),this.static&&this.sticky&&this.on(this.window,"scroll",this.handleWindowScroll.bind(this),!0),this.on(this.window,"resize",this.handleWindowResize.bind(this))},handleWindowScroll:function(){this.positionToolbarIfShown()},handleWindowResize:function(){this.throttledPositionToolbar()},handleDocumentMouseup:function(t){return!(t&&t.target&&e.util.isDescendant(this.getToolbarElement(),t.target))&&void this.checkState()},handleEditableClick:function(){setTimeout(function(){this.checkState()}.bind(this),0)},handleEditableKeyup:function(){this.checkState()},handleBlur:function(){clearTimeout(this.hideTimeout),clearTimeout(this.delayShowTimeout),this.hideTimeout=setTimeout(function(){this.hideToolbar()}.bind(this),1)},handleFocus:function(){this.checkState()},isDisplayed:function(){return this.getToolbarElement().classList.contains("medium-editor-toolbar-active")},showToolbar:function(){clearTimeout(this.hideTimeout),this.isDisplayed()||(this.getToolbarElement().classList.add("medium-editor-toolbar-active"),this.trigger("showToolbar",{},this.base.getFocusedElement()))},hideToolbar:function(){this.isDisplayed()&&(this.getToolbarElement().classList.remove("medium-editor-toolbar-active"),this.trigger("hideToolbar",{},this.base.getFocusedElement()))},isToolbarDefaultActionsDisplayed:function(){return"block"===this.getToolbarActionsElement().style.display},hideToolbarDefaultActions:function(){this.isToolbarDefaultActionsDisplayed()&&(this.getToolbarActionsElement().style.display="none")},showToolbarDefaultActions:function(){this.hideExtensionForms(),this.isToolbarDefaultActionsDisplayed()||(this.getToolbarActionsElement().style.display="block"),this.delayShowTimeout=this.base.delay(function(){this.showToolbar()}.bind(this))},hideExtensionForms:function(){this.forEachExtension(function(e){e.hasForm&&e.isDisplayed()&&e.hideForm()})},multipleBlockElementsSelected:function(){var t=/<[^\/>][^>]*><\/[^>]+>/gim,n=new RegExp("<("+e.util.blockContainerElementNames.join("|")+")[^>]*>","g"),i=e.selection.getSelectionHtml(this.document).replace(t,""),o=i.match(n);return!!o&&o.length>1},modifySelection:function(){var t=this.window.getSelection(),n=t.getRangeAt(0);if(this.standardizeSelectionStart&&n.startContainer.nodeValue&&n.startOffset===n.startContainer.nodeValue.length){var i=e.util.findAdjacentTextNodeWithContent(e.selection.getSelectionElement(this.window),n.startContainer,this.document);if(i){for(var o=0;0===i.nodeValue.substr(o,1).trim().length;)o+=1;n=e.selection.select(this.document,i,o,n.endContainer,n.endOffset)}}},checkState:function(){if(!this.base.preventSelectionUpdates){if(!this.base.getFocusedElement()||e.selection.selectionInContentEditableFalse(this.window))return this.hideToolbar();var t=e.selection.getSelectionElement(this.window);return!t||this.getEditorElements().indexOf(t)===-1||t.getAttribute("data-disable-toolbar")?this.hideToolbar():this.updateOnEmptySelection&&this.static?this.showAndUpdateToolbar():!e.selection.selectionContainsContent(this.document)||this.allowMultiParagraphSelection===!1&&this.multipleBlockElementsSelected()?this.hideToolbar():void this.showAndUpdateToolbar()}},showAndUpdateToolbar:function(){this.modifySelection(),this.setToolbarButtonStates(),this.trigger("positionToolbar",{},this.base.getFocusedElement()),this.showToolbarDefaultActions(),this.setToolbarPosition()},setToolbarButtonStates:function(){this.forEachExtension(function(e){"function"==typeof e.isActive&&"function"==typeof e.setInactive&&e.setInactive()}),this.checkActiveButtons()},checkActiveButtons:function(){var t=[],n=null,i=e.selection.getSelectionRange(this.document),o,a=function(e){"function"==typeof e.checkState?e.checkState(o):"function"==typeof e.isActive&&"function"==typeof e.isAlreadyApplied&&"function"==typeof e.setActive&&!e.isActive()&&e.isAlreadyApplied(o)&&e.setActive()};if(i&&(this.forEachExtension(function(e){return"function"==typeof e.queryCommandState&&(n=e.queryCommandState(),null!==n)?void(n&&"function"==typeof e.setActive&&e.setActive()):void t.push(e)}),o=e.selection.getSelectedParentElement(i),this.getEditorElements().some(function(t){return e.util.isDescendant(t,o,!0)})))for(;o&&(t.forEach(a),!e.util.isMediumEditorElement(o));)o=o.parentNode},positionToolbarIfShown:function(){this.isDisplayed()&&this.setToolbarPosition()},setToolbarPosition:function(){var e=this.base.getFocusedElement(),t=this.window.getSelection(),n;return e?(this.static&&!this.relativeContainer?(this.showToolbar(),this.positionStaticToolbar(e)):t.isCollapsed||(this.showToolbar(),this.relativeContainer||this.positionToolbar(t)),n=this.base.getExtensionByName("anchor-preview"),void(n&&"function"==typeof n.hidePreview&&n.hidePreview())):this},positionStaticToolbar:function(e){this.getToolbarElement().style.left="0";var t=this.document.documentElement&&this.document.documentElement.scrollTop||this.document.body.scrollTop,n=this.window.innerWidth,i=this.getToolbarElement(),o=e.getBoundingClientRect(),a=o.top+t,s=o.left+o.width/2,r=i.offsetHeight,l=i.offsetWidth,c=l/2,d;switch(this.sticky?t>a+e.offsetHeight-r-this.stickyTopOffset?(i.style.top=a+e.offsetHeight-r+"px",i.classList.remove("medium-editor-sticky-toolbar")):t>a-r-this.stickyTopOffset?(i.classList.add("medium-editor-sticky-toolbar"),i.style.top=this.stickyTopOffset+"px"):(i.classList.remove("medium-editor-sticky-toolbar"),i.style.top=a-r+"px"):i.style.top=a-r+"px",this.align){case"left":d=o.left;break;case"right":d=o.right-l;break;case"center":d=s-c}d<0?d=0:d+l>n&&(d=n-Math.ceil(l)-1),i.style.left=d+"px"},positionToolbar:function(e){this.getToolbarElement().style.left="0",this.getToolbarElement().style.right="initial";var t=e.getRangeAt(0),n=t.getBoundingClientRect();(!n||0===n.height&&0===n.width&&t.startContainer===t.endContainer)&&(n=1===t.startContainer.nodeType&&t.startContainer.querySelector("img")?t.startContainer.querySelector("img").getBoundingClientRect():t.startContainer.getBoundingClientRect());var i=this.window.innerWidth,o=(n.left+n.right)/2,a=this.getToolbarElement(),s=a.offsetHeight,r=a.offsetWidth,l=r/2,c=50,d=this.diffLeft-l;n.top<c?(a.classList.add("medium-toolbar-arrow-over"),a.classList.remove("medium-toolbar-arrow-under"),a.style.top=c+n.bottom-this.diffTop+this.window.pageYOffset-s+"px"):(a.classList.add("medium-toolbar-arrow-under"),a.classList.remove("medium-toolbar-arrow-over"),a.style.top=n.top+this.diffTop+this.window.pageYOffset-s+"px"),o<l?(a.style.left=d+l+"px",a.style.right="initial"):i-o<l?(a.style.left="auto",a.style.right=0):(a.style.left=d+o+"px",a.style.right="initial")}});e.extensions.toolbar=t}(),function(){var t=e.Extension.extend({init:function(){e.Extension.prototype.init.apply(this,arguments),this.subscribe("editableDrag",this.handleDrag.bind(this)),this.subscribe("editableDrop",this.handleDrop.bind(this))},handleDrag:function(e){var t="medium-editor-dragover";e.preventDefault(),e.dataTransfer.dropEffect="copy","dragover"===e.type?e.target.classList.add(t):"dragleave"===e.type&&e.target.classList.remove(t)},handleDrop:function(t){var n="medium-editor-dragover",i;t.preventDefault(),t.stopPropagation(),t.dataTransfer.files&&(i=Array.prototype.slice.call(t.dataTransfer.files,0),i.some(function(t){if(t.type.match("image")){var n,i;n=new FileReader,n.readAsDataURL(t),i="medium-img-"+ +new Date,e.util.insertHTMLCommand(this.document,'<img class="medium-editor-image-loading" id="'+i+'" />'),n.onload=function(){var e=this.document.getElementById(i);e&&(e.removeAttribute("id"),e.removeAttribute("class"),e.src=n.result)}.bind(this)}}.bind(this))),t.target.classList.remove(n)}});e.extensions.imageDragging=t}(),function(){function t(t){var n=e.selection.getSelectionStart(this.options.ownerDocument),i=n.textContent,o=e.selection.getCaretOffsets(n);(void 0===i[o.left-1]||""===i[o.left-1].trim()||void 0!==i[o.left]&&""===i[o.left].trim())&&t.preventDefault()}function n(t,n){if(this.options.disableReturn||n.getAttribute("data-disable-return"))t.preventDefault();else if(this.options.disableDoubleReturn||n.getAttribute("data-disable-double-return")){var i=e.selection.getSelectionStart(this.options.ownerDocument);(i&&""===i.textContent.trim()&&"li"!==i.nodeName.toLowerCase()||i.previousElementSibling&&"br"!==i.previousElementSibling.nodeName.toLowerCase()&&""===i.previousElementSibling.textContent.trim())&&t.preventDefault()}}function i(t){var n=e.selection.getSelectionStart(this.options.ownerDocument),i=n&&n.nodeName.toLowerCase();"pre"===i&&(t.preventDefault(),e.util.insertHTMLCommand(this.options.ownerDocument,"    ")),e.util.isListItem(n)&&(t.preventDefault(),t.shiftKey?this.options.ownerDocument.execCommand("outdent",!1,null):this.options.ownerDocument.execCommand("indent",!1,null))}function o(t){var n,i=e.selection.getSelectionStart(this.options.ownerDocument),o=i.nodeName.toLowerCase(),a=/^(\s+|<br\/?>)?$/i,s=/h\d/i;e.util.isKey(t,[e.util.keyCode.BACKSPACE,e.util.keyCode.ENTER])&&i.previousElementSibling&&s.test(o)&&0===e.selection.getCaretOffsets(i).left?e.util.isKey(t,e.util.keyCode.BACKSPACE)&&a.test(i.previousElementSibling.innerHTML)?(i.previousElementSibling.parentNode.removeChild(i.previousElementSibling),t.preventDefault()):!this.options.disableDoubleReturn&&e.util.isKey(t,e.util.keyCode.ENTER)&&(n=this.options.ownerDocument.createElement("p"),n.innerHTML="<br>",i.previousElementSibling.parentNode.insertBefore(n,i),t.preventDefault()):e.util.isKey(t,e.util.keyCode.DELETE)&&i.nextElementSibling&&i.previousElementSibling&&!s.test(o)&&a.test(i.innerHTML)&&s.test(i.nextElementSibling.nodeName.toLowerCase())?(e.selection.moveCursor(this.options.ownerDocument,i.nextElementSibling),i.previousElementSibling.parentNode.removeChild(i),t.preventDefault()):e.util.isKey(t,e.util.keyCode.BACKSPACE)&&"li"===o&&a.test(i.innerHTML)&&!i.previousElementSibling&&!i.parentElement.previousElementSibling&&i.nextElementSibling&&"li"===i.nextElementSibling.nodeName.toLowerCase()?(n=this.options.ownerDocument.createElement("p"),n.innerHTML="<br>",i.parentElement.parentElement.insertBefore(n,i.parentElement),e.selection.moveCursor(this.options.ownerDocument,n),i.parentElement.removeChild(i),t.preventDefault()):e.util.isKey(t,e.util.keyCode.BACKSPACE)&&e.util.getClosestTag(i,"blockquote")!==!1&&0===e.selection.getCaretOffsets(i).left&&(t.preventDefault(),e.util.execFormatBlock(this.options.ownerDocument,"p"))}function a(t){var n=e.selection.getSelectionStart(this.options.ownerDocument),i;n&&(e.util.isMediumEditorElement(n)&&0===n.children.length&&this.options.ownerDocument.execCommand("formatBlock",!1,"p"),!e.util.isKey(t,e.util.keyCode.ENTER)||e.util.isListItem(n)||e.util.isBlockContainer(n)||(i=n.nodeName.toLowerCase(),"a"===i?this.options.ownerDocument.execCommand("unlink",!1,null):t.shiftKey||t.ctrlKey||this.options.ownerDocument.execCommand("formatBlock",!1,"p")))}function s(e){e._mediumEditors||(e._mediumEditors=[null]),this.id||(this.id=e._mediumEditors.length),e._mediumEditors[this.id]=this}function r(e){e._mediumEditors&&e._mediumEditors[this.id]&&(e._mediumEditors[this.id]=null)}function l(t){t||(t=[]),"string"==typeof t&&(t=this.options.ownerDocument.querySelectorAll(t)),e.util.isElement(t)&&(t=[t]);var n=Array.prototype.slice.apply(t);this.elements=[],n.forEach(function(e,t){"textarea"===e.nodeName.toLowerCase()?this.elements.push(b.call(this,e,t)):this.elements.push(e)},this)}function c(e,t){return Object.keys(t).forEach(function(n){void 0===e[n]&&(e[n]=t[n])}),e}function d(e,t,n){var i={window:n.options.contentWindow,document:n.options.ownerDocument,base:n};return e=c(e,i),"function"==typeof e.init&&e.init(),e.name||(e.name=t),e}function u(){return!this.elements.every(function(e){return!!e.getAttribute("data-disable-toolbar")})&&this.options.toolbar!==!1}function h(){return!!u.call(this)&&this.options.anchorPreview!==!1}function f(){return this.options.placeholder!==!1}function m(){return this.options.autoLink!==!1}function p(){return this.options.imageDragging!==!1}function g(){return this.options.keyboardCommands!==!1}function v(){return!this.options.extensions.imageDragging}function b(e,t){for(var n=this.options.ownerDocument.createElement("div"),i=Date.now(),o="medium-editor-"+i+"-"+t,a=e.attributes;this.options.ownerDocument.getElementById(o);)i++,o="medium-editor-"+i+"-"+t;n.className=e.className,n.id=o,n.innerHTML=e.value,e.setAttribute("medium-editor-textarea-id",o);for(var s=0,r=a.length;s<r;s++)n.hasAttribute(a[s].nodeName)||n.setAttribute(a[s].nodeName,a[s].nodeValue);return e.classList.add("medium-editor-hidden"),e.parentNode.insertBefore(n,e),n}function y(){var e=!1;this.elements.forEach(function(t,n){this.options.disableEditing||t.getAttribute("data-disable-editing")||(t.setAttribute("contentEditable",!0),t.setAttribute("spellcheck",this.options.spellcheck)),t.setAttribute("data-medium-editor-element",!0),t.setAttribute("role","textbox"),t.setAttribute("aria-multiline",!0),t.setAttribute("medium-editor-index",n),t.hasAttribute("medium-editor-textarea-id")&&(e=!0)},this),e&&this.subscribe("editableInput",function(e,t){var n=t.parentNode.querySelector('textarea[medium-editor-textarea-id="'+t.getAttribute("medium-editor-textarea-id")+'"]');n&&(n.value=this.serialize()[t.id].value)}.bind(this))}function E(){var e;if(this.subscribe("editableKeydownTab",i.bind(this)),this.subscribe("editableKeydownDelete",o.bind(this)),this.subscribe("editableKeydownEnter",o.bind(this)),this.options.disableExtraSpaces&&this.subscribe("editableKeydownSpace",t.bind(this)),this.options.disableReturn||this.options.disableDoubleReturn)this.subscribe("editableKeydownEnter",n.bind(this));else for(e=0;e<this.elements.length;e+=1)if(this.elements[e].getAttribute("data-disable-return")||this.elements[e].getAttribute("data-disable-double-return")){this.subscribe("editableKeydownEnter",n.bind(this));break}this.options.disableReturn||this.elements.forEach(function(e){e.getAttribute("data-disable-return")||this.on(e,"keyup",a.bind(this))},this)}function C(){if(this.extensions=[],Object.keys(this.options.extensions).forEach(function(e){"toolbar"!==e&&this.options.extensions[e]&&this.extensions.push(d(this.options.extensions[e],e,this))},this),v.call(this)){var t=this.options.fileDragging;t||(t={},p.call(this)||(t.allowedTypes=[])),this.addBuiltInExtension("fileDragging",t)}var n={paste:!0,"anchor-preview":h.call(this),autoLink:m.call(this),keyboardCommands:g.call(this),placeholder:f.call(this)};Object.keys(n).forEach(function(e){n[e]&&this.addBuiltInExtension(e)},this);var i=this.options.extensions.toolbar;if(!i&&u.call(this)){var o=e.util.extend({},this.options.toolbar,{allowMultiParagraphSelection:this.options.allowMultiParagraphSelection});i=new e.extensions.toolbar(o)}i&&this.extensions.push(d(i,"toolbar",this))}function w(t,n){var i=[["allowMultiParagraphSelection","toolbar.allowMultiParagraphSelection"]];return n&&i.forEach(function(t){n.hasOwnProperty(t[0])&&void 0!==n[t[0]]&&e.util.deprecated(t[0],t[1],"v6.0.0")}),e.util.defaults({},n,t)}function S(t,n){var i=/^append-(.+)$/gi,o=/justify([A-Za-z]*)$/g,a;if(a=i.exec(t))return e.util.execFormatBlock(this.options.ownerDocument,a[1]);if("fontSize"===t)return this.options.ownerDocument.execCommand("fontSize",!1,n.size);if("fontName"===t)return this.options.ownerDocument.execCommand("fontName",!1,n.name);if("createLink"===t)return this.createLink(n);if("image"===t){var s=this.options.contentWindow.getSelection().toString().trim();return this.options.ownerDocument.execCommand("insertImage",!1,s)}if(o.exec(t)){var r=this.options.ownerDocument.execCommand(t,!1,null),l=e.selection.getSelectedParentElement(e.selection.getSelectionRange(this.options.ownerDocument));return l&&x.call(this,e.util.getTopBlockContainer(l)),r}return this.options.ownerDocument.execCommand(t,!1,null)}function x(t){if(t){var n,i=Array.prototype.slice.call(t.childNodes).filter(function(e){var t="div"===e.nodeName.toLowerCase();return t&&!n&&(n=e.style.textAlign),t});i.length&&(this.saveSelection(),i.forEach(function(t){if(t.style.textAlign===n){var i=t.lastChild;if(i){e.util.unwrap(t,this.options.ownerDocument);var o=this.options.ownerDocument.createElement("BR");i.parentNode.insertBefore(o,i.nextSibling)}}},this),t.style.textAlign=n,this.restoreSelection())}}e.prototype={init:function(e,t){return this.options=w.call(this,this.defaults,t),this.origElements=e,this.options.elementsContainer||(this.options.elementsContainer=this.options.ownerDocument.body),this.setup()},setup:function(){this.isActive||(l.call(this,this.origElements),0!==this.elements.length&&(this.isActive=!0,s.call(this,this.options.contentWindow),this.events=new e.Events(this),y.call(this),C.call(this),E.call(this)))},destroy:function(){this.isActive&&(this.isActive=!1,this.extensions.forEach(function(e){"function"==typeof e.destroy&&e.destroy()},this),this.events.destroy(),this.elements.forEach(function(e){if(this.options.spellcheck&&(e.innerHTML=e.innerHTML),e.removeAttribute("contentEditable"),e.removeAttribute("spellcheck"),e.removeAttribute("data-medium-editor-element"),e.removeAttribute("role"),e.removeAttribute("aria-multiline"),e.removeAttribute("medium-editor-index"),e.hasAttribute("medium-editor-textarea-id")){var t=e.parentNode.querySelector('textarea[medium-editor-textarea-id="'+e.getAttribute("medium-editor-textarea-id")+'"]');t&&t.classList.remove("medium-editor-hidden"),e.parentNode&&e.parentNode.removeChild(e)}},this),this.elements=[],r.call(this,this.options.contentWindow))},on:function(e,t,n,i){this.events.attachDOMEvent(e,t,n,i)},off:function(e,t,n,i){this.events.detachDOMEvent(e,t,n,i)},subscribe:function(e,t){this.events.attachCustomEvent(e,t)},unsubscribe:function(e,t){this.events.detachCustomEvent(e,t)},trigger:function(e,t,n){this.events.triggerCustomEvent(e,t,n)},delay:function(e){var t=this;return setTimeout(function(){t.isActive&&e()},this.options.delay)},serialize:function(){var e,t,n={};for(e=0;e<this.elements.length;e+=1)t=""!==this.elements[e].id?this.elements[e].id:"element-"+e,n[t]={value:this.elements[e].innerHTML.trim()};return n},getExtensionByName:function(e){var t;return this.extensions&&this.extensions.length&&this.extensions.some(function(n){return n.name===e&&(t=n,!0)}),t},addBuiltInExtension:function(t,n){var i=this.getExtensionByName(t),o;if(i)return i;switch(t){case"anchor":o=e.util.extend({},this.options.anchor,n),i=new e.extensions.anchor(o);break;case"anchor-preview":i=new e.extensions.anchorPreview(this.options.anchorPreview);break;case"autoLink":i=new e.extensions.autoLink;break;case"fileDragging":i=new e.extensions.fileDragging(n);break;case"fontname":i=new e.extensions.fontName(this.options.fontName);break;case"fontsize":i=new e.extensions.fontSize(n);break;case"keyboardCommands":i=new e.extensions.keyboardCommands(this.options.keyboardCommands);break;case"paste":i=new e.extensions.paste(this.options.paste);break;case"placeholder":i=new e.extensions.placeholder(this.options.placeholder);break;default:e.extensions.button.isBuiltInButton(t)&&(n?(o=e.util.defaults({},n,e.extensions.button.prototype.defaults[t]),i=new e.extensions.button(o)):i=new e.extensions.button(t))}return i&&this.extensions.push(d(i,t,this)),i},stopSelectionUpdates:function(){this.preventSelectionUpdates=!0},startSelectionUpdates:function(){this.preventSelectionUpdates=!1},checkSelection:function(){var e=this.getExtensionByName("toolbar");return e&&e.checkState(),this},queryCommandState:function(e){var t=/^full-(.+)$/gi,n,i=null;n=t.exec(e),n&&(e=n[1]);try{i=this.options.ownerDocument.queryCommandState(e)}catch(e){i=null}return i},execAction:function(t,n){var i=/^full-(.+)$/gi,o,a;return o=i.exec(t),o?(this.saveSelection(),this.selectAllContents(),a=S.call(this,o[1],n),this.restoreSelection()):a=S.call(this,t,n),"insertunorderedlist"!==t&&"insertorderedlist"!==t||e.util.cleanListDOM(this.options.ownerDocument,this.getSelectedParentElement()),this.checkSelection(),a},getSelectedParentElement:function(t){return void 0===t&&(t=this.options.contentWindow.getSelection().getRangeAt(0)),e.selection.getSelectedParentElement(t)},selectAllContents:function(){var t=e.selection.getSelectionElement(this.options.contentWindow);if(t){for(;1===t.children.length;)t=t.children[0];this.selectElement(t)}},selectElement:function(t){e.selection.selectNode(t,this.options.ownerDocument);var n=e.selection.getSelectionElement(this.options.contentWindow);n&&this.events.focusElement(n)},getFocusedElement:function(){var e;return this.elements.some(function(t){return!e&&t.getAttribute("data-medium-focused")&&(e=t),!!e},this),e},exportSelection:function(){var t=e.selection.getSelectionElement(this.options.contentWindow),n=this.elements.indexOf(t),i=null;return n>=0&&(i=e.selection.exportSelection(t,this.options.ownerDocument)),null!==i&&0!==n&&(i.editableElementIndex=n),i},saveSelection:function(){this.selectionState=this.exportSelection()},importSelection:function(t,n){if(t){var i=this.elements[t.editableElementIndex||0];e.selection.importSelection(t,i,this.options.ownerDocument,n)}},restoreSelection:function(){this.importSelection(this.selectionState)},createLink:function(t){var n=e.selection.getSelectionElement(this.options.contentWindow),i={};if(this.elements.indexOf(n)!==-1){try{if(this.events.disableCustomEvent("editableInput"),t.url&&t.url.trim().length>0){var o=this.options.contentWindow.getSelection();if(o){var a=o.getRangeAt(0),s=a.commonAncestorContainer,r,l,c,d;if(3===a.endContainer.nodeType&&3!==a.startContainer.nodeType&&0===a.startOffset&&a.startContainer.firstChild===a.endContainer&&(s=a.endContainer),l=e.util.getClosestBlockContainer(a.startContainer),c=e.util.getClosestBlockContainer(a.endContainer),3!==s.nodeType&&0!==s.textContent.length&&l===c){var u=l||n,h=this.options.ownerDocument.createDocumentFragment();this.execAction("unlink"),r=this.exportSelection(),h.appendChild(u.cloneNode(!0)),n===u?e.selection.select(this.options.ownerDocument,u.firstChild,0,u.lastChild,3===u.lastChild.nodeType?u.lastChild.nodeValue.length:u.lastChild.childNodes.length):e.selection.select(this.options.ownerDocument,u,0,u,u.childNodes.length);var f=this.exportSelection();d=e.util.findOrCreateMatchingTextNodes(this.options.ownerDocument,h,{start:r.start-f.start,end:r.end-f.start,editableElementIndex:r.editableElementIndex}),0===d.length&&(h=this.options.ownerDocument.createDocumentFragment(),h.appendChild(s.cloneNode(!0)),d=[h.firstChild.firstChild,h.firstChild.lastChild]),e.util.createLink(this.options.ownerDocument,d,t.url.trim());var m=(h.firstChild.innerHTML.match(/^\s+/)||[""])[0].length;e.util.insertHTMLCommand(this.options.ownerDocument,h.firstChild.innerHTML.replace(/^\s+/,"")),r.start-=m,r.end-=m,this.importSelection(r)}else this.options.ownerDocument.execCommand("createLink",!1,t.url);this.options.targetBlank||"_blank"===t.target?e.util.setTargetBlank(e.selection.getSelectionStart(this.options.ownerDocument),t.url):e.util.removeTargetBlank(e.selection.getSelectionStart(this.options.ownerDocument),t.url),t.buttonClass&&e.util.addClassToAnchors(e.selection.getSelectionStart(this.options.ownerDocument),t.buttonClass)}}if(this.options.targetBlank||"_blank"===t.target||t.buttonClass){i=this.options.ownerDocument.createEvent("HTMLEvents"),i.initEvent("input",!0,!0,this.options.contentWindow);for(var p=0;p<this.elements.length;p+=1)this.elements[p].dispatchEvent(i)}}finally{this.events.enableCustomEvent("editableInput")}this.events.triggerCustomEvent("editableInput",i,n)}},cleanPaste:function(e){this.getExtensionByName("paste").cleanPaste(e)},pasteHTML:function(e,t){this.getExtensionByName("paste").pasteHTML(e,t)},setContent:function(e,t){if(t=t||0,this.elements[t]){var n=this.elements[t];n.innerHTML=e,this.events.updateInput(n,{target:n,currentTarget:n})}}}}(),function(){e.prototype.defaults={activeButtonClass:"medium-editor-button-active",buttonLabels:!1,delay:0,disableReturn:!1,disableDoubleReturn:!1,disableExtraSpaces:!1,disableEditing:!1,autoLink:!1,elementsContainer:!1,contentWindow:window,ownerDocument:document,targetBlank:!1,extensions:{},spellcheck:!0}}(),e.parseVersionString=function(e){var t=e.split("-"),n=t[0].split("."),i=t.length>1?t[1]:"";return{major:parseInt(n[0],10),minor:parseInt(n[1],10),revision:parseInt(n[2],10),preRelease:i,toString:function(){return[n[0],n[1],n[2]].join(".")+(i?"-"+i:"")}}},e.version=e.parseVersionString.call(this,{version:"5.15.0"}.version),e}())},{}],14:[function(e,t,n){!function(i,o){"function"==typeof define&&define.amd?define(["./rangy-core"],i):"undefined"!=typeof t&&"object"==typeof n?t.exports=i(e("rangy")):i(o.rangy)}(function(e){return e.createModule("ClassApplier",["WrappedSelection"],function(e,t){function n(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(n,e[n])===!1)return!1;return!0}function o(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function a(e,t){return!!e&&new RegExp("(?:^|\\s)"+t+"(?:\\s|$)").test(e)}function s(e,t){if("object"==typeof e.classList)return e.classList.contains(t);var n="string"==typeof e.className,i=n?e.className:e.getAttribute("class");
return a(i,t)}function r(e,t){if("object"==typeof e.classList)e.classList.add(t);else{var n="string"==typeof e.className,i=n?e.className:e.getAttribute("class");i?a(i,t)||(i+=" "+t):i=t,n?e.className=i:e.setAttribute("class",i)}}function l(e){var t="string"==typeof e.className;return t?e.className:e.getAttribute("class")}function c(e){return e&&e.split(/\s+/).sort().join(" ")}function d(e){return c(l(e))}function u(e,t){return d(e)==d(t)}function h(e,t){for(var n=t.split(/\s+/),i=0,a=n.length;i<a;++i)if(!s(e,o(n[i])))return!1;return!0}function f(e){var t=e.parentNode;return t&&1==t.nodeType&&!/^(textarea|style|script|select|iframe)$/i.test(t.nodeName)}function m(e,t,n,i,o){var a=e.node,s=e.offset,r=a,l=s;a==i&&s>o&&++l,a!=t||s!=n&&s!=n+1||(r=i,l+=o-n),a==t&&s>n+1&&--l,e.node=r,e.offset=l}function p(e,t,n){e.node==t&&e.offset>n&&--e.offset}function g(e,t,n,i){n==-1&&(n=t.childNodes.length);var o=e.parentNode,a=_.getNodeIndex(e);W(i,function(e){m(e,o,a,t,n)}),t.childNodes.length==n?t.appendChild(e):t.insertBefore(e,t.childNodes[n])}function v(e,t){var n=e.parentNode,i=_.getNodeIndex(e);W(t,function(e){p(e,n,i)}),_.removeNode(e)}function b(e,t,n,i,o){for(var a,s=[];a=e.firstChild;)g(a,t,n++,o),s.push(a);return i&&v(e,o),s}function y(e,t){return b(e,e.parentNode,_.getNodeIndex(e),!0,t)}function E(e,t){var n=e.cloneRange();n.selectNodeContents(t);var i=n.intersection(e),o=i?i.toString():"";return""!=o}function C(e){for(var t=e.getNodes([3]),n=0,i;(i=t[n])&&!E(e,i);)++n;for(var o=t.length-1;(i=t[o])&&!E(e,i);)--o;return t.slice(n,o+1)}function w(e,t){if(e.attributes.length!=t.attributes.length)return!1;for(var n=0,i=e.attributes.length,o,a,s;n<i;++n)if(o=e.attributes[n],s=o.name,"class"!=s){if(a=t.attributes.getNamedItem(s),null===o!=(null===a))return!1;if(o.specified!=a.specified)return!1;if(o.specified&&o.nodeValue!==a.nodeValue)return!1}return!0}function S(e,t){for(var n=0,i=e.attributes.length,o;n<i;++n)if(o=e.attributes[n].name,(!t||!H(t,o))&&e.attributes[n].specified&&"class"!=o)return!0;return!1}function x(e){var t;return e&&1==e.nodeType&&((t=e.parentNode)&&9==t.nodeType&&"on"==t.designMode||V(e)&&!V(e.parentNode))}function k(e){return(V(e)||1!=e.nodeType&&V(e.parentNode))&&!x(e)}function N(e){return e&&1==e.nodeType&&!Y.test(z(e,"display"))}function T(e){if(0==e.data.length)return!0;if(Q.test(e.data))return!1;var t=z(e.parentNode,"whiteSpace");switch(t){case"pre":case"pre-wrap":case"-moz-pre-wrap":return!1;case"pre-line":if(/[\r\n]/.test(e.data))return!1}return N(e.previousSibling)||N(e.nextSibling)}function A(e){var t=[],n,i;for(n=0;i=e[n++];)t.push(new F(i.startContainer,i.startOffset),new F(i.endContainer,i.endOffset));return t}function R(e,t){for(var n=0,i,o,a,s=e.length;n<s;++n)i=e[n],o=t[2*n],a=t[2*n+1],i.setStartAndEnd(o.node,o.offset,a.node,a.offset)}function L(e,t){return _.isCharacterDataNode(e)?0==t?!!e.previousSibling:t!=e.length||!!e.nextSibling:t>0&&t<e.childNodes.length}function D(e,n,i,o){var a,s,r=0==i;if(_.isAncestorOf(n,e))return e;if(_.isCharacterDataNode(n)){var l=_.getNodeIndex(n);if(0==i)i=l;else{if(i!=n.length)throw t.createError("splitNodeAt() should not be called with offset in the middle of a data node ("+i+" in "+n.data);i=l+1}n=n.parentNode}if(L(n,i)){a=n.cloneNode(!1),s=n.parentNode,a.id&&a.removeAttribute("id");for(var c,d=0;c=n.childNodes[i];)g(c,a,d++,o);return g(a,s,_.getNodeIndex(n)+1,o),n==e?a:D(e,s,_.getNodeIndex(a),o)}if(e!=n){a=n.parentNode;var u=_.getNodeIndex(n);return r||u++,D(e,a,u,o)}return e}function P(e,t){return e.namespaceURI==t.namespaceURI&&e.tagName.toLowerCase()==t.tagName.toLowerCase()&&u(e,t)&&w(e,t)&&"inline"==z(e,"display")&&"inline"==z(t,"display")}function I(e){var t=e?"nextSibling":"previousSibling";return function(n,i){var o=n.parentNode,a=n[t];if(a){if(a&&3==a.nodeType)return a}else if(i&&(a=o[t],a&&1==a.nodeType&&P(o,a))){var s=a[e?"firstChild":"lastChild"];if(s&&3==s.nodeType)return s}return null}}function B(e){this.isElementMerge=1==e.nodeType,this.textNodes=[];var t=this.isElementMerge?e.lastChild:e;t&&(this.textNodes[0]=t)}function O(e,t,i){var a,s,r,l,d=this;d.cssClass=d.className=e;var u=null,h={};if("object"==typeof t&&null!==t){for("undefined"!=typeof t.elementTagName&&(t.elementTagName=t.elementTagName.toLowerCase()),i=t.tagNames,u=t.elementProperties,h=t.elementAttributes,s=0;l=X[s++];)t.hasOwnProperty(l)&&(d[l]=t[l]);a=t.normalize}else a=t;d.normalize="undefined"==typeof a||a,d.attrExceptions=[];var f=document.createElement(d.elementTagName);d.elementProperties=d.copyPropertiesToElement(u,f,!0),n(h,function(e,t){d.attrExceptions.push(e),h[e]=""+t}),d.elementAttributes=h,d.elementSortedClassName=d.elementProperties.hasOwnProperty("className")?c(d.elementProperties.className+" "+e):e,d.applyToAnyTagName=!1;var m=typeof i;if("string"==m)"*"==i?d.applyToAnyTagName=!0:d.tagNames=o(i.toLowerCase()).split(/\s*,\s*/);else if("object"==m&&"number"==typeof i.length)for(d.tagNames=[],s=0,r=i.length;s<r;++s)"*"==i[s]?d.applyToAnyTagName=!0:d.tagNames.push(i[s].toLowerCase());else d.tagNames=[d.elementTagName]}function M(e,t,n){return new O(e,t,n)}var _=e.dom,F=_.DomPosition,H=_.arrayContains,j=e.util,W=j.forEach,q="span",U=j.isHostMethod(document,"createElementNS"),K=function(){function e(e,t,n){return t&&n?" ":""}return function(t,n){if("object"==typeof t.classList)t.classList.remove(n);else{var i="string"==typeof t.className,o=i?t.className:t.getAttribute("class");o=o.replace(new RegExp("(^|\\s)"+n+"(\\s|$)"),e),i?t.className=o:t.setAttribute("class",o)}}}(),z=_.getComputedStyleProperty,V=function(){var e=document.createElement("div");return"boolean"==typeof e.isContentEditable?function(e){return e&&1==e.nodeType&&e.isContentEditable}:function(e){return!(!e||1!=e.nodeType||"false"==e.contentEditable)&&("true"==e.contentEditable||V(e.parentNode))}}(),Y=/^inline(-block|-table)?$/i,Q=/[^\r\n\t\f \u200B]/,G=I(!1),J=I(!0);B.prototype={doMerge:function(e){var t=this.textNodes,n=t[0];if(t.length>1){var i=_.getNodeIndex(n),o=[],a=0,s,r;W(t,function(t,s){r=t.parentNode,s>0&&(r.removeChild(t),r.hasChildNodes()||_.removeNode(r),e&&W(e,function(e){e.node==t&&(e.node=n,e.offset+=a),e.node==r&&e.offset>i&&(--e.offset,e.offset==i+1&&s<len-1&&(e.node=n,e.offset=a))})),o[s]=t.data,a+=t.data.length}),n.data=o.join("")}return n.data},getLength:function(){for(var e=this.textNodes.length,t=0;e--;)t+=this.textNodes[e].length;return t},toString:function(){var e=[];return W(this.textNodes,function(t,n){e[n]="'"+t.data+"'"}),"[Merge("+e.join(",")+")]"}};var X=["elementTagName","ignoreWhiteSpace","applyToEditableOnly","useExistingElements","removeEmptyElements","onElementCreate"],Z={};O.prototype={elementTagName:q,elementProperties:{},elementAttributes:{},ignoreWhiteSpace:!0,applyToEditableOnly:!1,useExistingElements:!0,removeEmptyElements:!0,onElementCreate:null,copyPropertiesToElement:function(e,t,n){var i,o,a={},s,l,d,u;for(var h in e)if(e.hasOwnProperty(h))if(l=e[h],d=t[h],"className"==h)r(t,l),r(t,this.className),t[h]=c(t[h]),n&&(a[h]=l);else if("style"==h){o=d,n&&(a[h]=s={});for(i in e[h])e[h].hasOwnProperty(i)&&(o[i]=l[i],n&&(s[i]=o[i]));this.attrExceptions.push(h)}else t[h]=l,n&&(a[h]=t[h],u=Z.hasOwnProperty(h)?Z[h]:h,this.attrExceptions.push(u));return n?a:""},copyAttributesToElement:function(e,t){for(var n in e)e.hasOwnProperty(n)&&!/^class(?:Name)?$/i.test(n)&&t.setAttribute(n,e[n])},appliesToElement:function(e){return H(this.tagNames,e.tagName.toLowerCase())},getEmptyElements:function(e){var t=this;return e.getNodes([1],function(e){return t.appliesToElement(e)&&!e.hasChildNodes()})},hasClass:function(e){return 1==e.nodeType&&(this.applyToAnyTagName||this.appliesToElement(e))&&s(e,this.className)},getSelfOrAncestorWithClass:function(e){for(;e;){if(this.hasClass(e))return e;e=e.parentNode}return null},isModifiable:function(e){return!this.applyToEditableOnly||k(e)},isIgnorableWhiteSpaceNode:function(e){return this.ignoreWhiteSpace&&e&&3==e.nodeType&&T(e)},postApply:function(e,t,n,o){var a=e[0],s=e[e.length-1],r=[],l,c=a,d=s,u=0,h=s.length,f,m;W(e,function(e){m=G(e,!o),m?(l||(l=new B(m),r.push(l)),l.textNodes.push(e),e===a&&(c=l.textNodes[0],u=c.length),e===s&&(d=l.textNodes[0],h=l.getLength())):l=null});var p=J(s,!o);if(p&&(l||(l=new B(s),r.push(l)),l.textNodes.push(p)),r.length){for(i=0,len=r.length;i<len;++i)r[i].doMerge(n);t.setStartAndEnd(c,u,d,h)}},createContainer:function(e){var t=_.getDocument(e),n,i=U&&!_.isHtmlNamespace(e)&&(n=e.namespaceURI)?t.createElementNS(e.namespaceURI,this.elementTagName):t.createElement(this.elementTagName);return this.copyPropertiesToElement(this.elementProperties,i,!1),this.copyAttributesToElement(this.elementAttributes,i),r(i,this.className),this.onElementCreate&&this.onElementCreate(i,this),i},elementHasProperties:function(e,t){var i=this;return n(t,function(t,n){if("className"==t)return h(e,n);if("object"==typeof n){if(!i.elementHasProperties(e[t],n))return!1}else if(e[t]!==n)return!1})},elementHasAttributes:function(e,t){return n(t,function(t,n){if(e.getAttribute(t)!==n)return!1})},applyToTextNode:function(e,t){if(f(e)){var n=e.parentNode;if(1==n.childNodes.length&&this.useExistingElements&&this.appliesToElement(n)&&this.elementHasProperties(n,this.elementProperties)&&this.elementHasAttributes(n,this.elementAttributes))r(n,this.className);else{var i=e.parentNode,o=this.createContainer(i);i.insertBefore(o,e),o.appendChild(e)}}},isRemovable:function(e){return e.tagName.toLowerCase()==this.elementTagName&&d(e)==this.elementSortedClassName&&this.elementHasProperties(e,this.elementProperties)&&!S(e,this.attrExceptions)&&this.elementHasAttributes(e,this.elementAttributes)&&this.isModifiable(e)},isEmptyContainer:function(e){var t=e.childNodes.length;return 1==e.nodeType&&this.isRemovable(e)&&(0==t||1==t&&this.isEmptyContainer(e.firstChild))},removeEmptyContainers:function(e){var t=this,n=e.getNodes([1],function(e){return t.isEmptyContainer(e)}),i=[e],o=A(i);W(n,function(e){v(e,o)}),R(i,o)},undoToTextNode:function(e,t,n,i){if(!t.containsNode(n)){var o=t.cloneRange();o.selectNode(n),o.isPointInRange(t.endContainer,t.endOffset)&&(D(n,t.endContainer,t.endOffset,i),t.setEndAfter(n)),o.isPointInRange(t.startContainer,t.startOffset)&&(n=D(n,t.startContainer,t.startOffset,i))}this.isRemovable(n)?y(n,i):K(n,this.className)},splitAncestorWithClass:function(e,t,n){var i=this.getSelfOrAncestorWithClass(e);i&&D(i,e,t,n)},undoToAncestor:function(e,t){this.isRemovable(e)?y(e,t):K(e,this.className)},applyToRange:function(e,t){var n=this;t=t||[];var i=A(t||[]);e.splitBoundariesPreservingPositions(i),n.removeEmptyElements&&n.removeEmptyContainers(e);var o=C(e);if(o.length){W(o,function(e){n.isIgnorableWhiteSpaceNode(e)||n.getSelfOrAncestorWithClass(e)||!n.isModifiable(e)||n.applyToTextNode(e,i)});var a=o[o.length-1];e.setStartAndEnd(o[0],0,a,a.length),n.normalize&&n.postApply(o,e,i,!1),R(t,i)}var s=n.getEmptyElements(e);W(s,function(e){r(e,n.className)})},applyToRanges:function(e){for(var t=e.length;t--;)this.applyToRange(e[t],e);return e},applyToSelection:function(t){var n=e.getSelection(t);n.setRanges(this.applyToRanges(n.getAllRanges()))},undoToRange:function(e,t){var n=this;t=t||[];var i=A(t);e.splitBoundariesPreservingPositions(i),n.removeEmptyElements&&n.removeEmptyContainers(e,i);var o=C(e),a,s,r=o[o.length-1];if(o.length){n.splitAncestorWithClass(e.endContainer,e.endOffset,i),n.splitAncestorWithClass(e.startContainer,e.startOffset,i);for(var l=0,c=o.length;l<c;++l)a=o[l],s=n.getSelfOrAncestorWithClass(a),s&&n.isModifiable(a)&&n.undoToAncestor(s,i);e.setStartAndEnd(o[0],0,r,r.length),n.normalize&&n.postApply(o,e,i,!0),R(t,i)}var d=n.getEmptyElements(e);W(d,function(e){K(e,n.className)})},undoToRanges:function(e){for(var t=e.length;t--;)this.undoToRange(e[t],e);return e},undoToSelection:function(t){var n=e.getSelection(t),i=e.getSelection(t).getAllRanges();this.undoToRanges(i),n.setRanges(i)},isAppliedToRange:function(e){if(e.collapsed||""==e.toString())return!!this.getSelfOrAncestorWithClass(e.commonAncestorContainer);var t=e.getNodes([3]);if(t.length)for(var n=0,i;i=t[n++];)if(!this.isIgnorableWhiteSpaceNode(i)&&E(e,i)&&this.isModifiable(i)&&!this.getSelfOrAncestorWithClass(i))return!1;return!0},isAppliedToRanges:function(e){var t=e.length;if(0==t)return!1;for(;t--;)if(!this.isAppliedToRange(e[t]))return!1;return!0},isAppliedToSelection:function(t){var n=e.getSelection(t);return this.isAppliedToRanges(n.getAllRanges())},toggleRange:function(e){this.isAppliedToRange(e)?this.undoToRange(e):this.applyToRange(e)},toggleSelection:function(e){this.isAppliedToSelection(e)?this.undoToSelection(e):this.applyToSelection(e)},getElementsWithClassIntersectingRange:function(e){var t=[],n=this;return e.getNodes([3],function(e){var i=n.getSelfOrAncestorWithClass(e);i&&!H(t,i)&&t.push(i)}),t},detach:function(){}},O.util={hasClass:s,addClass:r,removeClass:K,getClass:l,hasSameClasses:u,hasAllClasses:h,replaceWithOwnChildren:y,elementsHaveSameNonClassAttributes:w,elementHasNonClassAttributes:S,splitNodeAt:D,isEditableElement:V,isEditingHost:x,isEditable:k},e.CssClassApplier=e.ClassApplier=O,e.createClassApplier=M,j.createAliasForDeprecatedMethod(e,"createCssClassApplier","createClassApplier",t)}),e},this)},{rangy:15}],15:[function(e,t,n){!function(e,i){"function"==typeof define&&define.amd?define(e):"undefined"!=typeof t&&"object"==typeof n?t.exports=e():i.rangy=e()}(function(){function e(e,t){var n=typeof e[t];return n==E||!(n!=y||!e[t])||"unknown"==n}function t(e,t){return!(typeof e[t]!=y||!e[t])}function n(e,t){return typeof e[t]!=C}function i(e){return function(t,n){for(var i=n.length;i--;)if(!e(t,n[i]))return!1;return!0}}function o(e){return e&&N(e,k)&&A(e,x)}function a(e){return t(e,"body")?e.body:e.getElementsByTagName("body")[0]}function s(t){typeof console!=C&&e(console,"log")&&console.log(t)}function r(e,t){D&&t?alert(e):s(e)}function l(e){I.initialized=!0,I.supported=!1,r("Rangy is not supported in this environment. Reason: "+e,I.config.alertOnFail)}function c(e){r("Rangy warning: "+e,I.config.alertOnWarn)}function d(e){return e.message||e.description||String(e)}function u(){if(D&&!I.initialized){var t,n=!1,i=!1;e(document,"createRange")&&(t=document.createRange(),N(t,S)&&A(t,w)&&(n=!0));var r=a(document);if(!r||"body"!=r.nodeName.toLowerCase())return void l("No body element found");if(r&&e(r,"createTextRange")&&(t=r.createTextRange(),o(t)&&(i=!0)),!n&&!i)return void l("Neither Range nor TextRange are available");I.initialized=!0,I.features={implementsDomRange:n,implementsTextRange:i};var c,u;for(var h in L)(c=L[h])instanceof p&&c.init(c,I);for(var f=0,m=M.length;f<m;++f)try{M[f](I)}catch(e){u="Rangy init listener threw an exception. Continuing. Detail: "+d(e),s(u)}}}function h(e,t,n){n&&(e+=" in module "+n.name),I.warn("DEPRECATED: "+e+" is deprecated. Please use "+t+" instead.")}function f(e,t,n,i){e[t]=function(){return h(t,n,i),e[n].apply(e,P.toArray(arguments))}}function m(e){e=e||window,u();for(var t=0,n=_.length;t<n;++t)_[t](e)}function p(e,t,n){this.name=e,this.dependencies=t,this.initialized=!1,this.supported=!1,this.initializer=n}function g(e,t,n){var i=new p(e,t,function(t){if(!t.initialized){t.initialized=!0;try{n(I,t),t.supported=!0}catch(t){var i="Module '"+e+"' failed to load: "+d(t);s(i),t.stack&&s(t.stack)}}});return L[e]=i,i}function v(){}function b(){}var y="object",E="function",C="undefined",w=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],S=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],x=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],k=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"],N=i(e),T=i(t),A=i(n),R=[].forEach?function(e,t){e.forEach(t)}:function(e,t){for(var n=0,i=e.length;n<i;++n)t(e[n],n)},L={},D=typeof window!=C&&typeof document!=C,P={isHostMethod:e,isHostObject:t,isHostProperty:n,areHostMethods:N,areHostObjects:T,areHostProperties:A,isTextRange:o,getBody:a,forEach:R},I={version:"1.3.0",initialized:!1,isBrowser:D,supported:!0,util:P,features:{},modules:L,config:{alertOnFail:!1,alertOnWarn:!1,preferTextRange:!1,autoInitialize:typeof rangyAutoInitialize==C||rangyAutoInitialize}};I.fail=l,I.warn=c;var B;({}).hasOwnProperty?(P.extend=B=function(e,t,n){var i,o;for(var a in t)t.hasOwnProperty(a)&&(i=e[a],o=t[a],n&&null!==i&&"object"==typeof i&&null!==o&&"object"==typeof o&&B(i,o,!0),e[a]=o);return t.hasOwnProperty("toString")&&(e.toString=t.toString),e},P.createOptions=function(e,t){var n={};return B(n,t),e&&B(n,e),n}):l("hasOwnProperty not supported"),D||l("Rangy can only run in a browser"),function(){var e;if(D){var t=document.createElement("div");t.appendChild(document.createElement("span"));var n=[].slice;try{1==n.call(t.childNodes,0)[0].nodeType&&(e=function(e){return n.call(e,0)})}catch(e){}}e||(e=function(e){for(var t=[],n=0,i=e.length;n<i;++n)t[n]=e[n];return t}),P.toArray=e}();var O;D&&(e(document,"addEventListener")?O=function(e,t,n){e.addEventListener(t,n,!1)}:e(document,"attachEvent")?O=function(e,t,n){e.attachEvent("on"+t,n)}:l("Document does not have required addEventListener or attachEvent method"),P.addListener=O);var M=[];P.deprecationNotice=h,P.createAliasForDeprecatedMethod=f,I.init=u,I.addInitListener=function(e){I.initialized?e(I):M.push(e)};var _=[];I.addShimListener=function(e){_.push(e)},D&&(I.shim=I.createMissingNativeApi=m,f(I,"createMissingNativeApi","shim")),p.prototype={init:function(){for(var e=this.dependencies||[],t=0,n=e.length,i,o;t<n;++t){if(o=e[t],i=L[o],!(i&&i instanceof p))throw new Error("required module '"+o+"' not found");if(i.init(),!i.supported)throw new Error("required module '"+o+"' not supported")}this.initializer(this)},fail:function(e){throw this.initialized=!0,this.supported=!1,new Error(e)},warn:function(e){I.warn("Module "+this.name+": "+e)},deprecationNotice:function(e,t){I.warn("DEPRECATED: "+e+" in module "+this.name+" is deprecated. Please use "+t+" instead")},createError:function(e){return new Error("Error in Rangy "+this.name+" module: "+e)}},I.createModule=function(e){var t,n;2==arguments.length?(t=arguments[1],n=[]):(t=arguments[2],n=arguments[1]);var i=g(e,n,t);I.initialized&&I.supported&&i.init()},I.createCoreModule=function(e,t,n){g(e,t,n)},I.RangePrototype=v,I.rangePrototype=new v,I.selectionPrototype=new b,I.createCoreModule("DomUtil",[],function(e,t){function n(e){var t;return typeof e.namespaceURI==D||null===(t=e.namespaceURI)||"http://www.w3.org/1999/xhtml"==t}function i(e){var t=e.parentNode;return 1==t.nodeType?t:null}function o(e){for(var t=0;e=e.previousSibling;)++t;return t}function a(e){switch(e.nodeType){case 7:case 10:return 0;case 3:case 8:return e.length;default:return e.childNodes.length}}function s(e,t){var n=[],i;for(i=e;i;i=i.parentNode)n.push(i);for(i=t;i;i=i.parentNode)if(M(n,i))return i;return null}function r(e,t,n){for(var i=n?t:t.parentNode;i;){if(i===e)return!0;i=i.parentNode}return!1}function l(e,t){return r(e,t,!0)}function c(e,t,n){for(var i,o=n?e:e.parentNode;o;){if(i=o.parentNode,i===t)return o;o=i}return null}function d(e){var t=e.nodeType;return 3==t||4==t||8==t}function u(e){if(!e)return!1;var t=e.nodeType;return 3==t||8==t}function h(e,t){var n=t.nextSibling,i=t.parentNode;return n?i.insertBefore(e,n):i.appendChild(e),e}function f(e,t,n){var i=e.cloneNode(!1);if(i.deleteData(0,t),e.deleteData(t,e.length-t),h(i,e),n)for(var a=0,s;s=n[a++];)s.node==e&&s.offset>t?(s.node=i,s.offset-=t):s.node==e.parentNode&&s.offset>o(e)&&++s.offset;return i}function m(e){if(9==e.nodeType)return e;if(typeof e.ownerDocument!=D)return e.ownerDocument;if(typeof e.document!=D)return e.document;if(e.parentNode)return m(e.parentNode);throw t.createError("getDocument: no document found for node")}function p(e){var n=m(e);if(typeof n.defaultView!=D)return n.defaultView;if(typeof n.parentWindow!=D)return n.parentWindow;throw t.createError("Cannot get a window object for node")}function g(e){if(typeof e.contentDocument!=D)return e.contentDocument;if(typeof e.contentWindow!=D)return e.contentWindow.document;throw t.createError("getIframeDocument: No Document object found for iframe element")}function v(e){if(typeof e.contentWindow!=D)return e.contentWindow;if(typeof e.contentDocument!=D)return e.contentDocument.defaultView;throw t.createError("getIframeWindow: No Window object found for iframe element")}function b(e){return e&&P.isHostMethod(e,"setTimeout")&&P.isHostObject(e,"document")}function y(e,t,n){var i;if(e?P.isHostProperty(e,"nodeType")?i=1==e.nodeType&&"iframe"==e.tagName.toLowerCase()?g(e):m(e):b(e)&&(i=e.document):i=document,!i)throw t.createError(n+"(): Parameter must be a Window object or DOM node");return i}function E(e){for(var t;t=e.parentNode;)e=t;return e}function C(e,n,i,a){var r,l,d,u,h;if(e==i)return n===a?0:n<a?-1:1;if(r=c(i,e,!0))return n<=o(r)?-1:1;if(r=c(e,i,!0))return o(r)<a?-1:1;if(l=s(e,i),!l)throw new Error("comparePoints error: nodes have no common ancestor");if(d=e===l?l:c(e,l,!0),u=i===l?l:c(i,l,!0),d===u)throw t.createError("comparePoints got to case 4 and childA and childB are the same!");for(h=l.firstChild;h;){if(h===d)return-1;if(h===u)return 1;h=h.nextSibling}}function w(e){var t;try{return t=e.parentNode,!1}catch(e){return!0}}function S(e){if(!e)return"[No node]";if(_&&w(e))return"[Broken node]";if(d(e))return'"'+e.data+'"';if(1==e.nodeType){var t=e.id?' id="'+e.id+'"':"";return"<"+e.nodeName+t+">[index:"+o(e)+",length:"+e.childNodes.length+"]["+(e.innerHTML||"[innerHTML not supported]").slice(0,25)+"]"}return e.nodeName}function x(e){for(var t=m(e).createDocumentFragment(),n;n=e.firstChild;)t.appendChild(n);return t}function k(e,t,n){var i=I(e),o=e.createElement("div");o.contentEditable=""+!!n,t&&(o.innerHTML=t);var a=i.firstChild;return a?i.insertBefore(o,a):i.appendChild(o),o}function N(e){return e.parentNode.removeChild(e)}function T(e){this.root=e,this._next=e}function A(e){return new T(e)}function R(e,t){this.node=e,this.offset=t}function L(e){this.code=this[e],this.codeName=e,this.message="DOMException: "+this.codeName}var D="undefined",P=e.util,I=P.getBody;P.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||t.fail("document missing a Node creation method"),P.isHostMethod(document,"getElementsByTagName")||t.fail("document missing getElementsByTagName method");var B=document.createElement("div");P.areHostMethods(B,["insertBefore","appendChild","cloneNode"]||!P.areHostObjects(B,["previousSibling","nextSibling","childNodes","parentNode"]))||t.fail("Incomplete Element implementation"),P.isHostProperty(B,"innerHTML")||t.fail("Element is missing innerHTML property");var O=document.createTextNode("test");P.areHostMethods(O,["splitText","deleteData","insertData","appendData","cloneNode"]||!P.areHostObjects(B,["previousSibling","nextSibling","childNodes","parentNode"])||!P.areHostProperties(O,["data"]))||t.fail("Incomplete Text Node implementation");var M=function(e,t){for(var n=e.length;n--;)if(e[n]===t)return!0;return!1},_=!1;!function(){var t=document.createElement("b");t.innerHTML="1";var n=t.firstChild;t.innerHTML="<br />",_=w(n),e.features.crashyTextNodes=_}();var F;typeof window.getComputedStyle!=D?F=function(e,t){return p(e).getComputedStyle(e,null)[t]}:typeof document.documentElement.currentStyle!=D?F=function(e,t){return e.currentStyle?e.currentStyle[t]:""}:t.fail("No means of obtaining computed style properties found"),T.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next,t,n;if(this._current)if(t=e.firstChild)this._next=t;else{for(n=null;e!==this.root&&!(n=e.nextSibling);)e=e.parentNode;this._next=n}return this._current},detach:function(){this._current=this._next=this.root=null}},R.prototype={equals:function(e){return!!e&&this.node===e.node&&this.offset==e.offset},inspect:function(){return"[DomPosition("+S(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},L.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24},L.prototype.toString=function(){return this.message},e.dom={arrayContains:M,isHtmlNamespace:n,parentElement:i,getNodeIndex:o,getNodeLength:a,getCommonAncestor:s,isAncestorOf:r,isOrIsAncestorOf:l,getClosestAncestorIn:c,isCharacterDataNode:d,isTextOrCommentNode:u,insertAfter:h,splitDataNode:f,getDocument:m,getWindow:p,getIframeWindow:v,getIframeDocument:g,getBody:I,isWindow:b,getContentDocument:y,getRootContainer:E,comparePoints:C,isBrokenNode:w,inspectNode:S,getComputedStyleProperty:F,createTestElement:k,removeNode:N,fragmentFromNodeChildren:x,createIterator:A,DomPosition:R},e.DOMException=L}),I.createCoreModule("DomRange",["DomUtil"],function(e,t){function n(e,t){return 3!=e.nodeType&&(W(e,t.startContainer)||W(e,t.endContainer))}function i(e){return e.document||q(e.startContainer)}function o(e){return Q(e.startContainer)}function a(e){return new _(e.parentNode,j(e))}function s(e){return new _(e.parentNode,j(e)+1)}function r(e,t,n){var i=11==e.nodeType?e.firstChild:e;return H(t)?n==t.length?O.insertAfter(e,t):t.parentNode.insertBefore(e,0==n?t:K(t,n)):n>=t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[n]),i}function l(e,t,n){if(k(e),k(t),i(t)!=i(e))throw new F("WRONG_DOCUMENT_ERR");var o=U(e.startContainer,e.startOffset,t.endContainer,t.endOffset),a=U(e.endContainer,e.endOffset,t.startContainer,t.startOffset);return n?o<=0&&a>=0:o<0&&a>0}function c(e){for(var t,n,o=i(e.range).createDocumentFragment(),a;n=e.next();){if(t=e.isPartiallySelectedSubtree(),n=n.cloneNode(!t),t&&(a=e.getSubtreeIterator(),n.appendChild(c(a)),a.detach()),10==n.nodeType)throw new F("HIERARCHY_REQUEST_ERR");o.appendChild(n)}return o}function d(e,t,n){var i,o;n=n||{stop:!1};for(var a,s;a=e.next();)if(e.isPartiallySelectedSubtree()){if(t(a)===!1)return void(n.stop=!0);if(s=e.getSubtreeIterator(),d(s,t,n),s.detach(),n.stop)return}else for(i=O.createIterator(a);o=i.next();)if(t(o)===!1)return void(n.stop=!0)}function u(e){for(var t;e.next();)e.isPartiallySelectedSubtree()?(t=e.getSubtreeIterator(),u(t),t.detach()):e.remove()}function h(e){for(var t,n=i(e.range).createDocumentFragment(),o;t=e.next();){if(e.isPartiallySelectedSubtree()?(t=t.cloneNode(!1),o=e.getSubtreeIterator(),t.appendChild(h(o)),o.detach()):e.remove(),10==t.nodeType)throw new F("HIERARCHY_REQUEST_ERR");n.appendChild(t)}return n}function f(e,t,n){var i=!(!t||!t.length),o,a=!!n;i&&(o=new RegExp("^("+t.join("|")+")$"));var s=[];return d(new p(e,!1),function(t){if((!i||o.test(t.nodeType))&&(!a||n(t))){var r=e.startContainer;if(t!=r||!H(r)||e.startOffset!=r.length){var l=e.endContainer;t==l&&H(l)&&0==e.endOffset||s.push(t)}}}),s}function m(e){var t="undefined"==typeof e.getName?"Range":e.getName();return"["+t+"("+O.inspectNode(e.startContainer)+":"+e.startOffset+", "+O.inspectNode(e.endContainer)+":"+e.endOffset+")]"}function p(e,t){if(this.range=e,this.clonePartiallySelectedTextNodes=t,!e.collapsed){this.sc=e.startContainer,this.so=e.startOffset,this.ec=e.endContainer,this.eo=e.endOffset;var n=e.commonAncestorContainer;this.sc===this.ec&&H(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==n||H(this.sc)?z(this.sc,n,!0):this.sc.childNodes[this.so],this._last=this.ec!==n||H(this.ec)?z(this.ec,n,!0):this.ec.childNodes[this.eo-1])}}function g(e){return function(t,n){for(var i,o=n?t:t.parentNode;o;){if(i=o.nodeType,Y(e,i))return o;o=o.parentNode}return null}}function v(e,t){if(ae(e,t))throw new F("INVALID_NODE_TYPE_ERR")}function b(e,t){if(!Y(t,e.nodeType))throw new F("INVALID_NODE_TYPE_ERR")}function y(e,t){if(t<0||t>(H(e)?e.length:e.childNodes.length))throw new F("INDEX_SIZE_ERR")}function E(e,t){if(ie(e,!0)!==ie(t,!0))throw new F("WRONG_DOCUMENT_ERR")}function C(e){if(oe(e,!0))throw new F("NO_MODIFICATION_ALLOWED_ERR")}function w(e,t){if(!e)throw new F(t)}function S(e,t){return t<=(H(e)?e.length:e.childNodes.length)}function x(e){return!!e.startContainer&&!!e.endContainer&&!(G&&(O.isBrokenNode(e.startContainer)||O.isBrokenNode(e.endContainer)))&&Q(e.startContainer)==Q(e.endContainer)&&S(e.startContainer,e.startOffset)&&S(e.endContainer,e.endOffset)}function k(e){if(!x(e))throw new Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: ("+e.inspect()+")")}function N(e,t){k(e);var n=e.startContainer,i=e.startOffset,o=e.endContainer,a=e.endOffset,s=n===o;H(o)&&a>0&&a<o.length&&K(o,a,t),H(n)&&i>0&&i<n.length&&(n=K(n,i,t),s?(a-=i,o=n):o==n.parentNode&&a>=j(n)&&a++,i=0),e.setStartAndEnd(n,i,o,a)}function T(e){k(e);var t=e.commonAncestorContainer.parentNode.cloneNode(!1);return t.appendChild(e.cloneContents()),t.innerHTML}function A(e){e.START_TO_START=de,e.START_TO_END=ue,e.END_TO_END=he,e.END_TO_START=fe,e.NODE_BEFORE=me,e.NODE_AFTER=pe,e.NODE_BEFORE_AND_AFTER=ge,e.NODE_INSIDE=ve}function R(e){A(e),A(e.prototype)}function L(e,t){return function(){k(this);var n=this.startContainer,i=this.startOffset,o=this.commonAncestorContainer,a=new p(this,!0),r,l;n!==o&&(r=z(n,o,!0),l=s(r),n=l.node,i=l.offset),d(a,C),a.reset();var c=e(a);return a.detach(),t(this,n,i,n,i),c}}function D(t,i){function o(e,t){return function(n){b(n,X),b(Q(n),Z);var i=(e?a:s)(n);(t?r:l)(this,i.node,i.offset)}}function r(e,t,n){var o=e.endContainer,a=e.endOffset;t===e.startContainer&&n===e.startOffset||(Q(t)==Q(o)&&1!=U(t,n,o,a)||(o=t,a=n),i(e,t,n,o,a))}function l(e,t,n){var o=e.startContainer,a=e.startOffset;t===e.endContainer&&n===e.endOffset||(Q(t)==Q(o)&&U(t,n,o,a)!=-1||(o=t,a=n),i(e,o,a,t,n))}var c=function(){};c.prototype=e.rangePrototype,t.prototype=new c,M.extend(t.prototype,{setStart:function(e,t){v(e,!0),y(e,t),r(this,e,t)},setEnd:function(e,t){v(e,!0),y(e,t),l(this,e,t)},setStartAndEnd:function(){var e=arguments,t=e[0],n=e[1],o=t,a=n;switch(e.length){case 3:a=e[2];break;case 4:o=e[2],a=e[3]}i(this,t,n,o,a)},setBoundary:function(e,t,n){this["set"+(n?"Start":"End")](e,t)},setStartBefore:o(!0,!0),setStartAfter:o(!1,!0),setEndBefore:o(!0,!1),setEndAfter:o(!1,!1),collapse:function(e){k(this),e?i(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):i(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(e){v(e,!0),i(this,e,0,e,V(e))},selectNode:function(e){v(e,!1),b(e,X);var t=a(e),n=s(e);i(this,t.node,t.offset,n.node,n.offset)},extractContents:L(h,i),deleteContents:L(u,i),canSurroundContents:function(){k(this),C(this.startContainer),C(this.endContainer);var e=new p(this,!0),t=e._first&&n(e._first,this)||e._last&&n(e._last,this);return e.detach(),!t},splitBoundaries:function(){N(this)},splitBoundariesPreservingPositions:function(e){N(this,e)},normalizeBoundaries:function(){k(this);var e=this.startContainer,t=this.startOffset,n=this.endContainer,o=this.endOffset,a=function(e){var t=e.nextSibling;t&&t.nodeType==e.nodeType&&(n=e,o=e.length,e.appendData(t.data),J(t))},s=function(i){var a=i.previousSibling;if(a&&a.nodeType==i.nodeType){e=i;var s=i.length;if(t=a.length,i.insertData(0,a.data),J(a),e==n)o+=t,n=e;else if(n==i.parentNode){var r=j(i);o==r?(n=i,o=s):o>r&&o--}}},r=!0,l;if(H(n))o==n.length?a(n):0==o&&(l=n.previousSibling,l&&l.nodeType==n.nodeType&&(o=l.length,e==n&&(r=!1),l.appendData(n.data),J(n),n=l));else{if(o>0){var c=n.childNodes[o-1];c&&H(c)&&a(c)}r=!this.collapsed}if(r){if(H(e))0==t?s(e):t==e.length&&(l=e.nextSibling,l&&l.nodeType==e.nodeType&&(n==l&&(n=e,o+=e.length),e.appendData(l.data),J(l)));else if(t<e.childNodes.length){var d=e.childNodes[t];d&&H(d)&&s(d)}}else e=n,t=o;i(this,e,t,n,o)},collapseToPoint:function(e,t){v(e,!0),y(e,t),this.setStartAndEnd(e,t);
}}),R(t)}function P(e){e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset,e.commonAncestorContainer=e.collapsed?e.startContainer:O.getCommonAncestor(e.startContainer,e.endContainer)}function I(e,t,n,i,o){e.startContainer=t,e.startOffset=n,e.endContainer=i,e.endOffset=o,e.document=O.getDocument(t),P(e)}function B(e){this.startContainer=e,this.startOffset=0,this.endContainer=e,this.endOffset=0,this.document=e,P(this)}var O=e.dom,M=e.util,_=O.DomPosition,F=e.DOMException,H=O.isCharacterDataNode,j=O.getNodeIndex,W=O.isOrIsAncestorOf,q=O.getDocument,U=O.comparePoints,K=O.splitDataNode,z=O.getClosestAncestorIn,V=O.getNodeLength,Y=O.arrayContains,Q=O.getRootContainer,G=e.features.crashyTextNodes,J=O.removeNode;p.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var e=this._current=this._next;return e&&(this._next=e!==this._last?e.nextSibling:null,H(e)&&this.clonePartiallySelectedTextNodes&&(e===this.ec&&(e=e.cloneNode(!0)).deleteData(this.eo,e.length-this.eo),this._current===this.sc&&(e=e.cloneNode(!0)).deleteData(0,this.so))),e},remove:function(){var e=this._current,t,n;!H(e)||e!==this.sc&&e!==this.ec?e.parentNode&&J(e):(t=e===this.sc?this.so:0,n=e===this.ec?this.eo:e.length,t!=n&&e.deleteData(t,n-t))},isPartiallySelectedSubtree:function(){var e=this._current;return n(e,this.range)},getSubtreeIterator:function(){var e;if(this.isSingleCharacterDataNode)e=this.range.cloneRange(),e.collapse(!1);else{e=new B(i(this.range));var t=this._current,n=t,o=0,a=t,s=V(t);W(t,this.sc)&&(n=this.sc,o=this.so),W(t,this.ec)&&(a=this.ec,s=this.eo),I(e,n,o,a,s)}return new p(e,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var X=[1,3,4,5,7,8,10],Z=[2,9,11],ee=[5,6,10,12],te=[1,3,4,5,7,8,10,11],ne=[1,3,4,5,7,8],ie=g([9,11]),oe=g(ee),ae=g([6,10,12]),se=document.createElement("style"),re=!1;try{se.innerHTML="<b>x</b>",re=3==se.firstChild.nodeType}catch(e){}e.features.htmlParsingConforms=re;var le=re?function(e){var t=this.startContainer,n=q(t);if(!t)throw new F("INVALID_STATE_ERR");var i=null;return 1==t.nodeType?i=t:H(t)&&(i=O.parentElement(t)),i=null===i||"HTML"==i.nodeName&&O.isHtmlNamespace(q(i).documentElement)&&O.isHtmlNamespace(i)?n.createElement("body"):i.cloneNode(!1),i.innerHTML=e,O.fragmentFromNodeChildren(i)}:function(e){var t=i(this),n=t.createElement("body");return n.innerHTML=e,O.fragmentFromNodeChildren(n)},ce=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],de=0,ue=1,he=2,fe=3,me=0,pe=1,ge=2,ve=3;M.extend(e.rangePrototype,{compareBoundaryPoints:function(e,t){k(this),E(this.startContainer,t.startContainer);var n,i,o,a,s=e==fe||e==de?"start":"end",r=e==ue||e==de?"start":"end";return n=this[s+"Container"],i=this[s+"Offset"],o=t[r+"Container"],a=t[r+"Offset"],U(n,i,o,a)},insertNode:function(e){if(k(this),b(e,te),C(this.startContainer),W(e,this.startContainer))throw new F("HIERARCHY_REQUEST_ERR");var t=r(e,this.startContainer,this.startOffset);this.setStartBefore(t)},cloneContents:function(){k(this);var e,t;if(this.collapsed)return i(this).createDocumentFragment();if(this.startContainer===this.endContainer&&H(this.startContainer))return e=this.startContainer.cloneNode(!0),e.data=e.data.slice(this.startOffset,this.endOffset),t=i(this).createDocumentFragment(),t.appendChild(e),t;var n=new p(this,!0);return e=c(n),n.detach(),e},canSurroundContents:function(){k(this),C(this.startContainer),C(this.endContainer);var e=new p(this,!0),t=e._first&&n(e._first,this)||e._last&&n(e._last,this);return e.detach(),!t},surroundContents:function(e){if(b(e,ne),!this.canSurroundContents())throw new F("INVALID_STATE_ERR");var t=this.extractContents();if(e.hasChildNodes())for(;e.lastChild;)e.removeChild(e.lastChild);r(e,this.startContainer,this.startOffset),e.appendChild(t),this.selectNode(e)},cloneRange:function(){k(this);for(var e=new B(i(this)),t=ce.length,n;t--;)n=ce[t],e[n]=this[n];return e},toString:function(){k(this);var e=this.startContainer;if(e===this.endContainer&&H(e))return 3==e.nodeType||4==e.nodeType?e.data.slice(this.startOffset,this.endOffset):"";var t=[],n=new p(this,!0);return d(n,function(e){3!=e.nodeType&&4!=e.nodeType||t.push(e.data)}),n.detach(),t.join("")},compareNode:function(e){k(this);var t=e.parentNode,n=j(e);if(!t)throw new F("NOT_FOUND_ERR");var i=this.comparePoint(t,n),o=this.comparePoint(t,n+1);return i<0?o>0?ge:me:o>0?pe:ve},comparePoint:function(e,t){return k(this),w(e,"HIERARCHY_REQUEST_ERR"),E(e,this.startContainer),U(e,t,this.startContainer,this.startOffset)<0?-1:U(e,t,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:le,toHtml:function(){return T(this)},intersectsNode:function(e,t){if(k(this),Q(e)!=o(this))return!1;var n=e.parentNode,i=j(e);if(!n)return!0;var a=U(n,i,this.endContainer,this.endOffset),s=U(n,i+1,this.startContainer,this.startOffset);return t?a<=0&&s>=0:a<0&&s>0},isPointInRange:function(e,t){return k(this),w(e,"HIERARCHY_REQUEST_ERR"),E(e,this.startContainer),U(e,t,this.startContainer,this.startOffset)>=0&&U(e,t,this.endContainer,this.endOffset)<=0},intersectsRange:function(e){return l(this,e,!1)},intersectsOrTouchesRange:function(e){return l(this,e,!0)},intersection:function(e){if(this.intersectsRange(e)){var t=U(this.startContainer,this.startOffset,e.startContainer,e.startOffset),n=U(this.endContainer,this.endOffset,e.endContainer,e.endOffset),i=this.cloneRange();return t==-1&&i.setStart(e.startContainer,e.startOffset),1==n&&i.setEnd(e.endContainer,e.endOffset),i}return null},union:function(e){if(this.intersectsOrTouchesRange(e)){var t=this.cloneRange();return U(e.startContainer,e.startOffset,this.startContainer,this.startOffset)==-1&&t.setStart(e.startContainer,e.startOffset),1==U(e.endContainer,e.endOffset,this.endContainer,this.endOffset)&&t.setEnd(e.endContainer,e.endOffset),t}throw new F("Ranges do not intersect")},containsNode:function(e,t){return t?this.intersectsNode(e,!1):this.compareNode(e)==ve},containsNodeContents:function(e){return this.comparePoint(e,0)>=0&&this.comparePoint(e,V(e))<=0},containsRange:function(e){var t=this.intersection(e);return null!==t&&e.equals(t)},containsNodeText:function(e){var t=this.cloneRange();t.selectNode(e);var n=t.getNodes([3]);if(n.length>0){t.setStart(n[0],0);var i=n.pop();return t.setEnd(i,i.length),this.containsRange(t)}return this.containsNodeContents(e)},getNodes:function(e,t){return k(this),f(this,e,t)},getDocument:function(){return i(this)},collapseBefore:function(e){this.setEndBefore(e),this.collapse(!1)},collapseAfter:function(e){this.setStartAfter(e),this.collapse(!0)},getBookmark:function(t){var n=i(this),o=e.createRange(n);t=t||O.getBody(n),o.selectNodeContents(t);var a=this.intersection(o),s=0,r=0;return a&&(o.setEnd(a.startContainer,a.startOffset),s=o.toString().length,r=s+a.toString().length),{start:s,end:r,containerNode:t}},moveToBookmark:function(e){var t=e.containerNode,n=0;this.setStart(t,0),this.collapse(!0);for(var i=[t],o,a=!1,s=!1,r,l,c;!s&&(o=i.pop());)if(3==o.nodeType)r=n+o.length,!a&&e.start>=n&&e.start<=r&&(this.setStart(o,e.start-n),a=!0),a&&e.end>=n&&e.end<=r&&(this.setEnd(o,e.end-n),s=!0),n=r;else for(c=o.childNodes,l=c.length;l--;)i.push(c[l])},getName:function(){return"DomRange"},equals:function(e){return B.rangesEqual(this,e)},isValid:function(){return x(this)},inspect:function(){return m(this)},detach:function(){}}),D(B,I),M.extend(B,{rangeProperties:ce,RangeIterator:p,copyComparisonConstants:R,createPrototypeRange:D,inspect:m,toHtml:T,getRangeDocument:i,rangesEqual:function(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset}}),e.DomRange=B}),I.createCoreModule("WrappedRange",["DomRange"],function(e,t){var n,i,o=e.dom,a=e.util,s=o.DomPosition,r=e.DomRange,l=o.getBody,c=o.getContentDocument,d=o.isCharacterDataNode;if(e.features.implementsDomRange&&!function(){function i(e){for(var t=u.length,n;t--;)n=u[t],e[n]=e.nativeRange[n];e.collapsed=e.startContainer===e.endContainer&&e.startOffset===e.endOffset}function s(e,t,n,i,o){var a=e.startContainer!==t||e.startOffset!=n,s=e.endContainer!==i||e.endOffset!=o,r=!e.equals(e.nativeRange);(a||s||r)&&(e.setEnd(i,o),e.setStart(t,n))}var d,u=r.rangeProperties,h;n=function(e){if(!e)throw t.createError("WrappedRange: Range must be specified");this.nativeRange=e,i(this)},r.createPrototypeRange(n,s),d=n.prototype,d.selectNode=function(e){this.nativeRange.selectNode(e),i(this)},d.cloneContents=function(){return this.nativeRange.cloneContents()},d.surroundContents=function(e){this.nativeRange.surroundContents(e),i(this)},d.collapse=function(e){this.nativeRange.collapse(e),i(this)},d.cloneRange=function(){return new n(this.nativeRange.cloneRange())},d.refresh=function(){i(this)},d.toString=function(){return this.nativeRange.toString()};var f=document.createTextNode("test");l(document).appendChild(f);var m=document.createRange();m.setStart(f,0),m.setEnd(f,0);try{m.setStart(f,1),d.setStart=function(e,t){this.nativeRange.setStart(e,t),i(this)},d.setEnd=function(e,t){this.nativeRange.setEnd(e,t),i(this)},h=function(e){return function(t){this.nativeRange[e](t),i(this)}}}catch(e){d.setStart=function(e,t){try{this.nativeRange.setStart(e,t)}catch(n){this.nativeRange.setEnd(e,t),this.nativeRange.setStart(e,t)}i(this)},d.setEnd=function(e,t){try{this.nativeRange.setEnd(e,t)}catch(n){this.nativeRange.setStart(e,t),this.nativeRange.setEnd(e,t)}i(this)},h=function(e,t){return function(n){try{this.nativeRange[e](n)}catch(i){this.nativeRange[t](n),this.nativeRange[e](n)}i(this)}}}d.setStartBefore=h("setStartBefore","setEndBefore"),d.setStartAfter=h("setStartAfter","setEndAfter"),d.setEndBefore=h("setEndBefore","setStartBefore"),d.setEndAfter=h("setEndAfter","setStartAfter"),d.selectNodeContents=function(e){this.setStartAndEnd(e,0,o.getNodeLength(e))},m.selectNodeContents(f),m.setEnd(f,3);var p=document.createRange();p.selectNodeContents(f),p.setEnd(f,4),p.setStart(f,2),m.compareBoundaryPoints(m.START_TO_END,p)==-1&&1==m.compareBoundaryPoints(m.END_TO_START,p)?d.compareBoundaryPoints=function(e,t){return t=t.nativeRange||t,e==t.START_TO_END?e=t.END_TO_START:e==t.END_TO_START&&(e=t.START_TO_END),this.nativeRange.compareBoundaryPoints(e,t)}:d.compareBoundaryPoints=function(e,t){return this.nativeRange.compareBoundaryPoints(e,t.nativeRange||t)};var g=document.createElement("div");g.innerHTML="123";var v=g.firstChild,b=l(document);b.appendChild(g),m.setStart(v,1),m.setEnd(v,2),m.deleteContents(),"13"==v.data&&(d.deleteContents=function(){this.nativeRange.deleteContents(),i(this)},d.extractContents=function(){var e=this.nativeRange.extractContents();return i(this),e}),b.removeChild(g),b=null,a.isHostMethod(m,"createContextualFragment")&&(d.createContextualFragment=function(e){return this.nativeRange.createContextualFragment(e)}),l(document).removeChild(f),d.getName=function(){return"WrappedRange"},e.WrappedRange=n,e.createNativeRange=function(e){return e=c(e,t,"createNativeRange"),e.createRange()}}(),e.features.implementsTextRange){var u=function(e){var t=e.parentElement(),n=e.duplicate();n.collapse(!0);var i=n.parentElement();n=e.duplicate(),n.collapse(!1);var a=n.parentElement(),s=i==a?i:o.getCommonAncestor(i,a);return s==t?s:o.getCommonAncestor(t,s)},h=function(e){return 0==e.compareEndPoints("StartToEnd",e)},f=function(e,t,n,i,a){var r=e.duplicate();r.collapse(n);var l=r.parentElement();if(o.isOrIsAncestorOf(t,l)||(l=t),!l.canHaveHTML){var c=new s(l.parentNode,o.getNodeIndex(l));return{boundaryPosition:c,nodeInfo:{nodeIndex:c.offset,containerElement:c.node}}}var u=o.getDocument(l).createElement("span");u.parentNode&&o.removeNode(u);for(var h,f=n?"StartToStart":"StartToEnd",m,p,g,v,b=a&&a.containerElement==l?a.nodeIndex:0,y=l.childNodes.length,E=y,C=E;;){if(C==y?l.appendChild(u):l.insertBefore(u,l.childNodes[C]),r.moveToElementText(u),h=r.compareEndPoints(f,e),0==h||b==E)break;if(h==-1){if(E==b+1)break;b=C}else E=E==b+1?b:C;C=Math.floor((b+E)/2),l.removeChild(u)}if(v=u.nextSibling,h==-1&&v&&d(v)){r.setEndPoint(n?"EndToStart":"EndToEnd",e);var w;if(/[\r\n]/.test(v.data)){var S=r.duplicate(),x=S.text.replace(/\r\n/g,"\r").length;for(w=S.moveStart("character",x);(h=S.compareEndPoints("StartToEnd",S))==-1;)w++,S.moveStart("character",1)}else w=r.text.length;g=new s(v,w)}else m=(i||!n)&&u.previousSibling,p=(i||n)&&u.nextSibling,g=p&&d(p)?new s(p,0):m&&d(m)?new s(m,m.data.length):new s(l,o.getNodeIndex(u));return o.removeNode(u),{boundaryPosition:g,nodeInfo:{nodeIndex:C,containerElement:l}}},m=function(e,t){var n,i,a=e.offset,s=o.getDocument(e.node),r,c,u=l(s).createTextRange(),h=d(e.node);return h?(n=e.node,i=n.parentNode):(c=e.node.childNodes,n=a<c.length?c[a]:null,i=e.node),r=s.createElement("span"),r.innerHTML="&#feff;",n?i.insertBefore(r,n):i.appendChild(r),u.moveToElementText(r),u.collapse(!t),i.removeChild(r),h&&u[t?"moveStart":"moveEnd"]("character",a),u};i=function(e){this.textRange=e,this.refresh()},i.prototype=new r(document),i.prototype.refresh=function(){var e,t,n,i=u(this.textRange);h(this.textRange)?t=e=f(this.textRange,i,!0,!0).boundaryPosition:(n=f(this.textRange,i,!0,!1),e=n.boundaryPosition,t=f(this.textRange,i,!1,!1,n.nodeInfo).boundaryPosition),this.setStart(e.node,e.offset),this.setEnd(t.node,t.offset)},i.prototype.getName=function(){return"WrappedTextRange"},r.copyComparisonConstants(i);var p=function(e){if(e.collapsed)return m(new s(e.startContainer,e.startOffset),!0);var t=m(new s(e.startContainer,e.startOffset),!0),n=m(new s(e.endContainer,e.endOffset),!1),i=l(r.getRangeDocument(e)).createTextRange();return i.setEndPoint("StartToStart",t),i.setEndPoint("EndToEnd",n),i};if(i.rangeToTextRange=p,i.prototype.toTextRange=function(){return p(this)},e.WrappedTextRange=i,!e.features.implementsDomRange||e.config.preferTextRange){var g=function(e){return e("return this;")()}(Function);"undefined"==typeof g.Range&&(g.Range=i),e.createNativeRange=function(e){return e=c(e,t,"createNativeRange"),l(e).createTextRange()},e.WrappedRange=i}}e.createRange=function(n){return n=c(n,t,"createRange"),new e.WrappedRange(e.createNativeRange(n))},e.createRangyRange=function(e){return e=c(e,t,"createRangyRange"),new r(e)},a.createAliasForDeprecatedMethod(e,"createIframeRange","createRange"),a.createAliasForDeprecatedMethod(e,"createIframeRangyRange","createRangyRange"),e.addShimListener(function(t){var n=t.document;"undefined"==typeof n.createRange&&(n.createRange=function(){return e.createRange(n)}),n=t=null})}),I.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(e,t){function n(e){return"string"==typeof e?/^backward(s)?$/i.test(e):!!e}function i(e,n){if(e){if(N.isWindow(e))return e;if(e instanceof v)return e.win;var i=N.getContentDocument(e,t,n);return N.getWindow(i)}return window}function o(e){return i(e,"getWinSelection").getSelection()}function a(e){return i(e,"getDocSelection").document.selection}function s(e){var t=!1;return e.anchorNode&&(t=1==N.comparePoints(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset)),t}function r(e,t,n){var i=n?"end":"start",o=n?"start":"end";e.anchorNode=t[i+"Container"],e.anchorOffset=t[i+"Offset"],e.focusNode=t[o+"Container"],e.focusOffset=t[o+"Offset"]}function l(e){var t=e.nativeSelection;e.anchorNode=t.anchorNode,e.anchorOffset=t.anchorOffset,e.focusNode=t.focusNode,e.focusOffset=t.focusOffset}function c(e){e.anchorNode=e.focusNode=null,e.anchorOffset=e.focusOffset=0,e.rangeCount=0,e.isCollapsed=!0,e._ranges.length=0}function d(t){var n;return t instanceof R?(n=e.createNativeRange(t.getDocument()),n.setEnd(t.endContainer,t.endOffset),n.setStart(t.startContainer,t.startOffset)):t instanceof L?n=t.nativeRange:O.implementsDomRange&&t instanceof N.getWindow(t.startContainer).Range&&(n=t),n}function u(e){if(!e.length||1!=e[0].nodeType)return!1;for(var t=1,n=e.length;t<n;++t)if(!N.isAncestorOf(e[0],e[t]))return!1;return!0}function h(e){var n=e.getNodes();if(!u(n))throw t.createError("getSingleElementFromRange: range "+e.inspect()+" did not consist of a single element");return n[0]}function f(e){return!!e&&"undefined"!=typeof e.text}function m(e,t){var n=new L(t);e._ranges=[n],r(e,n,!1),e.rangeCount=1,e.isCollapsed=n.collapsed}function p(t){if(t._ranges.length=0,"None"==t.docSelection.type)c(t);else{var n=t.docSelection.createRange();if(f(n))m(t,n);else{t.rangeCount=n.length;for(var i,o=_(n.item(0)),a=0;a<t.rangeCount;++a)i=e.createRange(o),i.selectNode(n.item(a)),t._ranges.push(i);t.isCollapsed=1==t.rangeCount&&t._ranges[0].collapsed,r(t,t._ranges[t.rangeCount-1],!1)}}}function g(e,n){for(var i=e.docSelection.createRange(),o=h(n),a=_(i.item(0)),s=F(a).createControlRange(),r=0,l=i.length;r<l;++r)s.add(i.item(r));try{s.add(o)}catch(e){throw t.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}s.select(),p(e)}function v(e,t,n){this.nativeSelection=e,this.docSelection=t,this._ranges=[],this.win=n,this.refresh()}function b(e){e.win=e.anchorNode=e.focusNode=e._ranges=null,e.rangeCount=e.anchorOffset=e.focusOffset=0,e.detached=!0}function y(e,t){for(var n=ne.length,i,o;n--;)if(i=ne[n],o=i.selection,"deleteAll"==t)b(o);else if(i.win==e)return"delete"==t?(ne.splice(n,1),!0):o;return"deleteAll"==t&&(ne.length=0),null}function E(e,n){for(var i=_(n[0].startContainer),o=F(i).createControlRange(),a=0,s,r=n.length;a<r;++a){s=h(n[a]);try{o.add(s)}catch(e){throw t.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)")}}o.select(),p(e)}function C(e,t){if(e.win.document!=_(t))throw new D("WRONG_DOCUMENT_ERR")}function w(t){return function(n,i){var o;this.rangeCount?(o=this.getRangeAt(0),o["set"+(t?"Start":"End")](n,i)):(o=e.createRange(this.win.document),o.setStartAndEnd(n,i)),this.setSingleRange(o,this.isBackward())}}function S(e){var t=[],n=new P(e.anchorNode,e.anchorOffset),i=new P(e.focusNode,e.focusOffset),o="function"==typeof e.getName?e.getName():"Selection";if("undefined"!=typeof e.rangeCount)for(var a=0,s=e.rangeCount;a<s;++a)t[a]=R.inspect(e.getRangeAt(a));return"["+o+"(Ranges: "+t.join(", ")+")(anchor: "+n.inspect()+", focus: "+i.inspect()+"]"}e.config.checkSelectionRanges=!0;var x="boolean",k="number",N=e.dom,T=e.util,A=T.isHostMethod,R=e.DomRange,L=e.WrappedRange,D=e.DOMException,P=N.DomPosition,I,B,O=e.features,M="Control",_=N.getDocument,F=N.getBody,H=R.rangesEqual,j=A(window,"getSelection"),W=T.isHostObject(document,"selection");O.implementsWinGetSelection=j,O.implementsDocSelection=W;var q=W&&(!j||e.config.preferTextRange);if(q)I=a,e.isSelectionValid=function(e){var t=i(e,"isSelectionValid").document,n=t.selection;return"None"!=n.type||_(n.createRange().parentElement())==t};else{if(!j)return t.fail("Neither document.selection or window.getSelection() detected."),!1;I=o,e.isSelectionValid=function(){return!0}}e.getNativeSelection=I;var U=I();if(!U)return t.fail("Native selection was null (possibly issue 138?)"),!1;var K=e.createNativeRange(document),z=F(document),V=T.areHostProperties(U,["anchorNode","focusNode","anchorOffset","focusOffset"]);O.selectionHasAnchorAndFocus=V;var Y=A(U,"extend");O.selectionHasExtend=Y;var Q=typeof U.rangeCount==k;O.selectionHasRangeCount=Q;var G=!1,J=!0,X=Y?function(t,n){var i=R.getRangeDocument(n),o=e.createRange(i);o.collapseToPoint(n.endContainer,n.endOffset),t.addRange(d(o)),t.extend(n.startContainer,n.startOffset)}:null;T.areHostMethods(U,["addRange","getRangeAt","removeAllRanges"])&&typeof U.rangeCount==k&&O.implementsDomRange&&!function(){var t=window.getSelection();if(t){for(var n=t.rangeCount,i=n>1,o=[],a=s(t),r=0;r<n;++r)o[r]=t.getRangeAt(r);var l=N.createTestElement(document,"",!1),c=l.appendChild(document.createTextNode("   ")),d=document.createRange();if(d.setStart(c,1),d.collapse(!0),t.removeAllRanges(),t.addRange(d),J=1==t.rangeCount,t.removeAllRanges(),!i){var u=window.navigator.appVersion.match(/Chrome\/(.*?) /);if(u&&parseInt(u[1])>=36)G=!1;else{var h=d.cloneRange();d.setStart(c,0),h.setEnd(c,3),h.setStart(c,2),t.addRange(d),t.addRange(h),G=2==t.rangeCount}}for(N.removeNode(l),t.removeAllRanges(),r=0;r<n;++r)0==r&&a?X?X(t,o[r]):(e.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),t.addRange(o[r])):t.addRange(o[r])}}(),O.selectionSupportsMultipleRanges=G,O.collapsedNonEditableSelectionsSupported=J;var Z=!1,ee;z&&A(z,"createControlRange")&&(ee=z.createControlRange(),T.areHostProperties(ee,["item","add"])&&(Z=!0)),O.implementsControlRange=Z,B=V?function(e){return e.anchorNode===e.focusNode&&e.anchorOffset===e.focusOffset}:function(e){return!!e.rangeCount&&e.getRangeAt(e.rangeCount-1).collapsed};var te;A(U,"getRangeAt")?te=function(e,t){try{return e.getRangeAt(t)}catch(e){return null}}:V&&(te=function(t){var n=_(t.anchorNode),i=e.createRange(n);return i.setStartAndEnd(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),i.collapsed!==this.isCollapsed&&i.setStartAndEnd(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset),i}),v.prototype=e.selectionPrototype;var ne=[],ie=function(e){if(e&&e instanceof v)return e.refresh(),e;e=i(e,"getNativeSelection");var t=y(e),n=I(e),o=W?a(e):null;return t?(t.nativeSelection=n,t.docSelection=o,t.refresh()):(t=new v(n,o,e),ne.push({win:e,selection:t})),t};e.getSelection=ie,T.createAliasForDeprecatedMethod(e,"getIframeSelection","getSelection");var oe=v.prototype;if(!q&&V&&T.areHostMethods(U,["removeAllRanges","addRange"])){oe.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),c(this)};var ae=function(e,t){X(e.nativeSelection,t),e.refresh()};Q?oe.addRange=function(t,i){if(Z&&W&&this.docSelection.type==M)g(this,t);else if(n(i)&&Y)ae(this,t);else{var o;G?o=this.rangeCount:(this.removeAllRanges(),o=0);var a=d(t).cloneRange();try{this.nativeSelection.addRange(a)}catch(e){}if(this.rangeCount=this.nativeSelection.rangeCount,this.rangeCount==o+1){if(e.config.checkSelectionRanges){var s=te(this.nativeSelection,this.rangeCount-1);s&&!H(s,t)&&(t=new L(s))}this._ranges[this.rangeCount-1]=t,r(this,t,le(this.nativeSelection)),this.isCollapsed=B(this)}else this.refresh()}}:oe.addRange=function(e,t){n(t)&&Y?ae(this,e):(this.nativeSelection.addRange(d(e)),this.refresh())},oe.setRanges=function(e){if(Z&&W&&e.length>1)E(this,e);else{this.removeAllRanges();for(var t=0,n=e.length;t<n;++t)this.addRange(e[t])}}}else{if(!(A(U,"empty")&&A(K,"select")&&Z&&q))return t.fail("No means of selecting a Range or TextRange was found"),!1;oe.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=this.docSelection.type){var e;if(this.anchorNode)e=_(this.anchorNode);else if(this.docSelection.type==M){var t=this.docSelection.createRange();t.length&&(e=_(t.item(0)))}if(e){var n=F(e).createTextRange();n.select(),this.docSelection.empty()}}}catch(e){}c(this)},oe.addRange=function(t){this.docSelection.type==M?g(this,t):(e.WrappedTextRange.rangeToTextRange(t).select(),this._ranges[0]=t,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,r(this,t,!1))},oe.setRanges=function(e){this.removeAllRanges();var t=e.length;t>1?E(this,e):t&&this.addRange(e[0])}}oe.getRangeAt=function(e){if(e<0||e>=this.rangeCount)throw new D("INDEX_SIZE_ERR");return this._ranges[e].cloneRange()};var se;if(q)se=function(t){var n;e.isSelectionValid(t.win)?n=t.docSelection.createRange():(n=F(t.win.document).createTextRange(),n.collapse(!0)),t.docSelection.type==M?p(t):f(n)?m(t,n):c(t)};else if(A(U,"getRangeAt")&&typeof U.rangeCount==k)se=function(t){if(Z&&W&&t.docSelection.type==M)p(t);else if(t._ranges.length=t.rangeCount=t.nativeSelection.rangeCount,t.rangeCount){for(var n=0,i=t.rangeCount;n<i;++n)t._ranges[n]=new e.WrappedRange(t.nativeSelection.getRangeAt(n));r(t,t._ranges[t.rangeCount-1],le(t.nativeSelection)),t.isCollapsed=B(t)}else c(t)};else{if(!V||typeof U.isCollapsed!=x||typeof K.collapsed!=x||!O.implementsDomRange)return t.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;se=function(e){var t,n=e.nativeSelection;n.anchorNode?(t=te(n,0),e._ranges=[t],e.rangeCount=1,l(e),e.isCollapsed=B(e)):c(e)}}oe.refresh=function(e){var t=e?this._ranges.slice(0):null,n=this.anchorNode,i=this.anchorOffset;if(se(this),e){var o=t.length;if(o!=this._ranges.length)return!0;if(this.anchorNode!=n||this.anchorOffset!=i)return!0;for(;o--;)if(!H(t[o],this._ranges[o]))return!0;return!1}};var re=function(e,t){var n=e.getAllRanges();e.removeAllRanges();for(var i=0,o=n.length;i<o;++i)H(t,n[i])||e.addRange(n[i]);e.rangeCount||c(e)};Z&&W?oe.removeRange=function(e){if(this.docSelection.type==M){for(var t=this.docSelection.createRange(),n=h(e),i=_(t.item(0)),o=F(i).createControlRange(),a,s=!1,r=0,l=t.length;r<l;++r)a=t.item(r),a!==n||s?o.add(t.item(r)):s=!0;o.select(),p(this)}else re(this,e)}:oe.removeRange=function(e){re(this,e)};var le;!q&&V&&O.implementsDomRange?(le=s,oe.isBackward=function(){return le(this)}):le=oe.isBackward=function(){return!1},oe.isBackwards=oe.isBackward,oe.toString=function(){for(var e=[],t=0,n=this.rangeCount;t<n;++t)e[t]=""+this._ranges[t];return e.join("")},oe.collapse=function(t,n){C(this,t);var i=e.createRange(t);i.collapseToPoint(t,n),this.setSingleRange(i),this.isCollapsed=!0},oe.collapseToStart=function(){if(!this.rangeCount)throw new D("INVALID_STATE_ERR");var e=this._ranges[0];this.collapse(e.startContainer,e.startOffset)},oe.collapseToEnd=function(){if(!this.rangeCount)throw new D("INVALID_STATE_ERR");var e=this._ranges[this.rangeCount-1];this.collapse(e.endContainer,e.endOffset)},oe.selectAllChildren=function(t){C(this,t);var n=e.createRange(t);n.selectNodeContents(t),this.setSingleRange(n)},oe.deleteFromDocument=function(){if(Z&&W&&this.docSelection.type==M){for(var e=this.docSelection.createRange(),t;e.length;)t=e.item(0),e.remove(t),N.removeNode(t);this.refresh()}else if(this.rangeCount){var n=this.getAllRanges();if(n.length){this.removeAllRanges();for(var i=0,o=n.length;i<o;++i)n[i].deleteContents();this.addRange(n[o-1])}}},oe.eachRange=function(e,t){for(var n=0,i=this._ranges.length;n<i;++n)if(e(this.getRangeAt(n)))return t},oe.getAllRanges=function(){var e=[];return this.eachRange(function(t){e.push(t)}),e},oe.setSingleRange=function(e,t){this.removeAllRanges(),this.addRange(e,t)},oe.callMethodOnEachRange=function(e,t){var n=[];return this.eachRange(function(i){n.push(i[e].apply(i,t||[]))}),n},oe.setStart=w(!0),oe.setEnd=w(!1),e.rangePrototype.select=function(e){ie(this.getDocument()).setSingleRange(this,e)},oe.changeEachRange=function(e){var t=[],n=this.isBackward();this.eachRange(function(n){e(n),t.push(n)}),this.removeAllRanges(),n&&1==t.length?this.addRange(t[0],"backward"):this.setRanges(t)},oe.containsNode=function(e,t){return this.eachRange(function(n){return n.containsNode(e,t)},!0)||!1},oe.getBookmark=function(e){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[e])}},oe.moveToBookmark=function(t){for(var n=[],i=0,o,a;o=t.rangeBookmarks[i++];)a=e.createRange(this.win),a.moveToBookmark(o),n.push(a);t.backward?this.setSingleRange(n[0],"backward"):this.setRanges(n)},oe.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}},oe.restoreRanges=function(e){this.removeAllRanges();for(var t=0,n;n=e.ranges[t];++t)this.addRange(n,e.backward&&0==t)},oe.toHtml=function(){var e=[];return this.eachRange(function(t){e.push(R.toHtml(t))}),e.join("")},O.implementsTextRange&&(oe.getNativeTextRange=function(){var n,i;if(n=this.docSelection){var o=n.createRange();if(f(o))return o;throw t.createError("getNativeTextRange: selection is a control selection")}if(this.rangeCount>0)return e.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw t.createError("getNativeTextRange: selection contains no range")}),oe.getName=function(){return"WrappedSelection"},oe.inspect=function(){return S(this)},oe.detach=function(){y(this.win,"delete"),b(this)},v.detachAll=function(){y(null,"deleteAll")},v.inspect=S,v.isDirectionBackward=n,e.Selection=v,e.selectionPrototype=oe,e.addShimListener(function(e){"undefined"==typeof e.getSelection&&(e.getSelection=function(){return ie(e)}),e=null})});var F=!1,H=function(e){F||(F=!0,!I.initialized&&I.config.autoInitialize&&u())};return D&&("complete"==document.readyState?H():(e(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",H,!1),O(window,"load",H))),I},this)},{}]},{},[1]);